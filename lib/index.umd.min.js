(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("vue")):"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["index"]=e(require("vue")):t["index"]=e(t["Vue"])})("undefined"!==typeof self?self:this,(function(t){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="fb15")}({"00ee":function(t,e,i){var n=i("b622"),r=n("toStringTag"),a={};a[r]="z",t.exports="[object z]"===String(a)},"0366":function(t,e,i){var n=i("1c0b");t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}}},"0481":function(t,e,i){"use strict";var n=i("23e7"),r=i("a2bf"),a=i("7b0b"),o=i("50c4"),s=i("a691"),h=i("65f0");n({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=a(this),i=o(e.length),n=h(e,0);return n.length=r(n,e,e,i,0,void 0===t?1:s(t)),n}})},"057f":function(t,e,i){var n=i("fc6a"),r=i("241c").f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return r(t)}catch(e){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==a.call(t)?s(t):r(n(t))}},"06cf":function(t,e,i){var n=i("83ab"),r=i("d1e7"),a=i("5c6c"),o=i("fc6a"),s=i("c04e"),h=i("5135"),c=i("0cfb"),l=Object.getOwnPropertyDescriptor;e.f=n?l:function(t,e){if(t=o(t),e=s(e,!0),c)try{return l(t,e)}catch(i){}if(h(t,e))return a(!r.f.call(t,e),t[e])}},"0cfb":function(t,e,i){var n=i("83ab"),r=i("d039"),a=i("cc12");t.exports=!n&&!r((function(){return 7!=Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a}))},"0d03":function(t,e,i){var n=i("6eeb"),r=Date.prototype,a="Invalid Date",o="toString",s=r[o],h=r.getTime;new Date(NaN)+""!=a&&n(r,o,(function(){var t=h.call(this);return t===t?s.call(this):a}))},1276:function(t,e,i){"use strict";var n=i("d784"),r=i("44e7"),a=i("825a"),o=i("1d80"),s=i("4840"),h=i("8aa5"),c=i("50c4"),l=i("14c3"),d=i("9263"),u=i("d039"),f=[].push,p=Math.min,g=4294967295,y=!u((function(){return!RegExp(g,"y")}));n("split",2,(function(t,e,i){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,i){var n=String(o(this)),a=void 0===i?g:i>>>0;if(0===a)return[];if(void 0===t)return[n];if(!r(t))return e.call(n,t,a);var s,h,c,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,y=new RegExp(t.source,u+"g");while(s=d.call(y,n)){if(h=y.lastIndex,h>p&&(l.push(n.slice(p,s.index)),s.length>1&&s.index<n.length&&f.apply(l,s.slice(1)),c=s[0].length,p=h,l.length>=a))break;y.lastIndex===s.index&&y.lastIndex++}return p===n.length?!c&&y.test("")||l.push(""):l.push(n.slice(p)),l.length>a?l.slice(0,a):l}:"0".split(void 0,0).length?function(t,i){return void 0===t&&0===i?[]:e.call(this,t,i)}:e,[function(e,i){var r=o(this),a=void 0==e?void 0:e[t];return void 0!==a?a.call(e,r,i):n.call(String(r),e,i)},function(t,r){var o=i(n,t,this,r,n!==e);if(o.done)return o.value;var d=a(t),u=String(this),f=s(d,RegExp),v=d.unicode,x=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(y?"y":"g"),m=new f(y?d:"^(?:"+d.source+")",x),b=void 0===r?g:r>>>0;if(0===b)return[];if(0===u.length)return null===l(m,u)?[u]:[];var w=0,_=0,S=[];while(_<u.length){m.lastIndex=y?_:0;var P,A=l(m,y?u:u.slice(_));if(null===A||(P=p(c(m.lastIndex+(y?0:_)),u.length))===w)_=h(u,_,v);else{if(S.push(u.slice(w,_)),S.length===b)return S;for(var C=1;C<=A.length-1;C++)if(S.push(A[C]),S.length===b)return S;_=w=P}}return S.push(u.slice(w)),S}]}),!y)},"14c3":function(t,e,i){var n=i("c6b6"),r=i("9263");t.exports=function(t,e){var i=t.exec;if("function"===typeof i){var a=i.call(t,e);if("object"!==typeof a)throw TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==n(t))throw TypeError("RegExp#exec called on incompatible receiver");return r.call(t,e)}},"159b":function(t,e,i){var n=i("da84"),r=i("fdbc"),a=i("17c2"),o=i("9112");for(var s in r){var h=n[s],c=h&&h.prototype;if(c&&c.forEach!==a)try{o(c,"forEach",a)}catch(l){c.forEach=a}}},"17c2":function(t,e,i){"use strict";var n=i("b727").forEach,r=i("a640"),a=r("forEach");t.exports=a?[].forEach:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}},"19aa":function(t,e){t.exports=function(t,e,i){if(!(t instanceof e))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return t}},"1be4":function(t,e,i){var n=i("d066");t.exports=n("document","documentElement")},"1c0b":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},"1c7e":function(t,e,i){var n=i("b622"),r=n("iterator"),a=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){a=!0}};s[r]=function(){return this},Array.from(s,(function(){throw 2}))}catch(h){}t.exports=function(t,e){if(!e&&!a)return!1;var i=!1;try{var n={};n[r]=function(){return{next:function(){return{done:i=!0}}}},t(n)}catch(h){}return i}},"1cdc":function(t,e,i){var n=i("342f");t.exports=/(iphone|ipod|ipad).*applewebkit/i.test(n)},"1d1c":function(t,e,i){var n=i("23e7"),r=i("83ab"),a=i("37e8");n({target:"Object",stat:!0,forced:!r,sham:!r},{defineProperties:a})},"1d80":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},"1dde":function(t,e,i){var n=i("d039"),r=i("b622"),a=i("2d00"),o=r("species");t.exports=function(t){return a>=51||!n((function(){var e=[],i=e.constructor={};return i[o]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},2266:function(t,e,i){var n=i("825a"),r=i("e95a"),a=i("50c4"),o=i("0366"),s=i("35a1"),h=i("2a62"),c=function(t,e){this.stopped=t,this.result=e};t.exports=function(t,e,i){var l,d,u,f,p,g,y,v=i&&i.that,x=!(!i||!i.AS_ENTRIES),m=!(!i||!i.IS_ITERATOR),b=!(!i||!i.INTERRUPTED),w=o(e,v,1+x+b),_=function(t){return l&&h(l),new c(!0,t)},S=function(t){return x?(n(t),b?w(t[0],t[1],_):w(t[0],t[1])):b?w(t,_):w(t)};if(m)l=t;else{if(d=s(t),"function"!=typeof d)throw TypeError("Target is not iterable");if(r(d)){for(u=0,f=a(t.length);f>u;u++)if(p=S(t[u]),p&&p instanceof c)return p;return new c(!1)}l=d.call(t)}g=l.next;while(!(y=g.call(l)).done){try{p=S(y.value)}catch(P){throw h(l),P}if("object"==typeof p&&p&&p instanceof c)return p}return new c(!1)}},"23cb":function(t,e,i){var n=i("a691"),r=Math.max,a=Math.min;t.exports=function(t,e){var i=n(t);return i<0?r(i+e,0):a(i,e)}},"23e7":function(t,e,i){var n=i("da84"),r=i("06cf").f,a=i("9112"),o=i("6eeb"),s=i("ce4e"),h=i("e893"),c=i("94ca");t.exports=function(t,e){var i,l,d,u,f,p,g=t.target,y=t.global,v=t.stat;if(l=y?n:v?n[g]||s(g,{}):(n[g]||{}).prototype,l)for(d in e){if(f=e[d],t.noTargetGet?(p=r(l,d),u=p&&p.value):u=l[d],i=c(y?d:g+(v?".":"#")+d,t.forced),!i&&void 0!==u){if(typeof f===typeof u)continue;h(f,u)}(t.sham||u&&u.sham)&&a(f,"sham",!0),o(l,d,f,t)}}},"241c":function(t,e,i){var n=i("ca84"),r=i("7839"),a=r.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,a)}},2532:function(t,e,i){"use strict";var n=i("23e7"),r=i("5a34"),a=i("1d80"),o=i("ab13");n({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~String(a(this)).indexOf(r(t),arguments.length>1?arguments[1]:void 0)}})},"25f0":function(t,e,i){"use strict";var n=i("6eeb"),r=i("825a"),a=i("d039"),o=i("ad6d"),s="toString",h=RegExp.prototype,c=h[s],l=a((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=s;(l||d)&&n(RegExp.prototype,s,(function(){var t=r(this),e=String(t.source),i=t.flags,n=String(void 0===i&&t instanceof RegExp&&!("flags"in h)?o.call(t):i);return"/"+e+"/"+n}),{unsafe:!0})},2626:function(t,e,i){"use strict";var n=i("d066"),r=i("9bf2"),a=i("b622"),o=i("83ab"),s=a("species");t.exports=function(t){var e=n(t),i=r.f;o&&e&&!e[s]&&i(e,s,{configurable:!0,get:function(){return this}})}},"26e9":function(t,e,i){"use strict";var n=i("23e7"),r=i("e8b5"),a=[].reverse,o=[1,2];n({target:"Array",proto:!0,forced:String(o)===String(o.reverse())},{reverse:function(){return r(this)&&(this.length=this.length),a.call(this)}})},"277d":function(t,e,i){var n=i("23e7"),r=i("e8b5");n({target:"Array",stat:!0},{isArray:r})},"2a62":function(t,e,i){var n=i("825a");t.exports=function(t){var e=t["return"];if(void 0!==e)return n(e.call(t)).value}},"2cf4":function(t,e,i){var n,r,a,o=i("da84"),s=i("d039"),h=i("0366"),c=i("1be4"),l=i("cc12"),d=i("1cdc"),u=i("605d"),f=o.location,p=o.setImmediate,g=o.clearImmediate,y=o.process,v=o.MessageChannel,x=o.Dispatch,m=0,b={},w="onreadystatechange",_=function(t){if(b.hasOwnProperty(t)){var e=b[t];delete b[t],e()}},S=function(t){return function(){_(t)}},P=function(t){_(t.data)},A=function(t){o.postMessage(t+"",f.protocol+"//"+f.host)};p&&g||(p=function(t){var e=[],i=1;while(arguments.length>i)e.push(arguments[i++]);return b[++m]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},n(m),m},g=function(t){delete b[t]},u?n=function(t){y.nextTick(S(t))}:x&&x.now?n=function(t){x.now(S(t))}:v&&!d?(r=new v,a=r.port2,r.port1.onmessage=P,n=h(a.postMessage,a,1)):o.addEventListener&&"function"==typeof postMessage&&!o.importScripts&&f&&"file:"!==f.protocol&&!s(A)?(n=A,o.addEventListener("message",P,!1)):n=w in l("script")?function(t){c.appendChild(l("script"))[w]=function(){c.removeChild(this),_(t)}}:function(t){setTimeout(S(t),0)}),t.exports={set:p,clear:g}},"2d00":function(t,e,i){var n,r,a=i("da84"),o=i("342f"),s=a.process,h=s&&s.versions,c=h&&h.v8;c?(n=c.split("."),r=n[0]+n[1]):o&&(n=o.match(/Edge\/(\d+)/),(!n||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/),n&&(r=n[1]))),t.exports=r&&+r},"30a9":function(t,e,i){},"342f":function(t,e,i){var n=i("d066");t.exports=n("navigator","userAgent")||""},"35a1":function(t,e,i){var n=i("f5df"),r=i("3f8c"),a=i("b622"),o=a("iterator");t.exports=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||r[n(t)]}},"37e8":function(t,e,i){var n=i("83ab"),r=i("9bf2"),a=i("825a"),o=i("df75");t.exports=n?Object.defineProperties:function(t,e){a(t);var i,n=o(e),s=n.length,h=0;while(s>h)r.f(t,i=n[h++],e[i]);return t}},"3bbe":function(t,e,i){var n=i("861d");t.exports=function(t){if(!n(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},"3ca3":function(t,e,i){"use strict";var n=i("6547").charAt,r=i("69f3"),a=i("7dd0"),o="String Iterator",s=r.set,h=r.getterFor(o);a(String,"String",(function(t){s(this,{type:o,string:String(t),index:0})}),(function(){var t,e=h(this),i=e.string,r=e.index;return r>=i.length?{value:void 0,done:!0}:(t=n(i,r),e.index+=t.length,{value:t,done:!1})}))},"3f8c":function(t,e){t.exports={}},4160:function(t,e,i){"use strict";var n=i("23e7"),r=i("17c2");n({target:"Array",proto:!0,forced:[].forEach!=r},{forEach:r})},"428f":function(t,e,i){var n=i("da84");t.exports=n},"44ad":function(t,e,i){var n=i("d039"),r=i("c6b6"),a="".split;t.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==r(t)?a.call(t,""):Object(t)}:Object},"44d2":function(t,e,i){var n=i("b622"),r=i("7c73"),a=i("9bf2"),o=n("unscopables"),s=Array.prototype;void 0==s[o]&&a.f(s,o,{configurable:!0,value:r(null)}),t.exports=function(t){s[o][t]=!0}},"44de":function(t,e,i){var n=i("da84");t.exports=function(t,e){var i=n.console;i&&i.error&&(1===arguments.length?i.error(t):i.error(t,e))}},"44e7":function(t,e,i){var n=i("861d"),r=i("c6b6"),a=i("b622"),o=a("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},4840:function(t,e,i){var n=i("825a"),r=i("1c0b"),a=i("b622"),o=a("species");t.exports=function(t,e){var i,a=n(t).constructor;return void 0===a||void 0==(i=n(a)[o])?e:r(i)}},4930:function(t,e,i){var n=i("605d"),r=i("2d00"),a=i("d039");t.exports=!!Object.getOwnPropertySymbols&&!a((function(){return!Symbol.sham&&(n?38===r:r>37&&r<41)}))},"4d64":function(t,e,i){var n=i("fc6a"),r=i("50c4"),a=i("23cb"),o=function(t){return function(e,i,o){var s,h=n(e),c=r(h.length),l=a(o,c);if(t&&i!=i){while(c>l)if(s=h[l++],s!=s)return!0}else for(;c>l;l++)if((t||l in h)&&h[l]===i)return t||l||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},"4de4":function(t,e,i){"use strict";var n=i("23e7"),r=i("b727").filter,a=i("1dde"),o=a("filter");n({target:"Array",proto:!0,forced:!o},{filter:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(t,e,i){"use strict";var n=i("0366"),r=i("7b0b"),a=i("9bdd"),o=i("e95a"),s=i("50c4"),h=i("8418"),c=i("35a1");t.exports=function(t){var e,i,l,d,u,f,p=r(t),g="function"==typeof this?this:Array,y=arguments.length,v=y>1?arguments[1]:void 0,x=void 0!==v,m=c(p),b=0;if(x&&(v=n(v,y>2?arguments[2]:void 0,2)),void 0==m||g==Array&&o(m))for(e=s(p.length),i=new g(e);e>b;b++)f=x?v(p[b],b):p[b],h(i,b,f);else for(d=m.call(p),u=d.next,i=new g;!(l=u.call(d)).done;b++)f=x?a(d,v,[l.value,b],!0):l.value,h(i,b,f);return i.length=b,i}},"4ec9":function(t,e,i){"use strict";var n=i("6d61"),r=i("6566");t.exports=n("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},"50c4":function(t,e,i){var n=i("a691"),r=Math.min;t.exports=function(t){return t>0?r(n(t),9007199254740991):0}},5135:function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},5692:function(t,e,i){var n=i("c430"),r=i("c6cd");(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.9.1",mode:n?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},"56ef":function(t,e,i){var n=i("d066"),r=i("241c"),a=i("7418"),o=i("825a");t.exports=n("Reflect","ownKeys")||function(t){var e=r.f(o(t)),i=a.f;return i?e.concat(i(t)):e}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,i){var n=i("1d80"),r=i("5899"),a="["+r+"]",o=RegExp("^"+a+a+"*"),s=RegExp(a+a+"*$"),h=function(t){return function(e){var i=String(n(e));return 1&t&&(i=i.replace(o,"")),2&t&&(i=i.replace(s,"")),i}};t.exports={start:h(1),end:h(2),trim:h(3)}},"5a34":function(t,e,i){var n=i("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},"5c6c":function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"605d":function(t,e,i){var n=i("c6b6"),r=i("da84");t.exports="process"==n(r.process)},6062:function(t,e,i){"use strict";var n=i("6d61"),r=i("6566");t.exports=n("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},"60da":function(t,e,i){"use strict";var n=i("83ab"),r=i("d039"),a=i("df75"),o=i("7418"),s=i("d1e7"),h=i("7b0b"),c=i("44ad"),l=Object.assign,d=Object.defineProperty;t.exports=!l||r((function(){if(n&&1!==l({b:1},l(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol(),r="abcdefghijklmnopqrst";return t[i]=7,r.split("").forEach((function(t){e[t]=t})),7!=l({},t)[i]||a(l({},e)).join("")!=r}))?function(t,e){var i=h(t),r=arguments.length,l=1,d=o.f,u=s.f;while(r>l){var f,p=c(arguments[l++]),g=d?a(p).concat(d(p)):a(p),y=g.length,v=0;while(y>v)f=g[v++],n&&!u.call(p,f)||(i[f]=p[f])}return i}:l},6547:function(t,e,i){var n=i("a691"),r=i("1d80"),a=function(t){return function(e,i){var a,o,s=String(r(e)),h=n(i),c=s.length;return h<0||h>=c?t?"":void 0:(a=s.charCodeAt(h),a<55296||a>56319||h+1===c||(o=s.charCodeAt(h+1))<56320||o>57343?t?s.charAt(h):a:t?s.slice(h,h+2):o-56320+(a-55296<<10)+65536)}};t.exports={codeAt:a(!1),charAt:a(!0)}},6566:function(t,e,i){"use strict";var n=i("9bf2").f,r=i("7c73"),a=i("e2cc"),o=i("0366"),s=i("19aa"),h=i("2266"),c=i("7dd0"),l=i("2626"),d=i("83ab"),u=i("f183").fastKey,f=i("69f3"),p=f.set,g=f.getterFor;t.exports={getConstructor:function(t,e,i,c){var l=t((function(t,n){s(t,l,e),p(t,{type:e,index:r(null),first:void 0,last:void 0,size:0}),d||(t.size=0),void 0!=n&&h(n,t[c],{that:t,AS_ENTRIES:i})})),f=g(e),y=function(t,e,i){var n,r,a=f(t),o=v(t,e);return o?o.value=i:(a.last=o={index:r=u(e,!0),key:e,value:i,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=o),n&&(n.next=o),d?a.size++:t.size++,"F"!==r&&(a.index[r]=o)),t},v=function(t,e){var i,n=f(t),r=u(e);if("F"!==r)return n.index[r];for(i=n.first;i;i=i.next)if(i.key==e)return i};return a(l.prototype,{clear:function(){var t=this,e=f(t),i=e.index,n=e.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete i[n.index],n=n.next;e.first=e.last=void 0,d?e.size=0:t.size=0},delete:function(t){var e=this,i=f(e),n=v(e,t);if(n){var r=n.next,a=n.previous;delete i.index[n.index],n.removed=!0,a&&(a.next=r),r&&(r.previous=a),i.first==n&&(i.first=r),i.last==n&&(i.last=a),d?i.size--:e.size--}return!!n},forEach:function(t){var e,i=f(this),n=o(t,arguments.length>1?arguments[1]:void 0,3);while(e=e?e.next:i.first){n(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!v(this,t)}}),a(l.prototype,i?{get:function(t){var e=v(this,t);return e&&e.value},set:function(t,e){return y(this,0===t?0:t,e)}}:{add:function(t){return y(this,t=0===t?0:t,t)}}),d&&n(l.prototype,"size",{get:function(){return f(this).size}}),l},setStrong:function(t,e,i){var n=e+" Iterator",r=g(e),a=g(n);c(t,e,(function(t,e){p(this,{type:n,target:t,state:r(t),kind:e,last:void 0})}),(function(){var t=a(this),e=t.kind,i=t.last;while(i&&i.removed)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?"keys"==e?{value:i.key,done:!1}:"values"==e?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),i?"entries":"values",!i,!0),l(e)}}},"65f0":function(t,e,i){var n=i("861d"),r=i("e8b5"),a=i("b622"),o=a("species");t.exports=function(t,e){var i;return r(t)&&(i=t.constructor,"function"!=typeof i||i!==Array&&!r(i.prototype)?n(i)&&(i=i[o],null===i&&(i=void 0)):i=void 0),new(void 0===i?Array:i)(0===e?0:e)}},"69f3":function(t,e,i){var n,r,a,o=i("7f9a"),s=i("da84"),h=i("861d"),c=i("9112"),l=i("5135"),d=i("c6cd"),u=i("f772"),f=i("d012"),p=s.WeakMap,g=function(t){return a(t)?r(t):n(t,{})},y=function(t){return function(e){var i;if(!h(e)||(i=r(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}};if(o){var v=d.state||(d.state=new p),x=v.get,m=v.has,b=v.set;n=function(t,e){return e.facade=t,b.call(v,t,e),e},r=function(t){return x.call(v,t)||{}},a=function(t){return m.call(v,t)}}else{var w=u("state");f[w]=!0,n=function(t,e){return e.facade=t,c(t,w,e),e},r=function(t){return l(t,w)?t[w]:{}},a=function(t){return l(t,w)}}t.exports={set:n,get:r,has:a,enforce:g,getterFor:y}},"6d61":function(t,e,i){"use strict";var n=i("23e7"),r=i("da84"),a=i("94ca"),o=i("6eeb"),s=i("f183"),h=i("2266"),c=i("19aa"),l=i("861d"),d=i("d039"),u=i("1c7e"),f=i("d44e"),p=i("7156");t.exports=function(t,e,i){var g=-1!==t.indexOf("Map"),y=-1!==t.indexOf("Weak"),v=g?"set":"add",x=r[t],m=x&&x.prototype,b=x,w={},_=function(t){var e=m[t];o(m,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(y&&!l(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!l(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(y&&!l(t))&&e.call(this,0===t?0:t)}:function(t,i){return e.call(this,0===t?0:t,i),this})},S=a(t,"function"!=typeof x||!(y||m.forEach&&!d((function(){(new x).entries().next()}))));if(S)b=i.getConstructor(e,t,g,v),s.REQUIRED=!0;else if(a(t,!0)){var P=new b,A=P[v](y?{}:-0,1)!=P,C=d((function(){P.has(1)})),R=u((function(t){new x(t)})),L=!y&&d((function(){var t=new x,e=5;while(e--)t[v](e,e);return!t.has(-0)}));R||(b=e((function(e,i){c(e,b,t);var n=p(new x,e,b);return void 0!=i&&h(i,n[v],{that:n,AS_ENTRIES:g}),n})),b.prototype=m,m.constructor=b),(C||L)&&(_("delete"),_("has"),g&&_("get")),(L||A)&&_(v),y&&m.clear&&delete m.clear}return w[t]=b,n({global:!0,forced:b!=x},w),f(b,t),y||i.setStrong(b,t,g),b}},"6eeb":function(t,e,i){var n=i("da84"),r=i("9112"),a=i("5135"),o=i("ce4e"),s=i("8925"),h=i("69f3"),c=h.get,l=h.enforce,d=String(String).split("String");(t.exports=function(t,e,i,s){var h,c=!!s&&!!s.unsafe,u=!!s&&!!s.enumerable,f=!!s&&!!s.noTargetGet;"function"==typeof i&&("string"!=typeof e||a(i,"name")||r(i,"name",e),h=l(i),h.source||(h.source=d.join("string"==typeof e?e:""))),t!==n?(c?!f&&t[e]&&(u=!0):delete t[e],u?t[e]=i:r(t,e,i)):u?t[e]=i:o(e,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},7156:function(t,e,i){var n=i("861d"),r=i("d2bb");t.exports=function(t,e,i){var a,o;return r&&"function"==typeof(a=e.constructor)&&a!==i&&n(o=a.prototype)&&o!==i.prototype&&r(t,o),t}},7418:function(t,e){e.f=Object.getOwnPropertySymbols},"746f":function(t,e,i){var n=i("428f"),r=i("5135"),a=i("e538"),o=i("9bf2").f;t.exports=function(t){var e=n.Symbol||(n.Symbol={});r(e,t)||o(e,t,{value:a.f(t)})}},7839:function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7a82":function(t,e,i){var n=i("23e7"),r=i("83ab"),a=i("9bf2");n({target:"Object",stat:!0,forced:!r,sham:!r},{defineProperty:a.f})},"7b0b":function(t,e,i){var n=i("1d80");t.exports=function(t){return Object(n(t))}},"7c73":function(t,e,i){var n,r=i("825a"),a=i("37e8"),o=i("7839"),s=i("d012"),h=i("1be4"),c=i("cc12"),l=i("f772"),d=">",u="<",f="prototype",p="script",g=l("IE_PROTO"),y=function(){},v=function(t){return u+p+d+t+u+"/"+p+d},x=function(t){t.write(v("")),t.close();var e=t.parentWindow.Object;return t=null,e},m=function(){var t,e=c("iframe"),i="java"+p+":";return e.style.display="none",h.appendChild(e),e.src=String(i),t=e.contentWindow.document,t.open(),t.write(v("document.F=Object")),t.close(),t.F},b=function(){try{n=document.domain&&new ActiveXObject("htmlfile")}catch(e){}b=n?x(n):m();var t=o.length;while(t--)delete b[f][o[t]];return b()};s[g]=!0,t.exports=Object.create||function(t,e){var i;return null!==t?(y[f]=r(t),i=new y,y[f]=null,i[g]=t):i=b(),void 0===e?i:a(i,e)}},"7db0":function(t,e,i){"use strict";var n=i("23e7"),r=i("b727").find,a=i("44d2"),o="find",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a(o)},"7dd0":function(t,e,i){"use strict";var n=i("23e7"),r=i("9ed3"),a=i("e163"),o=i("d2bb"),s=i("d44e"),h=i("9112"),c=i("6eeb"),l=i("b622"),d=i("c430"),u=i("3f8c"),f=i("ae93"),p=f.IteratorPrototype,g=f.BUGGY_SAFARI_ITERATORS,y=l("iterator"),v="keys",x="values",m="entries",b=function(){return this};t.exports=function(t,e,i,l,f,w,_){r(i,e,l);var S,P,A,C=function(t){if(t===f&&M)return M;if(!g&&t in k)return k[t];switch(t){case v:return function(){return new i(this,t)};case x:return function(){return new i(this,t)};case m:return function(){return new i(this,t)}}return function(){return new i(this)}},R=e+" Iterator",L=!1,k=t.prototype,T=k[y]||k["@@iterator"]||f&&k[f],M=!g&&T||C(f),E="Array"==e&&k.entries||T;if(E&&(S=a(E.call(new t)),p!==Object.prototype&&S.next&&(d||a(S)===p||(o?o(S,p):"function"!=typeof S[y]&&h(S,y,b)),s(S,R,!0,!0),d&&(u[R]=b))),f==x&&T&&T.name!==x&&(L=!0,M=function(){return T.call(this)}),d&&!_||k[y]===M||h(k,y,M),u[e]=M,f)if(P={values:C(x),keys:w?M:C(v),entries:C(m)},_)for(A in P)(g||L||!(A in k))&&c(k,A,P[A]);else n({target:e,proto:!0,forced:g||L},P);return P}},"7f9a":function(t,e,i){var n=i("da84"),r=i("8925"),a=n.WeakMap;t.exports="function"===typeof a&&/native code/.test(r(a))},"825a":function(t,e,i){var n=i("861d");t.exports=function(t){if(!n(t))throw TypeError(String(t)+" is not an object");return t}},"83ab":function(t,e,i){var n=i("d039");t.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},8418:function(t,e,i){"use strict";var n=i("c04e"),r=i("9bf2"),a=i("5c6c");t.exports=function(t,e,i){var o=n(e);o in t?r.f(t,o,a(0,i)):t[o]=i}},"861d":function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},8875:function(t,e,i){var n,r,a;(function(i,o){r=[],n=o,a="function"===typeof n?n.apply(e,r):n,void 0===a||(t.exports=a)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(f){var i,n,r,a=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,o=/@([^@]*):(\d+):(\d+)\s*$/gi,s=a.exec(f.stack)||o.exec(f.stack),h=s&&s[1]||!1,c=s&&s[2]||!1,l=document.location.href.replace(document.location.hash,""),d=document.getElementsByTagName("script");h===l&&(i=document.documentElement.outerHTML,n=new RegExp("(?:[^\\n]+?\\n){0,"+(c-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),r=i.replace(n,"$1").trim());for(var u=0;u<d.length;u++){if("interactive"===d[u].readyState)return d[u];if(d[u].src===h)return d[u];if(h===l&&d[u].innerHTML&&d[u].innerHTML.trim()===r)return d[u]}return null}}return t}))},8925:function(t,e,i){var n=i("c6cd"),r=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(t){return r.call(t)}),t.exports=n.inspectSource},"8aa5":function(t,e,i){"use strict";var n=i("6547").charAt;t.exports=function(t,e,i){return e+(i?n(t,e).length:1)}},"8bbf":function(e,i){e.exports=t},"90e3":function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++i+n).toString(36)}},9112:function(t,e,i){var n=i("83ab"),r=i("9bf2"),a=i("5c6c");t.exports=n?function(t,e,i){return r.f(t,e,a(1,i))}:function(t,e,i){return t[e]=i,t}},9263:function(t,e,i){"use strict";var n=i("ad6d"),r=i("9f7f"),a=RegExp.prototype.exec,o=String.prototype.replace,s=a,h=function(){var t=/a/,e=/b*/g;return a.call(t,"a"),a.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),c=r.UNSUPPORTED_Y||r.BROKEN_CARET,l=void 0!==/()??/.exec("")[1],d=h||l||c;d&&(s=function(t){var e,i,r,s,d=this,u=c&&d.sticky,f=n.call(d),p=d.source,g=0,y=t;return u&&(f=f.replace("y",""),-1===f.indexOf("g")&&(f+="g"),y=String(t).slice(d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==t[d.lastIndex-1])&&(p="(?: "+p+")",y=" "+y,g++),i=new RegExp("^(?:"+p+")",f)),l&&(i=new RegExp("^"+p+"$(?!\\s)",f)),h&&(e=d.lastIndex),r=a.call(u?i:d,y),u?r?(r.input=r.input.slice(g),r[0]=r[0].slice(g),r.index=d.lastIndex,d.lastIndex+=r[0].length):d.lastIndex=0:h&&r&&(d.lastIndex=d.global?r.index+r[0].length:e),l&&r&&r.length>1&&o.call(r[0],i,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(r[s]=void 0)})),r}),t.exports=s},"94ca":function(t,e,i){var n=i("d039"),r=/#|\.prototype\./,a=function(t,e){var i=s[o(t)];return i==c||i!=h&&("function"==typeof e?n(e):!!e)},o=a.normalize=function(t){return String(t).replace(r,".").toLowerCase()},s=a.data={},h=a.NATIVE="N",c=a.POLYFILL="P";t.exports=a},"99af":function(t,e,i){"use strict";var n=i("23e7"),r=i("d039"),a=i("e8b5"),o=i("861d"),s=i("7b0b"),h=i("50c4"),c=i("8418"),l=i("65f0"),d=i("1dde"),u=i("b622"),f=i("2d00"),p=u("isConcatSpreadable"),g=9007199254740991,y="Maximum allowed index exceeded",v=f>=51||!r((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),x=d("concat"),m=function(t){if(!o(t))return!1;var e=t[p];return void 0!==e?!!e:a(t)},b=!v||!x;n({target:"Array",proto:!0,forced:b},{concat:function(t){var e,i,n,r,a,o=s(this),d=l(o,0),u=0;for(e=-1,n=arguments.length;e<n;e++)if(a=-1===e?o:arguments[e],m(a)){if(r=h(a.length),u+r>g)throw TypeError(y);for(i=0;i<r;i++,u++)i in a&&c(d,u,a[i])}else{if(u>=g)throw TypeError(y);c(d,u++,a)}return d.length=u,d}})},"9bdd":function(t,e,i){var n=i("825a"),r=i("2a62");t.exports=function(t,e,i,a){try{return a?e(n(i)[0],i[1]):e(i)}catch(o){throw r(t),o}}},"9bf2":function(t,e,i){var n=i("83ab"),r=i("0cfb"),a=i("825a"),o=i("c04e"),s=Object.defineProperty;e.f=n?s:function(t,e,i){if(a(t),e=o(e,!0),a(i),r)try{return s(t,e,i)}catch(n){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},"9ed3":function(t,e,i){"use strict";var n=i("ae93").IteratorPrototype,r=i("7c73"),a=i("5c6c"),o=i("d44e"),s=i("3f8c"),h=function(){return this};t.exports=function(t,e,i){var c=e+" Iterator";return t.prototype=r(n,{next:a(1,i)}),o(t,c,!1,!0),s[c]=h,t}},"9f7f":function(t,e,i){"use strict";var n=i("d039");function r(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=n((function(){var t=r("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=n((function(){var t=r("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},a2bf:function(t,e,i){"use strict";var n=i("e8b5"),r=i("50c4"),a=i("0366"),o=function(t,e,i,s,h,c,l,d){var u,f=h,p=0,g=!!l&&a(l,d,3);while(p<s){if(p in i){if(u=g?g(i[p],p,e):i[p],c>0&&n(u))f=o(t,e,u,r(u.length),f,c-1)-1;else{if(f>=9007199254740991)throw TypeError("Exceed the acceptable array length");t[f]=u}f++}p++}return f};t.exports=o},a4b4:function(t,e,i){var n=i("342f");t.exports=/web0s(?!.*chrome)/i.test(n)},a4d3:function(t,e,i){"use strict";var n=i("23e7"),r=i("da84"),a=i("d066"),o=i("c430"),s=i("83ab"),h=i("4930"),c=i("fdbf"),l=i("d039"),d=i("5135"),u=i("e8b5"),f=i("861d"),p=i("825a"),g=i("7b0b"),y=i("fc6a"),v=i("c04e"),x=i("5c6c"),m=i("7c73"),b=i("df75"),w=i("241c"),_=i("057f"),S=i("7418"),P=i("06cf"),A=i("9bf2"),C=i("d1e7"),R=i("9112"),L=i("6eeb"),k=i("5692"),T=i("f772"),M=i("d012"),E=i("90e3"),O=i("b622"),D=i("e538"),I=i("746f"),W=i("d44e"),G=i("69f3"),F=i("b727").forEach,B=T("hidden"),H="Symbol",N="prototype",j=O("toPrimitive"),z=G.set,Y=G.getterFor(H),U=Object[N],X=r.Symbol,q=a("JSON","stringify"),V=P.f,Q=A.f,K=_.f,J=C.f,Z=k("symbols"),$=k("op-symbols"),tt=k("string-to-symbol-registry"),et=k("symbol-to-string-registry"),it=k("wks"),nt=r.QObject,rt=!nt||!nt[N]||!nt[N].findChild,at=s&&l((function(){return 7!=m(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a}))?function(t,e,i){var n=V(U,e);n&&delete U[e],Q(t,e,i),n&&t!==U&&Q(U,e,n)}:Q,ot=function(t,e){var i=Z[t]=m(X[N]);return z(i,{type:H,tag:t,description:e}),s||(i.description=e),i},st=c?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof X},ht=function(t,e,i){t===U&&ht($,e,i),p(t);var n=v(e,!0);return p(i),d(Z,n)?(i.enumerable?(d(t,B)&&t[B][n]&&(t[B][n]=!1),i=m(i,{enumerable:x(0,!1)})):(d(t,B)||Q(t,B,x(1,{})),t[B][n]=!0),at(t,n,i)):Q(t,n,i)},ct=function(t,e){p(t);var i=y(e),n=b(i).concat(pt(i));return F(n,(function(e){s&&!dt.call(i,e)||ht(t,e,i[e])})),t},lt=function(t,e){return void 0===e?m(t):ct(m(t),e)},dt=function(t){var e=v(t,!0),i=J.call(this,e);return!(this===U&&d(Z,e)&&!d($,e))&&(!(i||!d(this,e)||!d(Z,e)||d(this,B)&&this[B][e])||i)},ut=function(t,e){var i=y(t),n=v(e,!0);if(i!==U||!d(Z,n)||d($,n)){var r=V(i,n);return!r||!d(Z,n)||d(i,B)&&i[B][n]||(r.enumerable=!0),r}},ft=function(t){var e=K(y(t)),i=[];return F(e,(function(t){d(Z,t)||d(M,t)||i.push(t)})),i},pt=function(t){var e=t===U,i=K(e?$:y(t)),n=[];return F(i,(function(t){!d(Z,t)||e&&!d(U,t)||n.push(Z[t])})),n};if(h||(X=function(){if(this instanceof X)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=E(t),i=function(t){this===U&&i.call($,t),d(this,B)&&d(this[B],e)&&(this[B][e]=!1),at(this,e,x(1,t))};return s&&rt&&at(U,e,{configurable:!0,set:i}),ot(e,t)},L(X[N],"toString",(function(){return Y(this).tag})),L(X,"withoutSetter",(function(t){return ot(E(t),t)})),C.f=dt,A.f=ht,P.f=ut,w.f=_.f=ft,S.f=pt,D.f=function(t){return ot(O(t),t)},s&&(Q(X[N],"description",{configurable:!0,get:function(){return Y(this).description}}),o||L(U,"propertyIsEnumerable",dt,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:X}),F(b(it),(function(t){I(t)})),n({target:H,stat:!0,forced:!h},{for:function(t){var e=String(t);if(d(tt,e))return tt[e];var i=X(e);return tt[e]=i,et[i]=e,i},keyFor:function(t){if(!st(t))throw TypeError(t+" is not a symbol");if(d(et,t))return et[t]},useSetter:function(){rt=!0},useSimple:function(){rt=!1}}),n({target:"Object",stat:!0,forced:!h,sham:!s},{create:lt,defineProperty:ht,defineProperties:ct,getOwnPropertyDescriptor:ut}),n({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:ft,getOwnPropertySymbols:pt}),n({target:"Object",stat:!0,forced:l((function(){S.f(1)}))},{getOwnPropertySymbols:function(t){return S.f(g(t))}}),q){var gt=!h||l((function(){var t=X();return"[null]"!=q([t])||"{}"!=q({a:t})||"{}"!=q(Object(t))}));n({target:"JSON",stat:!0,forced:gt},{stringify:function(t,e,i){var n,r=[t],a=1;while(arguments.length>a)r.push(arguments[a++]);if(n=e,(f(e)||void 0!==t)&&!st(t))return u(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!st(e))return e}),r[1]=e,q.apply(null,r)}})}X[N][j]||R(X[N],j,X[N].valueOf),W(X,H),M[B]=!0},a630:function(t,e,i){var n=i("23e7"),r=i("4df4"),a=i("1c7e"),o=!a((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:o},{from:r})},a640:function(t,e,i){"use strict";var n=i("d039");t.exports=function(t,e){var i=[][t];return!!i&&n((function(){i.call(null,e||function(){throw 1},1)}))}},a691:function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},a9e3:function(t,e,i){"use strict";var n=i("83ab"),r=i("da84"),a=i("94ca"),o=i("6eeb"),s=i("5135"),h=i("c6b6"),c=i("7156"),l=i("c04e"),d=i("d039"),u=i("7c73"),f=i("241c").f,p=i("06cf").f,g=i("9bf2").f,y=i("58a8").trim,v="Number",x=r[v],m=x.prototype,b=h(u(m))==v,w=function(t){var e,i,n,r,a,o,s,h,c=l(t,!1);if("string"==typeof c&&c.length>2)if(c=y(c),e=c.charCodeAt(0),43===e||45===e){if(i=c.charCodeAt(2),88===i||120===i)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+c}for(a=c.slice(2),o=a.length,s=0;s<o;s++)if(h=a.charCodeAt(s),h<48||h>r)return NaN;return parseInt(a,n)}return+c};if(a(v,!x(" 0o1")||!x("0b1")||x("+0x1"))){for(var _,S=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof S&&(b?d((function(){m.valueOf.call(i)})):h(i)!=v)?c(new x(w(e)),i,S):w(e)},P=n?f(x):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),A=0;P.length>A;A++)s(x,_=P[A])&&!s(S,_)&&g(S,_,p(x,_));S.prototype=m,m.constructor=S,o(r,v,S)}},ab13:function(t,e,i){var n=i("b622"),r=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[r]=!1,"/./"[t](e)}catch(n){}}return!1}},ac1f:function(t,e,i){"use strict";var n=i("23e7"),r=i("9263");n({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},ad6d:function(t,e,i){"use strict";var n=i("825a");t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},ae93:function(t,e,i){"use strict";var n,r,a,o=i("d039"),s=i("e163"),h=i("9112"),c=i("5135"),l=i("b622"),d=i("c430"),u=l("iterator"),f=!1,p=function(){return this};[].keys&&(a=[].keys(),"next"in a?(r=s(s(a)),r!==Object.prototype&&(n=r)):f=!0);var g=void 0==n||o((function(){var t={};return n[u].call(t)!==t}));g&&(n={}),d&&!g||c(n,u)||h(n,u,p),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:f}},b041:function(t,e,i){"use strict";var n=i("00ee"),r=i("f5df");t.exports=n?{}.toString:function(){return"[object "+r(this)+"]"}},b0c0:function(t,e,i){var n=i("83ab"),r=i("9bf2").f,a=Function.prototype,o=a.toString,s=/^\s*function ([^ (]*)/,h="name";n&&!(h in a)&&r(a,h,{configurable:!0,get:function(){try{return o.call(this).match(s)[1]}catch(t){return""}}})},b575:function(t,e,i){var n,r,a,o,s,h,c,l,d=i("da84"),u=i("06cf").f,f=i("2cf4").set,p=i("1cdc"),g=i("a4b4"),y=i("605d"),v=d.MutationObserver||d.WebKitMutationObserver,x=d.document,m=d.process,b=d.Promise,w=u(d,"queueMicrotask"),_=w&&w.value;_||(n=function(){var t,e;y&&(t=m.domain)&&t.exit();while(r){e=r.fn,r=r.next;try{e()}catch(i){throw r?o():a=void 0,i}}a=void 0,t&&t.enter()},p||y||g||!v||!x?b&&b.resolve?(c=b.resolve(void 0),l=c.then,o=function(){l.call(c,n)}):o=y?function(){m.nextTick(n)}:function(){f.call(d,n)}:(s=!0,h=x.createTextNode(""),new v(n).observe(h,{characterData:!0}),o=function(){h.data=s=!s})),t.exports=_||function(t){var e={fn:t,next:void 0};a&&(a.next=e),r||(r=e,o()),a=e}},b622:function(t,e,i){var n=i("da84"),r=i("5692"),a=i("5135"),o=i("90e3"),s=i("4930"),h=i("fdbf"),c=r("wks"),l=n.Symbol,d=h?l:l&&l.withoutSetter||o;t.exports=function(t){return a(c,t)&&(s||"string"==typeof c[t])||(s&&a(l,t)?c[t]=l[t]:c[t]=d("Symbol."+t)),c[t]}},b64b:function(t,e,i){var n=i("23e7"),r=i("7b0b"),a=i("df75"),o=i("d039"),s=o((function(){a(1)}));n({target:"Object",stat:!0,forced:s},{keys:function(t){return a(r(t))}})},b727:function(t,e,i){var n=i("0366"),r=i("44ad"),a=i("7b0b"),o=i("50c4"),s=i("65f0"),h=[].push,c=function(t){var e=1==t,i=2==t,c=3==t,l=4==t,d=6==t,u=7==t,f=5==t||d;return function(p,g,y,v){for(var x,m,b=a(p),w=r(b),_=n(g,y,3),S=o(w.length),P=0,A=v||s,C=e?A(p,S):i||u?A(p,0):void 0;S>P;P++)if((f||P in w)&&(x=w[P],m=_(x,P,b),t))if(e)C[P]=m;else if(m)switch(t){case 3:return!0;case 5:return x;case 6:return P;case 2:h.call(C,x)}else switch(t){case 4:return!1;case 7:h.call(C,x)}return d?-1:c||l?l:C}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},bb2f:function(t,e,i){var n=i("d039");t.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},c04e:function(t,e,i){var n=i("861d");t.exports=function(t,e){if(!n(t))return t;var i,r;if(e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;if("function"==typeof(i=t.valueOf)&&!n(r=i.call(t)))return r;if(!e&&"function"==typeof(i=t.toString)&&!n(r=i.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},c430:function(t,e){t.exports=!1},c6b6:function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},c6cd:function(t,e,i){var n=i("da84"),r=i("ce4e"),a="__core-js_shared__",o=n[a]||r(a,{});t.exports=o},c740:function(t,e,i){"use strict";var n=i("23e7"),r=i("b727").findIndex,a=i("44d2"),o="findIndex",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),n({target:"Array",proto:!0,forced:s},{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a(o)},c8ba:function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(n){"object"===typeof window&&(i=window)}t.exports=i},ca84:function(t,e,i){var n=i("5135"),r=i("fc6a"),a=i("4d64").indexOf,o=i("d012");t.exports=function(t,e){var i,s=r(t),h=0,c=[];for(i in s)!n(o,i)&&n(s,i)&&c.push(i);while(e.length>h)n(s,i=e[h++])&&(~a(c,i)||c.push(i));return c}},caad:function(t,e,i){"use strict";var n=i("23e7"),r=i("4d64").includes,a=i("44d2");n({target:"Array",proto:!0},{includes:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a("includes")},cc12:function(t,e,i){var n=i("da84"),r=i("861d"),a=n.document,o=r(a)&&r(a.createElement);t.exports=function(t){return o?a.createElement(t):{}}},cca6:function(t,e,i){var n=i("23e7"),r=i("60da");n({target:"Object",stat:!0,forced:Object.assign!==r},{assign:r})},cdf9:function(t,e,i){var n=i("825a"),r=i("861d"),a=i("f069");t.exports=function(t,e){if(n(t),r(e)&&e.constructor===t)return e;var i=a.f(t),o=i.resolve;return o(e),i.promise}},ce4e:function(t,e,i){var n=i("da84"),r=i("9112");t.exports=function(t,e){try{r(n,t,e)}catch(i){n[t]=e}return e}},d012:function(t,e){t.exports={}},d039:function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},d066:function(t,e,i){var n=i("428f"),r=i("da84"),a=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?a(n[t])||a(r[t]):n[t]&&n[t][e]||r[t]&&r[t][e]}},d1e7:function(t,e,i){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,a=r&&!n.call({1:2},1);e.f=a?function(t){var e=r(this,t);return!!e&&e.enumerable}:n},d28b:function(t,e,i){var n=i("746f");n("iterator")},d2bb:function(t,e,i){var n=i("825a"),r=i("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,t.call(i,[]),e=i instanceof Array}catch(a){}return function(i,a){return n(i),r(a),e?t.call(i,a):i.__proto__=a,i}}():void 0)},d3b7:function(t,e,i){var n=i("00ee"),r=i("6eeb"),a=i("b041");n||r(Object.prototype,"toString",a,{unsafe:!0})},d44e:function(t,e,i){var n=i("9bf2").f,r=i("5135"),a=i("b622"),o=a("toStringTag");t.exports=function(t,e,i){t&&!r(t=i?t:t.prototype,o)&&n(t,o,{configurable:!0,value:e})}},d777:function(t,e,i){"use strict";(function(t){i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return s}));var n=Math.PI/180;function r(){return"undefined"!==typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window))}const a="undefined"!==typeof t?t:"undefined"!==typeof window?window:"undefined"!==typeof WorkerGlobalScope?self:{},o={_global:a,version:"8.3.8",isBrowser:r(),isUnminified:/param/.test(function(t){}.toString()),dblClickWindow:400,getAngle(t){return o.angleDeg?t*n:t},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:"undefined"!==typeof window&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return o["DD"].isDragging},isDragReady(){return!!o["DD"].node},document:a.document,_injectGlobal(t){a.Konva=t}},s=t=>{o[t.prototype.getClassName()]=t};o._injectGlobal(o)}).call(this,i("c8ba"))},d784:function(t,e,i){"use strict";i("ac1f");var n=i("6eeb"),r=i("d039"),a=i("b622"),o=i("9263"),s=i("9112"),h=a("species"),c=!r((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),l=function(){return"$0"==="a".replace(/./,"$0")}(),d=a("replace"),u=function(){return!!/./[d]&&""===/./[d]("a","$0")}(),f=!r((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var i="ab".split(t);return 2!==i.length||"a"!==i[0]||"b"!==i[1]}));t.exports=function(t,e,i,d){var p=a(t),g=!r((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),y=g&&!r((function(){var e=!1,i=/a/;return"split"===t&&(i={},i.constructor={},i.constructor[h]=function(){return i},i.flags="",i[p]=/./[p]),i.exec=function(){return e=!0,null},i[p](""),!e}));if(!g||!y||"replace"===t&&(!c||!l||u)||"split"===t&&!f){var v=/./[p],x=i(p,""[t],(function(t,e,i,n,r){return e.exec===o?g&&!r?{done:!0,value:v.call(e,i,n)}:{done:!0,value:t.call(i,e,n)}:{done:!1}}),{REPLACE_KEEPS_$0:l,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:u}),m=x[0],b=x[1];n(String.prototype,t,m),n(RegExp.prototype,p,2==e?function(t,e){return b.call(t,this,e)}:function(t){return b.call(t,this)})}d&&s(RegExp.prototype[p],"sham",!0)}},d81d:function(t,e,i){"use strict";var n=i("23e7"),r=i("b727").map,a=i("1dde"),o=a("map");n({target:"Array",proto:!0,forced:!o},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},da84:function(t,e,i){(function(e){var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this,i("c8ba"))},dbb4:function(t,e,i){var n=i("23e7"),r=i("83ab"),a=i("56ef"),o=i("fc6a"),s=i("06cf"),h=i("8418");n({target:"Object",stat:!0,sham:!r},{getOwnPropertyDescriptors:function(t){var e,i,n=o(t),r=s.f,c=a(n),l={},d=0;while(c.length>d)i=r(n,e=c[d++]),void 0!==i&&h(l,e,i);return l}})},ddb0:function(t,e,i){var n=i("da84"),r=i("fdbc"),a=i("e260"),o=i("9112"),s=i("b622"),h=s("iterator"),c=s("toStringTag"),l=a.values;for(var d in r){var u=n[d],f=u&&u.prototype;if(f){if(f[h]!==l)try{o(f,h,l)}catch(g){f[h]=l}if(f[c]||o(f,c,d),r[d])for(var p in a)if(f[p]!==a[p])try{o(f,p,a[p])}catch(g){f[p]=a[p]}}}},df75:function(t,e,i){var n=i("ca84"),r=i("7839");t.exports=Object.keys||function(t){return n(t,r)}},e01a:function(t,e,i){"use strict";var n=i("23e7"),r=i("83ab"),a=i("da84"),o=i("5135"),s=i("861d"),h=i("9bf2").f,c=i("e893"),l=a.Symbol;if(r&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var d={},u=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof u?new l(t):void 0===t?l():l(t);return""===t&&(d[e]=!0),e};c(u,l);var f=u.prototype=l.prototype;f.constructor=u;var p=f.toString,g="Symbol(test)"==String(l("test")),y=/^Symbol\((.*)\)[^)]+$/;h(f,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=p.call(t);if(o(d,t))return"";var i=g?e.slice(7,-1):e.replace(y,"$1");return""===i?void 0:i}}),n({global:!0,forced:!0},{Symbol:u})}},e163:function(t,e,i){var n=i("5135"),r=i("7b0b"),a=i("f772"),o=i("e177"),s=a("IE_PROTO"),h=Object.prototype;t.exports=o?Object.getPrototypeOf:function(t){return t=r(t),n(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?h:null}},e177:function(t,e,i){var n=i("d039");t.exports=!n((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},e260:function(t,e,i){"use strict";var n=i("fc6a"),r=i("44d2"),a=i("3f8c"),o=i("69f3"),s=i("7dd0"),h="Array Iterator",c=o.set,l=o.getterFor(h);t.exports=s(Array,"Array",(function(t,e){c(this,{type:h,target:n(t),index:0,kind:e})}),(function(){var t=l(this),e=t.target,i=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:n,done:!1}:"values"==i?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}}),"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},e2cc:function(t,e,i){var n=i("6eeb");t.exports=function(t,e,i){for(var r in e)n(t,r,e[r],i);return t}},e439:function(t,e,i){var n=i("23e7"),r=i("d039"),a=i("fc6a"),o=i("06cf").f,s=i("83ab"),h=r((function(){o(1)})),c=!s||h;n({target:"Object",stat:!0,forced:c,sham:!s},{getOwnPropertyDescriptor:function(t,e){return o(a(t),e)}})},e538:function(t,e,i){var n=i("b622");e.f=n},e667:function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}},e6cf:function(t,e,i){"use strict";var n,r,a,o,s=i("23e7"),h=i("c430"),c=i("da84"),l=i("d066"),d=i("fea9"),u=i("6eeb"),f=i("e2cc"),p=i("d44e"),g=i("2626"),y=i("861d"),v=i("1c0b"),x=i("19aa"),m=i("8925"),b=i("2266"),w=i("1c7e"),_=i("4840"),S=i("2cf4").set,P=i("b575"),A=i("cdf9"),C=i("44de"),R=i("f069"),L=i("e667"),k=i("69f3"),T=i("94ca"),M=i("b622"),E=i("605d"),O=i("2d00"),D=M("species"),I="Promise",W=k.get,G=k.set,F=k.getterFor(I),B=d,H=c.TypeError,N=c.document,j=c.process,z=l("fetch"),Y=R.f,U=Y,X=!!(N&&N.createEvent&&c.dispatchEvent),q="function"==typeof PromiseRejectionEvent,V="unhandledrejection",Q="rejectionhandled",K=0,J=1,Z=2,$=1,tt=2,et=T(I,(function(){var t=m(B)!==String(B);if(!t){if(66===O)return!0;if(!E&&!q)return!0}if(h&&!B.prototype["finally"])return!0;if(O>=51&&/native code/.test(B))return!1;var e=B.resolve(1),i=function(t){t((function(){}),(function(){}))},n=e.constructor={};return n[D]=i,!(e.then((function(){}))instanceof i)})),it=et||!w((function(t){B.all(t)["catch"]((function(){}))})),nt=function(t){var e;return!(!y(t)||"function"!=typeof(e=t.then))&&e},rt=function(t,e){if(!t.notified){t.notified=!0;var i=t.reactions;P((function(){var n=t.value,r=t.state==J,a=0;while(i.length>a){var o,s,h,c=i[a++],l=r?c.ok:c.fail,d=c.resolve,u=c.reject,f=c.domain;try{l?(r||(t.rejection===tt&&ht(t),t.rejection=$),!0===l?o=n:(f&&f.enter(),o=l(n),f&&(f.exit(),h=!0)),o===c.promise?u(H("Promise-chain cycle")):(s=nt(o))?s.call(o,d,u):d(o)):u(n)}catch(p){f&&!h&&f.exit(),u(p)}}t.reactions=[],t.notified=!1,e&&!t.rejection&&ot(t)}))}},at=function(t,e,i){var n,r;X?(n=N.createEvent("Event"),n.promise=e,n.reason=i,n.initEvent(t,!1,!0),c.dispatchEvent(n)):n={promise:e,reason:i},!q&&(r=c["on"+t])?r(n):t===V&&C("Unhandled promise rejection",i)},ot=function(t){S.call(c,(function(){var e,i=t.facade,n=t.value,r=st(t);if(r&&(e=L((function(){E?j.emit("unhandledRejection",n,i):at(V,i,n)})),t.rejection=E||st(t)?tt:$,e.error))throw e.value}))},st=function(t){return t.rejection!==$&&!t.parent},ht=function(t){S.call(c,(function(){var e=t.facade;E?j.emit("rejectionHandled",e):at(Q,e,t.value)}))},ct=function(t,e,i){return function(n){t(e,n,i)}},lt=function(t,e,i){t.done||(t.done=!0,i&&(t=i),t.value=e,t.state=Z,rt(t,!0))},dt=function(t,e,i){if(!t.done){t.done=!0,i&&(t=i);try{if(t.facade===e)throw H("Promise can't be resolved itself");var n=nt(e);n?P((function(){var i={done:!1};try{n.call(e,ct(dt,i,t),ct(lt,i,t))}catch(r){lt(i,r,t)}})):(t.value=e,t.state=J,rt(t,!1))}catch(r){lt({done:!1},r,t)}}};et&&(B=function(t){x(this,B,I),v(t),n.call(this);var e=W(this);try{t(ct(dt,e),ct(lt,e))}catch(i){lt(e,i)}},n=function(t){G(this,{type:I,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:K,value:void 0})},n.prototype=f(B.prototype,{then:function(t,e){var i=F(this),n=Y(_(this,B));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=E?j.domain:void 0,i.parent=!0,i.reactions.push(n),i.state!=K&&rt(i,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new n,e=W(t);this.promise=t,this.resolve=ct(dt,e),this.reject=ct(lt,e)},R.f=Y=function(t){return t===B||t===a?new r(t):U(t)},h||"function"!=typeof d||(o=d.prototype.then,u(d.prototype,"then",(function(t,e){var i=this;return new B((function(t,e){o.call(i,t,e)})).then(t,e)}),{unsafe:!0}),"function"==typeof z&&s({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return A(B,z.apply(c,arguments))}}))),s({global:!0,wrap:!0,forced:et},{Promise:B}),p(B,I,!1,!0),g(I),a=l(I),s({target:I,stat:!0,forced:et},{reject:function(t){var e=Y(this);return e.reject.call(void 0,t),e.promise}}),s({target:I,stat:!0,forced:h||et},{resolve:function(t){return A(h&&this===a?B:this,t)}}),s({target:I,stat:!0,forced:it},{all:function(t){var e=this,i=Y(e),n=i.resolve,r=i.reject,a=L((function(){var i=v(e.resolve),a=[],o=0,s=1;b(t,(function(t){var h=o++,c=!1;a.push(void 0),s++,i.call(e,t).then((function(t){c||(c=!0,a[h]=t,--s||n(a))}),r)})),--s||n(a)}));return a.error&&r(a.value),i.promise},race:function(t){var e=this,i=Y(e),n=i.reject,r=L((function(){var r=v(e.resolve);b(t,(function(t){r.call(e,t).then(i.resolve,n)}))}));return r.error&&n(r.value),i.promise}})},e893:function(t,e,i){var n=i("5135"),r=i("56ef"),a=i("06cf"),o=i("9bf2");t.exports=function(t,e){for(var i=r(e),s=o.f,h=a.f,c=0;c<i.length;c++){var l=i[c];n(t,l)||s(t,l,h(e,l))}}},e8b5:function(t,e,i){var n=i("c6b6");t.exports=Array.isArray||function(t){return"Array"==n(t)}},e95a:function(t,e,i){var n=i("b622"),r=i("3f8c"),a=n("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[a]===t)}},f069:function(t,e,i){"use strict";var n=i("1c0b"),r=function(t){var e,i;this.promise=new t((function(t,n){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=n})),this.resolve=n(e),this.reject=n(i)};t.exports.f=function(t){return new r(t)}},f183:function(t,e,i){var n=i("d012"),r=i("861d"),a=i("5135"),o=i("9bf2").f,s=i("90e3"),h=i("bb2f"),c=s("meta"),l=0,d=Object.isExtensible||function(){return!0},u=function(t){o(t,c,{value:{objectID:"O"+ ++l,weakData:{}}})},f=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!a(t,c)){if(!d(t))return"F";if(!e)return"E";u(t)}return t[c].objectID},p=function(t,e){if(!a(t,c)){if(!d(t))return!0;if(!e)return!1;u(t)}return t[c].weakData},g=function(t){return h&&y.REQUIRED&&d(t)&&!a(t,c)&&u(t),t},y=t.exports={REQUIRED:!1,fastKey:f,getWeakData:p,onFreeze:g};n[c]=!0},f5df:function(t,e,i){var n=i("00ee"),r=i("c6b6"),a=i("b622"),o=a("toStringTag"),s="Arguments"==r(function(){return arguments}()),h=function(t,e){try{return t[e]}catch(i){}};t.exports=n?r:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=h(e=Object(t),o))?i:s?r(e):"Object"==(n=r(e))&&"function"==typeof e.callee?"Arguments":n}},f772:function(t,e,i){var n=i("5692"),r=i("90e3"),a=n("keys");t.exports=function(t){return a[t]||(a[t]=r(t))}},fa87:function(t,e,i){"use strict";i("30a9")},fb15:function(t,e,i){"use strict";if(i.r(e),i.d(e,"tfInterModel",(function(){return Qr})),"undefined"!==typeof window){var n=window.document.currentScript,r=i("8875");n=r(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:r});var a=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);a&&(i.p=a[1])}i("d81d"),i("b0c0");var o=i("8bbf"),s={class:"sc-tf-inter-model",ref:"tfInterModel"},h={class:"sc-tf-inter-box",ref:"scTfInterBox"},c={class:"sc-tf-phase-box",ref:"scTfPhaseBox"};function l(t,e,i,n,r,a){return Object(o["openBlock"])(),Object(o["createBlock"])("div",s,[Object(o["createVNode"])("div",h,null,512),Object(o["withDirectives"])(Object(o["createVNode"])("div",{class:"overflow-box",style:{width:t.phaseWidth+"px"}},[Object(o["createVNode"])("div",c,null,512)],4),[[o["vShow"],t.drawOption.drawPhase]])],512)}i("277d");function d(t){if(Array.isArray(t))return t}i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("e260"),i("ddb0");function u(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)if(i.push(o.value),e&&i.length===e)break}catch(h){r=!0,a=h}finally{try{n||null==s["return"]||s["return"]()}finally{if(r)throw a}}return i}}i("fb6a"),i("a630");function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function p(t,e){if(t){if("string"===typeof t)return f(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(t,e):void 0}}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function y(t,e){return d(t)||u(t,e)||p(t,e)||g()}function v(t){if(Array.isArray(t))return f(t)}function x(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(t){return v(t)||x(t)||p(t)||m()}i("b64b"),i("4de4"),i("e439"),i("4160"),i("159b"),i("dbb4"),i("1d1c"),i("7a82");function w(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function S(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?_(Object(i),!0).forEach((function(e){w(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):_(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}i("cca6"),i("0481"),i("7db0"),i("c740"),i("99af"),i("e6cf"),i("1276"),i("ac1f"),i("25f0"),i("0d03"),i("26e9"),i("a9e3"),i("caad"),i("6062"),i("2532");var P=i("d777");class A{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new A(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){var e=Math.cos(t),i=Math.sin(t),n=this.m[0]*e+this.m[2]*i,r=this.m[1]*e+this.m[3]*i,a=this.m[0]*-i+this.m[2]*e,o=this.m[1]*-i+this.m[3]*e;return this.m[0]=n,this.m[1]=r,this.m[2]=a,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){var i=this.m[0]+this.m[2]*e,n=this.m[1]+this.m[3]*e,r=this.m[2]+this.m[0]*t,a=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=n,this.m[2]=r,this.m[3]=a,this}multiply(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],n=this.m[0]*t.m[2]+this.m[2]*t.m[3],r=this.m[1]*t.m[2]+this.m[3]*t.m[3],a=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=i,this.m[2]=n,this.m[3]=r,this.m[4]=a,this.m[5]=o,this}invert(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,i=-this.m[1]*t,n=-this.m[2]*t,r=this.m[0]*t,a=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=i,this.m[2]=n,this.m[3]=r,this.m[4]=a,this.m[5]=o,this}getMatrix(){return this.m}decompose(){var t=this.m[0],e=this.m[1],i=this.m[2],n=this.m[3],r=this.m[4],a=this.m[5],o=t*n-e*i;let s={x:r,y:a,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=t||0!=e){var h=Math.sqrt(t*t+e*e);s.rotation=e>0?Math.acos(t/h):-Math.acos(t/h),s.scaleX=h,s.scaleY=o/h,s.skewX=(t*i+e*n)/o,s.skewY=0}else if(0!=i||0!=n){var c=Math.sqrt(i*i+n*n);s.rotation=Math.PI/2-(n>0?Math.acos(-i/c):-Math.acos(i/c)),s.scaleX=o/c,s.scaleY=c,s.skewX=0,s.skewY=(t*i+e*n)/o}return s.rotation=j._getRotation(s.rotation),s}}var C="[object Array]",R="[object Number]",L="[object String]",k="[object Boolean]",T=Math.PI/180,M=180/Math.PI,E="#",O="",D="0",I="Konva warning: ",W="Konva error: ",G="rgb(",F={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},B=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,H=[];const N="undefined"!==typeof requestAnimationFrame&&requestAnimationFrame||function(t){setTimeout(t,60)},j={_isElement(t){return!(!t||1!=t.nodeType)},_isFunction(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isPlainObject(t){return!!t&&t.constructor===Object},_isArray(t){return Object.prototype.toString.call(t)===C},_isNumber(t){return Object.prototype.toString.call(t)===R&&!isNaN(t)&&isFinite(t)},_isString(t){return Object.prototype.toString.call(t)===L},_isBoolean(t){return Object.prototype.toString.call(t)===k},isObject(t){return t instanceof Object},isValidSelector(t){if("string"!==typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign(t){return 0===t||t>0?1:-1},requestAnimFrame(t){H.push(t),1===H.length&&N((function(){const t=H;H=[],t.forEach((function(t){t()}))}))},createCanvasElement(){var t=document.createElement("canvas");try{t.style=t.style||{}}catch(e){}return t},createImageElement(){return document.createElement("img")},_isInDocument(t){while(t=t.parentNode)if(t==document)return!0;return!1},_urlToImage(t,e){var i=j.createImageElement();i.onload=function(){e(i)},i.src=t},_rgbToHex(t,e,i){return((1<<24)+(t<<16)+(e<<8)+i).toString(16).slice(1)},_hexToRgb(t){t=t.replace(E,O);var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor(){var t=(16777215*Math.random()<<0).toString(16);while(t.length<6)t=D+t;return E+t},getRGB(t){var e;return t in F?(e=F[t],{r:e[0],g:e[1],b:e[2]}):t[0]===E?this._hexToRgb(t.substring(1)):t.substr(0,4)===G?(e=B.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA(t){return t=t||"black",j._namedColorToRBA(t)||j._hex3ColorToRGBA(t)||j._hex6ColorToRGBA(t)||j._rgbColorToRGBA(t)||j._rgbaColorToRGBA(t)||j._hslColorToRGBA(t)},_namedColorToRBA(t){var e=F[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(t){if(0===t.indexOf("rgb(")){t=t.match(/rgb\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(t){if(0===t.indexOf("rgba(")){t=t.match(/rgba\(([^)]+)\)/)[1];var e=t.split(/ *, */).map((t,e)=>"%"===t.slice(-1)?3===e?parseInt(t)/100:parseInt(t)/100*255:Number(t));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex6ColorToRGBA(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex3ColorToRGBA(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){const[e,...i]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),n=Number(i[0])/360,r=Number(i[1])/100,a=Number(i[2])/100;let o,s,h;if(0===r)return h=255*a,{r:Math.round(h),g:Math.round(h),b:Math.round(h),a:1};o=a<.5?a*(1+r):a+r-a*r;const c=2*a-o,l=[0,0,0];for(let t=0;t<3;t++)s=n+1/3*-(t-1),s<0&&s++,s>1&&s--,h=6*s<1?c+6*(o-c)*s:2*s<1?o:3*s<2?c+(o-c)*(2/3-s)*6:c,l[t]=255*h;return{r:Math.round(l[0]),g:Math.round(l[1]),b:Math.round(l[2]),a:1}}},haveIntersection(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},cloneObject(t){var e={};for(var i in t)this._isPlainObject(t[i])?e[i]=this.cloneObject(t[i]):this._isArray(t[i])?e[i]=this.cloneArray(t[i]):e[i]=t[i];return e},cloneArray(t){return t.slice(0)},degToRad(t){return t*T},radToDeg(t){return t*M},_degToRad(t){return j.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),j.degToRad(t)},_radToDeg(t){return j.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),j.radToDeg(t)},_getRotation(t){return P["a"].angleDeg?j.radToDeg(t):t},_capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)},throw(t){throw new Error(W+t)},error(t){console.error(W+t)},warn(t){P["a"].showWarnings&&console.warn(I+t)},each(t,e){for(var i in t)e(i,t[i])},_inRange(t,e,i){return e<=t&&t<i},_getProjectionToSegment(t,e,i,n,r,a){var o,s,h,c=(t-i)*(t-i)+(e-n)*(e-n);if(0==c)o=t,s=e,h=(r-i)*(r-i)+(a-n)*(a-n);else{var l=((r-t)*(i-t)+(a-e)*(n-e))/c;l<0?(o=t,s=e,h=(t-r)*(t-r)+(e-a)*(e-a)):l>1?(o=i,s=n,h=(i-r)*(i-r)+(n-a)*(n-a)):(o=t+l*(i-t),s=e+l*(n-e),h=(o-r)*(o-r)+(s-a)*(s-a))}return[o,s,h]},_getProjectionToLine(t,e,i){var n=j.cloneObject(t),r=Number.MAX_VALUE;return e.forEach((function(a,o){if(i||o!==e.length-1){var s=e[(o+1)%e.length],h=j._getProjectionToSegment(a.x,a.y,s.x,s.y,t.x,t.y),c=h[0],l=h[1],d=h[2];d<r&&(n.x=c,n.y=l,r=d)}})),n},_prepareArrayForTween(t,e,i){var n,r=[],a=[];if(t.length>e.length){var o=e;e=t,t=o}for(n=0;n<t.length;n+=2)r.push({x:t[n],y:t[n+1]});for(n=0;n<e.length;n+=2)a.push({x:e[n],y:e[n+1]});var s=[];return a.forEach((function(t){var e=j._getProjectionToLine(t,r,i);s.push(e.x),s.push(e.y)})),s},_prepareToStringify(t){var e;for(var i in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(i)&&t[i]&&"object"==typeof t[i])if(e=Object.getOwnPropertyDescriptor(t,i),t[i].visitedByCircularReferenceRemoval||j._isElement(t[i])){if(!e.configurable)return null;delete t[i]}else if(null===j._prepareToStringify(t[i])){if(!e.configurable)return null;delete t[i]}return delete t.visitedByCircularReferenceRemoval,t},_assign(t,e){for(var i in e)t[i]=e[i];return t},_getFirstPointerId(t){return t.touches?t.changedTouches[0].identifier:t.pointerId||999}};function z(t){return j._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)||j._isBoolean(t)?t:Object.prototype.toString.call(t)}function Y(t){return t>255?255:t<0?0:Math.round(t)}function U(){if(P["a"].isUnminified)return function(t,e){return j._isNumber(t)||j.warn(z(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function X(t){if(P["a"].isUnminified)return function(e,i){let n=j._isNumber(e),r=j._isArray(e)&&e.length==t;return n||r||j.warn(z(e)+' is a not valid value for "'+i+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function q(){if(P["a"].isUnminified)return function(t,e){var i=j._isNumber(t),n="auto"===t;return i||n||j.warn(z(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function V(){if(P["a"].isUnminified)return function(t,e){return j._isString(t)||j.warn(z(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function Q(){if(P["a"].isUnminified)return function(t,e){const i=j._isString(t),n="[object CanvasGradient]"===Object.prototype.toString.call(t)||t&&t.addColorStop;return i||n||j.warn(z(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function K(){if(P["a"].isUnminified)return function(t,e){return j._isArray(t)?t.forEach((function(t){j._isNumber(t)||j.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")})):j.warn(z(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.'),t}}function J(){if(P["a"].isUnminified)return function(t,e){var i=!0===t||!1===t;return i||j.warn(z(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function Z(t){if(P["a"].isUnminified)return function(e,i){return j.isObject(e)||j.warn(z(e)+' is a not valid value for "'+i+'" attribute. The value should be an object with properties '+t),e}}var $="get",tt="set";const et={addGetterSetter(t,e,i,n,r){et.addGetter(t,e,i),et.addSetter(t,e,n,r),et.addOverloadedGetterSetter(t,e)},addGetter(t,e,i){var n=$+j._capitalize(e);t.prototype[n]=t.prototype[n]||function(){var t=this.attrs[e];return void 0===t?i:t}},addSetter(t,e,i,n){var r=tt+j._capitalize(e);t.prototype[r]||et.overWriteSetter(t,e,i,n)},overWriteSetter(t,e,i,n){var r=tt+j._capitalize(e);t.prototype[r]=function(t){return i&&void 0!==t&&null!==t&&(t=i.call(this,t,e)),this._setAttr(e,t),n&&n.call(this),this}},addComponentsGetterSetter(t,e,i,n,r){var a,o,s=i.length,h=j._capitalize,c=$+h(e),l=tt+h(e);t.prototype[c]=function(){var t={};for(a=0;a<s;a++)o=i[a],t[o]=this.getAttr(e+h(o));return t};var d=Z(i);t.prototype[l]=function(t){var i,a=this.attrs[e];for(i in n&&(t=n.call(this,t)),d&&d.call(this,t,e),t)t.hasOwnProperty(i)&&this._setAttr(e+h(i),t[i]);return this._fireChangeEvent(e,a,t),r&&r.call(this),this},et.addOverloadedGetterSetter(t,e)},addOverloadedGetterSetter(t,e){var i=j._capitalize(e),n=tt+i,r=$+i;t.prototype[e]=function(){return arguments.length?(this[n](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(t,e,i,n){j.error("Adding deprecated "+e);var r=$+j._capitalize(e),a=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[r]=function(){j.error(a);var t=this.attrs[e];return void 0===t?i:t},et.addSetter(t,e,n,(function(){j.error(a)})),et.addOverloadedGetterSetter(t,e)},backCompat(t,e){j.each(e,(function(e,i){var n=t.prototype[i],r=$+j._capitalize(e),a=tt+j._capitalize(e);function o(){n.apply(this,arguments),j.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}t.prototype[e]=o,t.prototype[r]=o,t.prototype[a]=o}))},afterSetFilter(){this._filterUpToDate=!1}};function it(t){var e,i,n=[],r=t.length,a=j;for(e=0;e<r;e++)i=t[e],a._isNumber(i)?i=Math.round(1e3*i)/1e3:a._isString(i)||(i+=""),n.push(i);return n}var nt=",",rt="(",at=")",ot="([",st="])",ht=";",ct="()",lt="=",dt=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],ut=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const ft=100;class pt{constructor(t){this.canvas=t,this._context=t._canvas.getContext("2d"),P["a"].enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){var i,n,r,a,o=this.traceArr,s=o.length,h="";for(i=0;i<s;i++)n=o[i],r=n.method,r?(a=n.args,h+=r,t?h+=ct:j._isArray(a[0])?h+=ot+a.join(nt)+st:(e&&(a=a.map(t=>"number"===typeof t?Math.floor(t):t)),h+=rt+a.join(nt)+at)):(h+=n.property,t||(h+=lt+n.val)),h+=ht;return h}clearTrace(){this.traceArr=[]}_trace(t){var e,i=this.traceArr;i.push(t),e=i.length,e>=ft&&i.shift()}reset(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){var e=t.getLineCap();e&&this.setAttr("lineCap",e)}_applyOpacity(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){var e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}setAttr(t,e){this._context[t]=e}arc(t,e,i,n,r,a){this._context.arc(t,e,i,n,r,a)}arcTo(t,e,i,n,r){this._context.arcTo(t,e,i,n,r)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,i,n,r,a){this._context.bezierCurveTo(t,e,i,n,r,a)}clearRect(t,e,i,n){this._context.clearRect(t,e,i,n)}clip(){this._context.clip()}closePath(){this._context.closePath()}createImageData(t,e){var i=arguments;return 2===i.length?this._context.createImageData(t,e):1===i.length?this._context.createImageData(t):void 0}createLinearGradient(t,e,i,n){return this._context.createLinearGradient(t,e,i,n)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,i,n,r,a){return this._context.createRadialGradient(t,e,i,n,r,a)}drawImage(t,e,i,n,r,a,o,s,h){var c=arguments,l=this._context;3===c.length?l.drawImage(t,e,i):5===c.length?l.drawImage(t,e,i,n,r):9===c.length&&l.drawImage(t,e,i,n,r,a,o,s,h)}ellipse(t,e,i,n,r,a,o,s){this._context.ellipse(t,e,i,n,r,a,o,s)}isPointInPath(t,e){return this._context.isPointInPath(t,e)}fill(t){t?this._context.fill(t):this._context.fill()}fillRect(t,e,i,n){this._context.fillRect(t,e,i,n)}strokeRect(t,e,i,n){this._context.strokeRect(t,e,i,n)}fillText(t,e,i,n){n?this._context.fillText(t,e,i,n):this._context.fillText(t,e,i)}measureText(t){return this._context.measureText(t)}getImageData(t,e,i,n){return this._context.getImageData(t,e,i,n)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,i,n){this._context.rect(t,e,i,n)}putImageData(t,e,i){this._context.putImageData(t,e,i)}quadraticCurveTo(t,e,i,n){this._context.quadraticCurveTo(t,e,i,n)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context["mozDash"]=t:"webkitLineDash"in this._context&&(this._context["webkitLineDash"]=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,i,n,r,a){this._context.setTransform(t,e,i,n,r,a)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,i,n){this._context.strokeText(t,e,i,n)}transform(t,e,i,n,r,a){this._context.transform(t,e,i,n,r,a)}translate(t,e){this._context.translate(t,e)}_enableTrace(){var t,e,i=this,n=dt.length,r=this.setAttr,a=function(t){var n,r=i[t];i[t]=function(){return e=it(Array.prototype.slice.call(arguments,0)),n=r.apply(i,arguments),i._trace({method:t,args:e}),n}};for(t=0;t<n;t++)a(dt[t]);i.setAttr=function(){r.apply(i,arguments);var t=arguments[0],e=arguments[1];"shadowOffsetX"!==t&&"shadowOffsetY"!==t&&"shadowBlur"!==t||(e/=this.canvas.getPixelRatio()),i._trace({property:t,val:e})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;var i=!e||"source-over"===e;i||this.setAttr("globalCompositeOperation",e)}}ut.forEach((function(t){Object.defineProperty(pt.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})}));class gt extends pt{_fillColor(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){var e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){var e=t.fill(),i=t.getFillPriority();if(e&&"color"===i)this._fillColor(t);else{var n=t.getFillPatternImage();if(n&&"pattern"===i)this._fillPattern(t);else{var r=t.getFillLinearGradientColorStops();if(r&&"linear-gradient"===i)this._fillLinearGradient(t);else{var a=t.getFillRadialGradientColorStops();a&&"radial-gradient"===i?this._fillRadialGradient(t):e?this._fillColor(t):n?this._fillPattern(t):r?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)}}}}_strokeLinearGradient(t){var e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),n=t.getStrokeLinearGradientColorStops(),r=this.createLinearGradient(e.x,e.y,i.x,i.y);if(n){for(var a=0;a<n.length;a+=2)r.addColorStop(n[a],n[a+1]);this.setAttr("strokeStyle",r)}}_stroke(t){var e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var r=t.getStrokeLinearGradientColorStops();r?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var e,i,n,r=null!==(e=t.getShadowRGBA())&&void 0!==e?e:"black",a=null!==(i=t.getShadowBlur())&&void 0!==i?i:5,o=null!==(n=t.getShadowOffset())&&void 0!==n?n:{x:0,y:0},s=t.getAbsoluteScale(),h=this.canvas.getPixelRatio(),c=s.x*h,l=s.y*h;this.setAttr("shadowColor",r),this.setAttr("shadowBlur",a*Math.min(Math.abs(c),Math.abs(l))),this.setAttr("shadowOffsetX",o.x*c),this.setAttr("shadowOffsetY",o.y*l)}}class yt extends pt{_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){var e=t.getStrokeScaleEnabled();if(!e){this.save();var i=this.getCanvas().getPixelRatio();this.setTransform(i,0,0,i,0,0)}this._applyLineCap(t);var n=t.hitStrokeWidth(),r="auto"===n?t.strokeWidth():n;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}}var vt;function xt(){if(vt)return vt;var t=j.createCanvasElement(),e=t.getContext("2d");return vt=function(){var t=P["a"]._global.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/i}(),vt}class mt{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=t||{},i=e.pixelRatio||P["a"].pixelRatio||xt();this.pixelRatio=i,this._canvas=j.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio,i=this.getContext()._context;i.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch(i){try{return this._canvas.toDataURL()}catch(n){return j.error("Unable to get data URL. "+n.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}et.addGetterSetter(mt,"pixelRatio",void 0,U());class bt extends mt{constructor(t={width:0,height:0}){super(t),this.context=new gt(this),this.setSize(t.width,t.height)}}class wt extends mt{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new yt(this),this.setSize(t.width,t.height)}}const _t={get isDragging(){var t=!1;return _t._dragElements.forEach(e=>{"dragging"===e.dragStatus&&(t=!0)}),t},justDragged:!1,get node(){var t;return _t._dragElements.forEach(e=>{t=e.node}),t},_dragElements:new Map,_drag(t){const e=[];_t._dragElements.forEach((i,n)=>{const{node:r}=i,a=r.getStage();a.setPointersPositions(t),void 0===i.pointerId&&(i.pointerId=j._getFirstPointerId(t));const o=a._changedPointerPositions.find(t=>t.id===i.pointerId);if(o){if("dragging"!==i.dragStatus){var s=r.dragDistance(),h=Math.max(Math.abs(o.x-i.startPointerPos.x),Math.abs(o.y-i.startPointerPos.y));if(h<s)return;if(r.startDrag({evt:t}),!r.isDragging())return}r._setDragPosition(t,i),e.push(r)}}),e.forEach(e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:t},!0)})},_endDragBefore(t){_t._dragElements.forEach(e=>{const{node:i}=e,n=i.getStage();t&&n.setPointersPositions(t);const r=n._changedPointerPositions.find(t=>t.id===e.pointerId);if(!r)return;"dragging"!==e.dragStatus&&"stopped"!==e.dragStatus||(_t.justDragged=!0,P["a"]._mouseListenClick=!1,P["a"]._touchListenClick=!1,P["a"]._pointerListenClick=!1,e.dragStatus="stopped");const a=e.node.getLayer()||e.node instanceof P["a"]["Stage"]&&e.node;a&&a.batchDraw()})},_endDragAfter(t){_t._dragElements.forEach((e,i)=>{"stopped"===e.dragStatus&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:t},!0),"dragging"!==e.dragStatus&&_t._dragElements.delete(i)})}};P["a"].isBrowser&&(window.addEventListener("mouseup",_t._endDragBefore,!0),window.addEventListener("touchend",_t._endDragBefore,!0),window.addEventListener("mousemove",_t._drag),window.addEventListener("touchmove",_t._drag),window.addEventListener("mouseup",_t._endDragAfter,!1),window.addEventListener("touchend",_t._endDragAfter,!1));var St="absoluteOpacity",Pt="allEventListeners",At="absoluteTransform",Ct="absoluteScale",Rt="canvas",Lt="Change",kt="children",Tt="konva",Mt="listening",Et="mouseenter",Ot="mouseleave",Dt="set",It="Shape",Wt=" ",Gt="stage",Ft="transform",Bt="Stage",Ht="visible",Nt=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Wt);let jt=1;class zt{constructor(t){this._id=jt++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){t!==Ft&&t!==At||!this._cache.get(t)?t?this._cache.delete(t):this._cache.clear():this._cache.get(t).dirty=!0}_getCache(t,e){var i=this._cache.get(t),n=t===Ft||t===At,r=void 0===i||n&&!0===i.dirty;return r&&(i=e.call(this),this._cache.set(t,i)),i}_calculate(t,e,i){if(!this._attachedDepsListeners.get(t)){const i=e.map(t=>t+"Change.konva").join(Wt);this.on(i,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(Rt)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===At&&this.fire("absoluteTransformChange")}clearCache(){return this._cache.delete(Rt),this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){var e=t||{},i={};void 0!==e.x&&void 0!==e.y&&void 0!==e.width&&void 0!==e.height||(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var n=Math.ceil(e.width||i.width),r=Math.ceil(e.height||i.height),a=e.pixelRatio,o=void 0===e.x?Math.floor(i.x):e.x,s=void 0===e.y?Math.floor(i.y):e.y,h=e.offset||0,c=e.drawBorder||!1,l=e.hitCanvasPixelRatio||1;if(n&&r){n+=2*h+1,r+=2*h+1,o-=h,s-=h;var d=new bt({pixelRatio:a,width:n,height:r}),u=new bt({pixelRatio:a,width:0,height:0}),f=new wt({pixelRatio:l,width:n,height:r}),p=d.getContext(),g=f.getContext();return f.isCache=!0,d.isCache=!0,this._cache.delete(Rt),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(d.getContext()._context.imageSmoothingEnabled=!1,u.getContext()._context.imageSmoothingEnabled=!1),p.save(),g.save(),p.translate(-o,-s),g.translate(-o,-s),this._isUnderCache=!0,this._clearSelfAndDescendantCache(St),this._clearSelfAndDescendantCache(Ct),this.drawScene(d,this),this.drawHit(f,this),this._isUnderCache=!1,p.restore(),g.restore(),c&&(p.save(),p.beginPath(),p.rect(0,0,n,r),p.closePath(),p.setAttr("strokeStyle","red"),p.setAttr("lineWidth",5),p.stroke(),p.restore()),this._cache.set(Rt,{scene:d,filter:u,hit:f,x:o,y:s}),this._requestDraw(),this}j.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")}isCached(){return this._cache.has(Rt)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){var i,n,r,a,o=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],s=this.getAbsoluteTransform(e);return o.forEach((function(t){var e=s.point(t);void 0===i&&(i=r=e.x,n=a=e.y),i=Math.min(i,e.x),n=Math.min(n,e.y),r=Math.max(r,e.x),a=Math.max(a,e.y)})),{x:i,y:n,width:r-i,height:a-n}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);var i=this._getCachedSceneCanvas(),n=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/n,i.height/n),t.restore()}_drawCachedHitCanvas(t){var e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){var t,e,i,n,r=this.filters(),a=this._getCanvasCache(),o=a.scene,s=a.filter,h=s.getContext();if(r){if(!this._filterUpToDate){var c=o.pixelRatio;s.setSize(o.width/o.pixelRatio,o.height/o.pixelRatio);try{for(t=r.length,h.clear(),h.drawImage(o._canvas,0,0,o.getWidth()/c,o.getHeight()/c),e=h.getImageData(0,0,s.getWidth(),s.getHeight()),i=0;i<t;i++)n=r[i],"function"===typeof n?(n.call(this,e),h.putImageData(e,0,0)):j.error("Filter should be type of function, but got "+typeof n+" instead. Please check correct filters")}catch(l){j.error("Unable to apply filter. "+l.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return s}return o}on(t,e){if(this._cache&&this._cache.delete(Pt),3===arguments.length)return this._delegate.apply(this,arguments);var i,n,r,a,o,s=t.split(Wt),h=s.length;for(i=0;i<h;i++)n=s[i],r=n.split("."),a=r[0],o=r[1]||"",this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:o,handler:e});return this}off(t,e){var i,n,r,a,o,s,h=(t||"").split(Wt),c=h.length;if(this._cache&&this._cache.delete(Pt),!t)for(n in this.eventListeners)this._off(n);for(i=0;i<c;i++)if(r=h[i],a=r.split("."),o=a[0],s=a[1],o)this.eventListeners[o]&&this._off(o,s,e);else for(n in this.eventListeners)this._off(n,s,e);return this}dispatchEvent(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,(function(t){e.call(this,t.evt)})),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,i){var n=this;this.on(t,(function(t){for(var r=t.target.findAncestors(e,!0,n),a=0;a<r.length;a++)t=j.cloneObject(t),t.currentTarget=r[a],i.call(r[a],t)}))}remove(){return this.isDragging()&&this.stopDrag(),_t._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(At),this._clearSelfAndDescendantCache(St),this._clearSelfAndDescendantCache(Ct),this._clearSelfAndDescendantCache(Gt),this._clearSelfAndDescendantCache(Ht),this._clearSelfAndDescendantCache(Mt)}_remove(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this}getAttr(t){var e="get"+j._capitalize(t);return j._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){var t=this.getParent(),e=[];while(t)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{var e,i;if(!t)return this;for(e in t)e!==kt&&(i=Dt+j._capitalize(e),j._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(Mt,this._isListening)}_isListening(t){const e=this.listening();if(!e)return!1;const i=this.getParent();return!i||i===t||this===t||i._isListening(t)}isVisible(){return this._getCache(Ht,this._isVisible)}_isVisible(t){const e=this.visible();if(!e)return!1;const i=this.getParent();return!i||i===t||this===t||i._isVisible(t)}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);var i=this.getLayer(),n=!1;_t._dragElements.forEach(t=>{"dragging"===t.dragStatus&&("Stage"===t.node.nodeType||t.node.getLayer()===i)&&(n=!0)});var r=!e&&!P["a"].hitOnDragEnabled&&n;return this.isListening()&&this.isVisible()&&!r}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var t,e,i,n,r=this.getDepth(),a=this,o=0;function s(h){for(t=[],e=h.length,i=0;i<e;i++)n=h[i],o++,n.nodeType!==It&&(t=t.concat(n.getChildren().slice())),n._id===a._id&&(i=e);t.length>0&&t[0].getDepth()<=r&&s(t)}return a.nodeType!==Bt&&s(a.getStage().getChildren()),o}getDepth(){var t=0,e=this.parent;while(e)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Ft),this._clearSelfAndDescendantCache(At)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){if(!this.getStage())return null;var t=this.getStage().getPointerPosition();if(!t)return null;var e=this.getAbsoluteTransform().copy();return e.invert(),e.point(t)}getAbsolutePosition(t){let e=!1,i=this.parent;while(i){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);var n=this.getAbsoluteTransform(t).getMatrix(),r=new A,a=this.offset();return r.m=n.slice(),r.translate(a.x,a.y),r.getTranslation()}setAbsolutePosition(t){var e=this._clearTransform();this.attrs.x=e.x,this.attrs.y=e.y,delete e.x,delete e.y,this._clearCache(Ft);var i=this._getAbsoluteTransform().copy();return i.invert(),i.translate(t.x,t.y),t={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this._setTransform(e),this.setPosition({x:t.x,y:t.y}),this._clearCache(Ft),this._clearSelfAndDescendantCache(At),this}_setTransform(t){var e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){var e=t.x,i=t.y,n=this.x(),r=this.y();return void 0!==e&&(n+=e),void 0!==i&&(r+=i),this.setPosition({x:n,y:r}),this}_eachAncestorReverse(t,e){var i,n,r=[],a=this.getParent();if(!e||e._id!==this._id){r.unshift(this);while(a&&(!e||a._id!==e._id))r.unshift(a),a=a.parent;for(i=r.length,n=0;n<i;n++)t(r[n])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return j.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1&&(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0)}moveUp(){if(!this.parent)return j.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)}moveDown(){if(!this.parent)return j.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)}moveToBottom(){if(!this.parent)return j.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)}setZIndex(t){if(!this.parent)return j.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&j.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(St,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){var t,e,i,n,r,a={},o=this.getAttrs();for(t in a.attrs={},o)e=o[t],r=j.isObject(e)&&!j._isPlainObject(e)&&!j._isArray(e),r||(i="function"===typeof this[t]&&this[t],delete o[t],n=i?i.call(this):null,o[t]=e,n!==e&&(a.attrs[t]=e));return a.className=this.getClassName(),j._prepareToStringify(a)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,i){var n=[];e&&this._isMatch(t)&&n.push(this);var r=this.parent;while(r){if(r===i)return n;r._isMatch(t)&&n.push(r),r=r.parent}return n}isAncestorOf(t){return!1}findAncestor(t,e,i){return this.findAncestors(t,e,i)[0]}_isMatch(t){if(!t)return!1;if("function"===typeof t)return t(this);var e,i,n=t.replace(/ /g,"").split(","),r=n.length;for(e=0;e<r;e++)if(i=n[e],j.isValidSelector(i)||(j.warn('Selector "'+i+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),j.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),j.warn("Konva is awesome, right?")),"#"===i.charAt(0)){if(this.id()===i.slice(1))return!0}else if("."===i.charAt(0)){if(this.hasName(i.slice(1)))return!0}else if(this.className===i||this.nodeType===i)return!0;return!1}getLayer(){var t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(Gt,this._getStage)}_getStage(){var t=this.getParent();return t?t.getStage():void 0}fire(t,e={},i){return e.target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(At,this._getAbsoluteTransform)}_getAbsoluteTransform(t){var e;if(t)return e=new A,this._eachAncestorReverse((function(t){var i=t.transformsEnabled();"all"===i?e.multiply(t.getTransform()):"position"===i&&e.translate(t.x()-t.offsetX(),t.y()-t.offsetY())}),t),e;e=this._cache.get(At)||new A,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();var i=this.transformsEnabled();if("all"===i)e.multiply(this.getTransform());else if("position"===i){const t=this.attrs.x||0,i=this.attrs.y||0,n=this.attrs.offsetX||0,r=this.attrs.offsetY||0;e.translate(t-n,i-r)}return e.dirty=!1,e}getAbsoluteScale(t){var e=this;while(e)e._isUnderCache&&(t=e),e=e.getParent();const i=this.getAbsoluteTransform(t),n=i.decompose();return{x:n.scaleX,y:n.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Ft,this._getTransform)}_getTransform(){var t,e,i=this._cache.get(Ft)||new A;i.reset();var n=this.x(),r=this.y(),a=P["a"].getAngle(this.rotation()),o=null!==(t=this.attrs.scaleX)&&void 0!==t?t:1,s=null!==(e=this.attrs.scaleY)&&void 0!==e?e:1,h=this.attrs.skewX||0,c=this.attrs.skewY||0,l=this.attrs.offsetX||0,d=this.attrs.offsetY||0;return 0===n&&0===r||i.translate(n,r),0!==a&&i.rotate(a),0===h&&0===c||i.skew(h,c),1===o&&1===s||i.scale(o,s),0===l&&0===d||i.translate(-1*l,-1*d),i.dirty=!1,i}clone(t){var e,i,n,r,a,o=j.cloneObject(this.attrs);for(e in t)o[e]=t[e];var s=new this.constructor(o);for(e in this.eventListeners)for(i=this.eventListeners[e],n=i.length,r=0;r<n;r++)a=i[r],a.name.indexOf(Tt)<0&&(s.eventListeners[e]||(s.eventListeners[e]=[]),s.eventListeners[e].push(a));return s}_toKonvaCanvas(t){t=t||{};var e=this.getClientRect(),i=this.getStage(),n=void 0!==t.x?t.x:Math.floor(e.x),r=void 0!==t.y?t.y:Math.floor(e.y),a=t.pixelRatio||1,o=new bt({width:t.width||Math.ceil(e.width)||(i?i.width():0),height:t.height||Math.ceil(e.height)||(i?i.height():0),pixelRatio:a}),s=o.getContext();return!1===t.imageSmoothingEnabled&&(s._context.imageSmoothingEnabled=!1),s.save(),(n||r)&&s.translate(-1*n,-1*r),this.drawScene(o),s.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};var e=t.mimeType||null,i=t.quality||null,n=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(n),n}toImage(t){if(!t||!t.callback)throw"callback required for toImage method config argument";var e=t.callback;delete t.callback,j._urlToImage(this.toDataURL(t),(function(t){e(t)}))}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():P["a"].dragDistance}_off(t,e,i){var n,r,a,o=this.eventListeners[t];for(n=0;n<o.length;n++)if(r=o[n].name,a=o[n].handler,("konva"!==r||"konva"===e)&&(!e||r===e)&&(!i||i===a)){if(o.splice(n,1),0===o.length){delete this.eventListeners[t];break}n--}}_fireChangeEvent(t,e,i){this._fire(t+Lt,{oldVal:e,newVal:i})}addName(t){if(!this.hasName(t)){var e=this.name(),i=e?e+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const e=this.name();if(!e)return!1;var i=(e||"").split(/\s/g);return-1!==i.indexOf(t)}removeName(t){var e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return-1!==i&&(e.splice(i,1),this.name(e.join(" "))),this}setAttr(t,e){var i=this[Dt+j._capitalize(t)];return j._isFunction(i)?i.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(P["a"].autoDrawEnabled){const t=this.getLayer()||this.getStage();null===t||void 0===t||t.batchDraw()}}_setAttr(t,e){var i=this.attrs[t];(i!==e||j.isObject(e))&&(void 0===e||null===e?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,e),this._requestDraw())}_setComponentAttr(t,e,i){var n;void 0!==i&&(n=this.attrs[t],n||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,n,i))}_fireAndBubble(t,e,i){e&&this.nodeType===It&&(e.target=this);var n=(t===Et||t===Ot)&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||"Stage"===this.nodeType&&!i);if(!n){this._fire(t,e);var r=(t===Et||t===Ot)&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!r&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){let e=this._cache.get(Pt);if(!e){e={};let t=Object.getPrototypeOf(this);while(t)if(t.eventListeners){for(var i in t.eventListeners){const n=t.eventListeners[i],r=e[i]||[];e[i]=n.concat(r)}t=Object.getPrototypeOf(t)}else t=Object.getPrototypeOf(t);this._cache.set(Pt,e)}return e[t]}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const i=this._getProtoListeners(t);if(i)for(var n=0;n<i.length;n++)i[n].handler.call(this,e);const r=this.eventListeners[t];if(r)for(n=0;n<r.length;n++)r[n].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){var e=t?t.pointerId:void 0,i=this.getStage(),n=this.getAbsolutePosition(),r=i._getPointerById(e)||i._changedPointerPositions[0]||n;_t._dragElements.set(this._id,{node:this,startPointerPos:r,offset:{x:r.x-n.x,y:r.y-n.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){_t._dragElements.has(this._id)||this._createDragElement(t);const i=_t._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const i=this.getStage()._getPointerById(e.pointerId);if(i){var n={x:i.x-e.offset.x,y:i.y-e.offset.y},r=this.dragBoundFunc();if(void 0!==r){const e=r.call(this,n,t);e?n=e:j.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===n.x&&this._lastPos.y===n.y||(this.setAbsolutePosition(n),this._requestDraw()),this._lastPos=n}}stopDrag(t){const e=_t._dragElements.get(this._id);e&&(e.dragStatus="stopped"),_t._endDragBefore(t),_t._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=_t._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(t){var e=void 0!==t.evt["button"],i=!e||P["a"].dragButtons.indexOf(t.evt["button"])>=0;if(i&&!this.isDragging()){var n=!1;_t._dragElements.forEach(t=>{this.isAncestorOf(t.node)&&(n=!0)}),n||this._createDragElement(t)}}))}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var t=this.getStage();if(!t)return;const e=_t._dragElements.get(this._id),i=e&&"dragging"===e.dragStatus,n=e&&"ready"===e.dragStatus;i?this.stopDrag():n&&_t._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const i={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return j.haveIntersection(i,this.getClientRect())}static create(t,e){return j._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){var i,n,r,a=zt.prototype.getClassName.call(t),o=t.children;e&&(t.attrs.container=e),P["a"][a]||(j.warn('Can not find a node with class name "'+a+'". Fallback to "Shape".'),a="Shape");const s=P["a"][a];if(i=new s(t.attrs),o)for(n=o.length,r=0;r<n;r++)i.add(zt._createNode(o[r]));return i}}zt.prototype.nodeType="Node",zt.prototype._attrsAffectingSize=[],zt.prototype.eventListeners={},zt.prototype.on.call(zt.prototype,Nt,(function(){this._batchingTransformChange?this._needClearTransformCache=!0:(this._clearCache(Ft),this._clearSelfAndDescendantCache(At))})),zt.prototype.on.call(zt.prototype,"visibleChange.konva",(function(){this._clearSelfAndDescendantCache(Ht)})),zt.prototype.on.call(zt.prototype,"listeningChange.konva",(function(){this._clearSelfAndDescendantCache(Mt)})),zt.prototype.on.call(zt.prototype,"opacityChange.konva",(function(){this._clearSelfAndDescendantCache(St)}));const Yt=et.addGetterSetter;Yt(zt,"zIndex"),Yt(zt,"absolutePosition"),Yt(zt,"position"),Yt(zt,"x",0,U()),Yt(zt,"y",0,U()),Yt(zt,"globalCompositeOperation","source-over",V()),Yt(zt,"opacity",1,U()),Yt(zt,"name","",V()),Yt(zt,"id","",V()),Yt(zt,"rotation",0,U()),et.addComponentsGetterSetter(zt,"scale",["x","y"]),Yt(zt,"scaleX",1,U()),Yt(zt,"scaleY",1,U()),et.addComponentsGetterSetter(zt,"skew",["x","y"]),Yt(zt,"skewX",0,U()),Yt(zt,"skewY",0,U()),et.addComponentsGetterSetter(zt,"offset",["x","y"]),Yt(zt,"offsetX",0,U()),Yt(zt,"offsetY",0,U()),Yt(zt,"dragDistance",null,U()),Yt(zt,"width",0,U()),Yt(zt,"height",0,U()),Yt(zt,"listening",!0,J()),Yt(zt,"preventDefault",!0,J()),Yt(zt,"filters",null,(function(t){return this._filterUpToDate=!1,t})),Yt(zt,"visible",!0,J()),Yt(zt,"transformsEnabled","all",V()),Yt(zt,"size"),Yt(zt,"dragBoundFunc"),Yt(zt,"draggable",!1,J()),et.backCompat(zt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class Ut extends zt{constructor(){super(...arguments),this.children=[]}getChildren(t){if(!t)return this.children||[];const e=this.children||[];var i=[];return e.forEach((function(e){t(e)&&i.push(e)})),i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}var i=t[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){var i=[];return this._descendants(n=>{const r=n._isMatch(t);return r&&i.push(n),!(!r||!e)}),i}_descendants(t){let e=!1;const i=this.getChildren();for(const n of i){if(e=t(n),e)return!0;if(n.hasChildren()&&(e=n._descendants(t),e))return!0}return!1}toObject(){var t=zt.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){var e=t.getParent();while(e){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){var e=zt.prototype.clone.call(this,t);return this.getChildren().forEach((function(t){e.add(t.clone())})),e}getAllIntersections(t){var e=[];return this.find("Shape").forEach((function(i){i.isVisible()&&i.intersects(t)&&e.push(i)})),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),this.isCached()||null===(e=this.children)||void 0===e||e.forEach((function(e){e._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;null===(t=this.children)||void 0===t||t.forEach((function(t,e){t.index=e})),this._requestDraw()}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas(),r=n&&n.getContext(),a=this._getCanvasCache(),o=a&&a.scene,s=n&&n.isCache;if(!this.isVisible()&&!s)return this;if(o){r.save();var h=this.getAbsoluteTransform(e).getMatrix();r.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(r),r.restore()}else this._drawChildren("drawScene",n,e);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;var i=this.getLayer(),n=t||i&&i.hitCanvas,r=n&&n.getContext(),a=this._getCanvasCache(),o=a&&a.hit;if(o){r.save();var s=this.getAbsoluteTransform(e).getMatrix();r.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._drawCachedHitCanvas(r),r.restore()}else this._drawChildren("drawHit",n,e);return this}_drawChildren(t,e,i){var n,r=e&&e.getContext(),a=this.clipWidth(),o=this.clipHeight(),s=this.clipFunc(),h=a&&o||s;const c=i===this;if(h){r.save();var l=this.getAbsoluteTransform(i),d=l.getMatrix();if(r.transform(d[0],d[1],d[2],d[3],d[4],d[5]),r.beginPath(),s)s.call(this,r,this);else{var u=this.clipX(),f=this.clipY();r.rect(u,f,a,o)}r.clip(),d=l.copy().invert().getMatrix(),r.transform(d[0],d[1],d[2],d[3],d[4],d[5])}var p=!c&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===t;p&&(r.save(),r._applyGlobalCompositeOperation(this)),null===(n=this.children)||void 0===n||n.forEach((function(n){n[t](e,i)})),p&&r.restore(),h&&r.restore()}getClientRect(t){var e;t=t||{};var i,n,r,a,o=t.skipTransform,s=t.relativeTo,h={x:1/0,y:1/0,width:0,height:0},c=this;null===(e=this.children)||void 0===e||e.forEach((function(e){if(e.visible()){var o=e.getClientRect({relativeTo:c,skipShadow:t.skipShadow,skipStroke:t.skipStroke});0===o.width&&0===o.height||(void 0===i?(i=o.x,n=o.y,r=o.x+o.width,a=o.y+o.height):(i=Math.min(i,o.x),n=Math.min(n,o.y),r=Math.max(r,o.x+o.width),a=Math.max(a,o.y+o.height)))}}));for(var l=this.find("Shape"),d=!1,u=0;u<l.length;u++){var f=l[u];if(f._isVisible(this)){d=!0;break}}return h=d&&void 0!==i?{x:i,y:n,width:r-i,height:a-n}:{x:0,y:0,width:0,height:0},o?h:this._transformedRect(h,s)}}et.addComponentsGetterSetter(Ut,"clip",["x","y","width","height"]),et.addGetterSetter(Ut,"clipX",void 0,U()),et.addGetterSetter(Ut,"clipY",void 0,U()),et.addGetterSetter(Ut,"clipWidth",void 0,U()),et.addGetterSetter(Ut,"clipHeight",void 0,U()),et.addGetterSetter(Ut,"clipFunc");const Xt=new Map,qt=void 0!==P["a"]._global["PointerEvent"];function Vt(t){return Xt.get(t)}function Qt(t){return{evt:t,pointerId:t.pointerId}}function Kt(t,e){return Xt.get(t)===e}function Jt(t,e){Zt(t);const i=e.getStage();i&&(Xt.set(t,e),qt&&e._fire("gotpointercapture",Qt(new PointerEvent("gotpointercapture"))))}function Zt(t,e){const i=Xt.get(t);if(!i)return;const n=i.getStage();n&&n.content,Xt.delete(t),qt&&i._fire("lostpointercapture",Qt(new PointerEvent("lostpointercapture")))}var $t="Stage",te="string",ee="px",ie="mouseout",ne="mouseleave",re="mouseover",ae="mouseenter",oe="mousemove",se="mousedown",he="mouseup",ce="pointermove",le="pointerdown",de="pointerup",ue="pointercancel",fe="lostpointercapture",pe="pointerout",ge="pointerleave",ye="pointerover",ve="pointerenter",xe="contextmenu",me="touchstart",be="touchend",we="touchmove",_e="touchcancel",Se="wheel",Pe=5,Ae=[[ae,"_pointerenter"],[se,"_pointerdown"],[oe,"_pointermove"],[he,"_pointerup"],[ne,"_pointerleave"],[me,"_pointerdown"],[we,"_pointermove"],[be,"_pointerup"],[_e,"_pointercancel"],[re,"_pointerover"],[Se,"_wheel"],[xe,"_contextmenu"],[le,"_pointerdown"],[ce,"_pointermove"],[de,"_pointerup"],[ue,"_pointercancel"],[fe,"_lostpointercapture"]];const Ce={mouse:{[pe]:ie,[ge]:ne,[ye]:re,[ve]:ae,[ce]:oe,[le]:se,[de]:he,[ue]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[pe]:"touchout",[ge]:"touchleave",[ye]:"touchover",[ve]:"touchenter",[ce]:we,[le]:me,[de]:be,[ue]:_e,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[pe]:pe,[ge]:ge,[ye]:ye,[ve]:ve,[ce]:ce,[le]:le,[de]:de,[ue]:ue,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Re=t=>t.indexOf("pointer")>=0?"pointer":t.indexOf("touch")>=0?"touch":"mouse",Le=t=>{const e=Re(t);return"pointer"===e?P["a"].pointerEventsEnabled&&Ce.pointer:"touch"===e?Ce.touch:"mouse"===e?Ce.mouse:void 0};function ke(t={}){return(t.clipFunc||t.clipWidth||t.clipHeight)&&j.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}const Te="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",Me=[];class Ee extends Ut{constructor(t){super(ke(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Me.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ke(this.attrs)}),this._checkVisibility()}_validateAdd(t){const e="Layer"===t.getType(),i="FastLayer"===t.getType(),n=e||i;n||j.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===te){if("."===t.charAt(0)){var e=t.slice(1);t=document.getElementsByClassName(e)[0]}else{var i;i="#"!==t.charAt(0)?t:t.slice(1),t=document.getElementById(i)}if(!t)throw"Can not find container in document with id "+i}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var t,e=this.children,i=e.length;for(t=0;t<i;t++)e[t].clear();return this}clone(t){return t||(t={}),t.container="undefined"!==typeof document&&document.createElement("div"),Ut.prototype.clone.call(this,t)}destroy(){super.destroy();var t=this.content;t&&j._isInDocument(t)&&this.container().removeChild(t);var e=Me.indexOf(this);return e>-1&&Me.splice(e,1),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(j.warn(Te),null)}_getPointerById(t){return this._pointerPositions.find(e=>e.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t=t||{},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();var e=new bt({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=e.getContext()._context,n=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),n.forEach((function(e){if(e.isVisible()){var n=e._toKonvaCanvas(t);i.drawImage(n._canvas,t.x,t.y,n.getWidth()/n.getPixelRatio(),n.getHeight()/n.getPixelRatio())}})),e}getIntersection(t){if(!t)return null;var e,i=this.children,n=i.length,r=n-1;for(e=r;e>=0;e--){const n=i[e].getIntersection(t);if(n)return n}return null}_resizeDOM(){var t=this.width(),e=this.height();this.content&&(this.content.style.width=t+ee,this.content.style.height=e+ee),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach(i=>{i.setSize({width:t,height:e}),i.draw()})}add(t,...e){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}super.add(t);var n=this.children.length;return n>Pe&&j.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),P["a"].isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Kt(t,this)}setPointerCapture(t){Jt(t,this)}releaseCapture(t){Zt(t,this)}getLayers(){return this.children}_bindContentEvents(){P["a"].isBrowser&&Ae.forEach(([t,e])=>{this.content.addEventListener(t,t=>{this[e](t)})})}_pointerenter(t){this.setPointersPositions(t);const e=Le(t.type);this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=Le(t.type);this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=Le(t.type),i=Re(t.type);if(e){this.setPointersPositions(t);var n=this._getTargetShape(i),r=!_t.isDragging||P["a"].hitOnDragEnabled;n&&r?(n._fireAndBubble(e.pointerout,{evt:t}),n._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):r&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[]}}_pointerdown(t){const e=Le(t.type),i=Re(t.type);if(e){this.setPointersPositions(t);var n=!1;this._changedPointerPositions.forEach(r=>{var a=this.getIntersection(r);_t.justDragged=!1,P["a"]["_"+i+"ListenClick"]=!0;const o=a&&a.isListening();if(!o)return;P["a"].capturePointerEventsEnabled&&a.setPointerCapture(r.id),this[i+"ClickStartShape"]=a,a._fireAndBubble(e.pointerdown,{evt:t,pointerId:r.id}),n=!0;const s=t.type.indexOf("touch")>=0;a.preventDefault()&&t.cancelable&&s&&t.preventDefault()}),n||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(t){const e=Le(t.type),i=Re(t.type);if(!e)return;_t.isDragging&&_t.node.preventDefault()&&t.cancelable&&t.preventDefault(),this.setPointersPositions(t);var n=!_t.isDragging||P["a"].hitOnDragEnabled;if(!n)return;var r={};let a=!1;var o=this._getTargetShape(i);this._changedPointerPositions.forEach(n=>{const s=Vt(n.id)||this.getIntersection(n),h=n.id,c={evt:t,pointerId:h};var l=o!==s;if(l&&o&&(o._fireAndBubble(e.pointerout,Object.assign({},c),s),o._fireAndBubble(e.pointerleave,Object.assign({},c),s)),s){if(r[s._id])return;r[s._id]=!0}s&&s.isListening()?(a=!0,l&&(s._fireAndBubble(e.pointerover,Object.assign({},c),o),s._fireAndBubble(e.pointerenter,Object.assign({},c),o),this[i+"targetShape"]=s),s._fireAndBubble(e.pointermove,Object.assign({},c))):o&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:h}),this[i+"targetShape"]=null)}),a||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=Le(t.type),i=Re(t.type);if(!e)return;this.setPointersPositions(t);const n=this[i+"ClickStartShape"],r=this[i+"ClickEndShape"];var a={};let o=!1;this._changedPointerPositions.forEach(s=>{const h=Vt(s.id)||this.getIntersection(s);if(h){if(h.releaseCapture(s.id),a[h._id])return;a[h._id]=!0}const c=s.id,l={evt:t,pointerId:c};let d=!1;P["a"]["_"+i+"InDblClickWindow"]?(d=!0,clearTimeout(this[i+"DblTimeout"])):_t.justDragged||(P["a"]["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout((function(){P["a"]["_"+i+"InDblClickWindow"]=!1}),P["a"].dblClickWindow),h&&h.isListening()?(o=!0,this[i+"ClickEndShape"]=h,h._fireAndBubble(e.pointerup,Object.assign({},l)),P["a"]["_"+i+"ListenClick"]&&n&&n===h&&(h._fireAndBubble(e.pointerclick,Object.assign({},l)),d&&r&&r===h&&h._fireAndBubble(e.pointerdblclick,Object.assign({},l)))):(this[i+"ClickEndShape"]=null,P["a"]["_"+i+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:c}),d&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:c}))}),o||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),P["a"]["_"+i+"ListenClick"]=!1,t.cancelable&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(xe,{evt:t}):this._fire(xe,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(Se,{evt:t}):this._fire(Se,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=Vt(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(de,Qt(t)),Zt(t.pointerId)}_lostpointercapture(t){Zt(t.pointerId)}setPointersPositions(t){var e=this._getContentPosition(),i=null,n=null;t=t||window.event,void 0!==t.touches?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,t=>{this._pointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,t=>{this._changedPointerPositions.push({id:t.identifier,x:(t.clientX-e.left)/e.scaleX,y:(t.clientY-e.top)/e.scaleY})})):(i=(t.clientX-e.left)/e.scaleX,n=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:i,y:n},this._pointerPositions=[{x:i,y:n,id:j._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:n,id:j._getFirstPointerId(t)}])}_setPointerPosition(t){j.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new bt({width:this.width(),height:this.height()}),this.bufferHitCanvas=new wt({pixelRatio:1,width:this.width(),height:this.height()}),P["a"].isBrowser){var t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}}cache(){return j.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach((function(t){t.batchDraw()})),this}}Ee.prototype.nodeType=$t,Object(P["b"])(Ee),et.addGetterSetter(Ee,"container");var Oe="hasShadow",De="shadowRGBA",Ie="patternImage",We="linearGradient",Ge="radialGradient";let Fe;function Be(){return Fe||(Fe=j.createCanvasElement().getContext("2d"),Fe)}const He={};function Ne(t){t.fill()}function je(t){t.stroke()}function ze(t){t.fill()}function Ye(t){t.stroke()}function Ue(){this._clearCache(Oe)}function Xe(){this._clearCache(De)}function qe(){this._clearCache(Ie)}function Ve(){this._clearCache(We)}function Qe(){this._clearCache(Ge)}class Ke extends zt{constructor(t){let e;super(t);while(1)if(e=j.getRandomColor(),e&&!(e in He))break;this.colorKey=e,He[e]=this}getContext(){return j.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return j.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this["_sceneFunc"]}getHitFunc(){return this.attrs.hitFunc||this["_hitFunc"]}hasShadow(){return this._getCache(Oe,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Ie,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var t=Be();const e=t.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){const t=new A;t.translate(this.fillPatternX(),this.fillPatternY()),t.rotate(P["a"].getAngle(this.fillPatternRotation())),t.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),t.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const i=t.getMatrix(),n="undefined"===typeof DOMMatrix?{a:i[0],b:i[1],c:i[2],d:i[3],e:i[4],f:i[5]}:new DOMMatrix(i);e.setTransform(n)}return e}}_getLinearGradient(){return this._getCache(We,this.__getLinearGradient)}__getLinearGradient(){var t=this.fillLinearGradientColorStops();if(t){for(var e=Be(),i=this.fillLinearGradientStartPoint(),n=this.fillLinearGradientEndPoint(),r=e.createLinearGradient(i.x,i.y,n.x,n.y),a=0;a<t.length;a+=2)r.addColorStop(t[a],t[a+1]);return r}}_getRadialGradient(){return this._getCache(Ge,this.__getRadialGradient)}__getRadialGradient(){var t=this.fillRadialGradientColorStops();if(t){for(var e=Be(),i=this.fillRadialGradientStartPoint(),n=this.fillRadialGradientEndPoint(),r=e.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),n.x,n.y,this.fillRadialGradientEndRadius()),a=0;a<t.length;a+=2)r.addColorStop(t[a],t[a+1]);return r}}getShadowRGBA(){return this._getCache(De,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var t=j.colorToRGBA(this.shadowColor());return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!(!this.stroke()&&!this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return"auto"===t?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){var e,i=this.getStage(),n=i.bufferHitCanvas;return n.getContext().clear(),this.drawHit(n,null,!0),e=n.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data,e[3]>0}destroy(){return zt.prototype.destroy.call(this),delete He[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!this.getStage())return!1;const i=null===(e=this.attrs.perfectDrawEnabled)||void 0===e||e;if(!i)return!1;const n=t||this.hasFill(),r=this.hasStroke(),a=1!==this.getAbsoluteOpacity();if(n&&r&&a)return!0;const o=this.hasShadow(),s=this.shadowForStrokeEnabled();return!!(n&&r&&o&&s)}setStrokeHitEnabled(t){j.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return 0!==this.hitStrokeWidth()}getSelfRect(){var t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){const e=t.skipTransform,i=t.relativeTo,n=this.getSelfRect(),r=!t.skipStroke&&this.hasStroke(),a=r&&this.strokeWidth()||0,o=n.width+a,s=n.height+a,h=!t.skipShadow&&this.hasShadow(),c=h?this.shadowOffsetX():0,l=h?this.shadowOffsetY():0,d=o+Math.abs(c),u=s+Math.abs(l),f=h&&this.shadowBlur()||0,p=d+2*f,g=u+2*f,y={width:p,height:g,x:-(a/2+f)+Math.min(c,0)+n.x,y:-(a/2+f)+Math.min(l,0)+n.y};return e?y:this._transformedRect(y,i)}drawScene(t,e){var i,n,r,a=this.getLayer(),o=t||a.getCanvas(),s=o.getContext(),h=this._getCanvasCache(),c=this.getSceneFunc(),l=this.hasShadow(),d=o.isCache,u=e===this;if(!this.isVisible()&&!u)return this;if(h){s.save();var f=this.getAbsoluteTransform(e).getMatrix();return s.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(s),s.restore(),this}if(!c)return this;if(s.save(),this._useBufferCanvas()&&!d){i=this.getStage(),n=i.bufferCanvas,r=n.getContext(),r.clear(),r.save(),r._applyLineJoin(this);var p=this.getAbsoluteTransform(e).getMatrix();r.transform(p[0],p[1],p[2],p[3],p[4],p[5]),c.call(this,r,this),r.restore();var g=n.pixelRatio;l&&s._applyShadow(this),s._applyOpacity(this),s._applyGlobalCompositeOperation(this),s.drawImage(n._canvas,0,0,n.width/g,n.height/g)}else{if(s._applyLineJoin(this),!u){p=this.getAbsoluteTransform(e).getMatrix();s.transform(p[0],p[1],p[2],p[3],p[4],p[5]),s._applyOpacity(this),s._applyGlobalCompositeOperation(this)}l&&s._applyShadow(this),c.call(this,s,this)}return s.restore(),this}drawHit(t,e,i=!1){if(!this.shouldDrawHit(e,i))return this;var n=this.getLayer(),r=t||n.hitCanvas,a=r&&r.getContext(),o=this.hitFunc()||this.sceneFunc(),s=this._getCanvasCache(),h=s&&s.hit;if(this.colorKey||j.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),h){a.save();var c=this.getAbsoluteTransform(e).getMatrix();return a.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedHitCanvas(a),a.restore(),this}if(!o)return this;a.save(),a._applyLineJoin(this);const l=this===e;if(!l){var d=this.getAbsoluteTransform(e).getMatrix();a.transform(d[0],d[1],d[2],d[3],d[4],d[5])}return o.call(this,a,this),a.restore(),this}drawHitFromCache(t=0){var e,i,n,r,a,o,s=this._getCanvasCache(),h=this._getCachedSceneCanvas(),c=s.hit,l=c.getContext(),d=c.getWidth(),u=c.getHeight();l.clear(),l.drawImage(h._canvas,0,0,d,u);try{for(e=l.getImageData(0,0,d,u),i=e.data,n=i.length,r=j._hexToRgb(this.colorKey),a=0;a<n;a+=4)o=i[a+3],o>t?(i[a]=r.r,i[a+1]=r.g,i[a+2]=r.b,i[a+3]=255):i[a+3]=0;l.putImageData(e,0,0)}catch(f){j.error("Unable to draw hit graph from cached scene canvas. "+f.message)}return this}hasPointerCapture(t){return Kt(t,this)}setPointerCapture(t){Jt(t,this)}releaseCapture(t){Zt(t,this)}}Ke.prototype._fillFunc=Ne,Ke.prototype._strokeFunc=je,Ke.prototype._fillFuncHit=ze,Ke.prototype._strokeFuncHit=Ye,Ke.prototype._centroid=!1,Ke.prototype.nodeType="Shape",Object(P["b"])(Ke),Ke.prototype.eventListeners={},Ke.prototype.on.call(Ke.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Ue),Ke.prototype.on.call(Ke.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Xe),Ke.prototype.on.call(Ke.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",qe),Ke.prototype.on.call(Ke.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",Ve),Ke.prototype.on.call(Ke.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",Qe),et.addGetterSetter(Ke,"stroke",void 0,Q()),et.addGetterSetter(Ke,"strokeWidth",2,U()),et.addGetterSetter(Ke,"fillAfterStrokeEnabled",!1),et.addGetterSetter(Ke,"hitStrokeWidth","auto",q()),et.addGetterSetter(Ke,"strokeHitEnabled",!0,J()),et.addGetterSetter(Ke,"perfectDrawEnabled",!0,J()),et.addGetterSetter(Ke,"shadowForStrokeEnabled",!0,J()),et.addGetterSetter(Ke,"lineJoin"),et.addGetterSetter(Ke,"lineCap"),et.addGetterSetter(Ke,"sceneFunc"),et.addGetterSetter(Ke,"hitFunc"),et.addGetterSetter(Ke,"dash"),et.addGetterSetter(Ke,"dashOffset",0,U()),et.addGetterSetter(Ke,"shadowColor",void 0,V()),et.addGetterSetter(Ke,"shadowBlur",0,U()),et.addGetterSetter(Ke,"shadowOpacity",1,U()),et.addComponentsGetterSetter(Ke,"shadowOffset",["x","y"]),et.addGetterSetter(Ke,"shadowOffsetX",0,U()),et.addGetterSetter(Ke,"shadowOffsetY",0,U()),et.addGetterSetter(Ke,"fillPatternImage"),et.addGetterSetter(Ke,"fill",void 0,Q()),et.addGetterSetter(Ke,"fillPatternX",0,U()),et.addGetterSetter(Ke,"fillPatternY",0,U()),et.addGetterSetter(Ke,"fillLinearGradientColorStops"),et.addGetterSetter(Ke,"strokeLinearGradientColorStops"),et.addGetterSetter(Ke,"fillRadialGradientStartRadius",0),et.addGetterSetter(Ke,"fillRadialGradientEndRadius",0),et.addGetterSetter(Ke,"fillRadialGradientColorStops"),et.addGetterSetter(Ke,"fillPatternRepeat","repeat"),et.addGetterSetter(Ke,"fillEnabled",!0),et.addGetterSetter(Ke,"strokeEnabled",!0),et.addGetterSetter(Ke,"shadowEnabled",!0),et.addGetterSetter(Ke,"dashEnabled",!0),et.addGetterSetter(Ke,"strokeScaleEnabled",!0),et.addGetterSetter(Ke,"fillPriority","color"),et.addComponentsGetterSetter(Ke,"fillPatternOffset",["x","y"]),et.addGetterSetter(Ke,"fillPatternOffsetX",0,U()),et.addGetterSetter(Ke,"fillPatternOffsetY",0,U()),et.addComponentsGetterSetter(Ke,"fillPatternScale",["x","y"]),et.addGetterSetter(Ke,"fillPatternScaleX",1,U()),et.addGetterSetter(Ke,"fillPatternScaleY",1,U()),et.addComponentsGetterSetter(Ke,"fillLinearGradientStartPoint",["x","y"]),et.addComponentsGetterSetter(Ke,"strokeLinearGradientStartPoint",["x","y"]),et.addGetterSetter(Ke,"fillLinearGradientStartPointX",0),et.addGetterSetter(Ke,"strokeLinearGradientStartPointX",0),et.addGetterSetter(Ke,"fillLinearGradientStartPointY",0),et.addGetterSetter(Ke,"strokeLinearGradientStartPointY",0),et.addComponentsGetterSetter(Ke,"fillLinearGradientEndPoint",["x","y"]),et.addComponentsGetterSetter(Ke,"strokeLinearGradientEndPoint",["x","y"]),et.addGetterSetter(Ke,"fillLinearGradientEndPointX",0),et.addGetterSetter(Ke,"strokeLinearGradientEndPointX",0),et.addGetterSetter(Ke,"fillLinearGradientEndPointY",0),et.addGetterSetter(Ke,"strokeLinearGradientEndPointY",0),et.addComponentsGetterSetter(Ke,"fillRadialGradientStartPoint",["x","y"]),et.addGetterSetter(Ke,"fillRadialGradientStartPointX",0),et.addGetterSetter(Ke,"fillRadialGradientStartPointY",0),et.addComponentsGetterSetter(Ke,"fillRadialGradientEndPoint",["x","y"]),et.addGetterSetter(Ke,"fillRadialGradientEndPointX",0),et.addGetterSetter(Ke,"fillRadialGradientEndPointY",0),et.addGetterSetter(Ke,"fillPatternRotation",0),et.backCompat(Ke,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});var Je="#",Ze="beforeDraw",$e="draw",ti=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],ei=ti.length;class ii extends Ut{constructor(t){super(t),this.canvas=new bt,this.hitCanvas=new wt({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){const t=this.canvas._canvas;return t.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){zt.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var t=zt.prototype.moveUp.call(this);if(!t)return!1;var e=this.getStage();return!(!e||!e.content)&&(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(zt.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(zt.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return zt.prototype.remove.call(this),t&&t.parentNode&&j._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&j.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=void 0!==t.x?t.x:this.x(),t.y=void 0!==t.y?t.y:this.y(),zt.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){const t=this.visible();this.canvas._canvas.style.display=t?"block":"none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){j.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){j.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,j.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;var e=1,i=!1;while(1){for(let n=0;n<ei;n++){const r=ti[n],a=this._getIntersection({x:t.x+r.x*e,y:t.y+r.y*e}),o=a.shape;if(o)return o;if(i=!!a.antialiased,!a.antialiased)break}if(!i)return null;e+=1}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,n=i[3];if(255===n){const t=j._rgbToHex(i[0],i[1],i[2]),e=He[Je+t];return e?{shape:e}:{antialiased:!0}}return n>0?{antialiased:!0}:{}}drawScene(t,e){var i=this.getLayer(),n=t||i&&i.getCanvas();return this._fire(Ze,{node:this}),this.clearBeforeDraw()&&n.getContext().clear(),Ut.prototype.drawScene.call(this,n,e),this._fire($e,{node:this}),this}drawHit(t,e){var i=this.getLayer(),n=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),Ut.prototype.drawHit.call(this,n,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){j.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return j.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(this.parent&&this.parent["content"]){var t=this.parent,e=!!this.hitCanvas._canvas.parentNode;e?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}}ii.prototype.nodeType="Layer",Object(P["b"])(ii),et.addGetterSetter(ii,"imageSmoothingEnabled",!0),et.addGetterSetter(ii,"clearBeforeDraw",!0),et.addGetterSetter(ii,"hitGraphEnabled",!0,J());class ni extends ii{constructor(t){super(t),this.listening(!1),j.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}ni.prototype.nodeType="FastLayer",Object(P["b"])(ni);class ri extends Ut{_validateAdd(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&j.throw("You may only add groups and shapes to groups.")}}ri.prototype.nodeType="Group",Object(P["b"])(ri);var ai=function(){return P["c"].performance&&P["c"].performance.now?function(){return P["c"].performance.now()}:function(){return(new Date).getTime()}}();class oi{constructor(t,e){this.id=oi.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:ai(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){var e=[];return e=t?t.length>0?t:[t]:[],this.layers=e,this}getLayers(){return this.layers}addLayer(t){var e,i=this.layers,n=i.length;for(e=0;e<n;e++)if(i[e]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){var t,e=oi,i=e.animations,n=i.length;for(t=0;t<n;t++)if(i[t].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=ai(),oi._addAnimation(this),this}stop(){return oi._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){var e,i=t.id,n=this.animations,r=n.length;for(e=0;e<r;e++)if(n[e].id===i){this.animations.splice(e,1);break}}static _runFrames(){var t,e,i,n,r,a,o,s,h,c={},l=this.animations;for(n=0;n<l.length;n++)if(t=l[n],e=t.layers,i=t.func,t._updateFrameObject(ai()),a=e.length,h=!i||!1!==i.call(t,t.frame),h)for(r=0;r<a;r++)o=e[r],void 0!==o._id&&(c[o._id]=o);for(s in c)c.hasOwnProperty(s)&&c[s].batchDraw()}static _animationLoop(){var t=oi;t.animations.length?(t._runFrames(),j.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,j.requestAnimFrame(this._animationLoop))}}oi.animations=[],oi.animIdCounter=0,oi.animRunning=!1;var si={node:1,duration:1,easing:1,onFinish:1,yoyo:1},hi=1,ci=2,li=3,di=0,ui=["fill","stroke","shadowColor"];class fi{constructor(t,e,i,n,r,a,o){this.prop=t,this.propFunc=e,this.begin=n,this._pos=n,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=r-this.begin,this.pause()}fire(t){var e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=ci,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=li,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var t=this.getTimer()-this._startTime;this.state===ci?this.setTime(t):this.state===li&&this.setTime(this.duration-t)}pause(){this.state=hi,this.fire("onPause")}getTimer(){return(new Date).getTime()}}class pi{constructor(t){var e,i,n=this,r=t.node,a=r._id,o=t.easing||gi.Linear,s=!!t.yoyo;e="undefined"===typeof t.duration?.3:0===t.duration?.001:t.duration,this.node=r,this._id=di++;var h=r.getLayer()||(r instanceof P["a"]["Stage"]?r.getLayers():null);for(i in h||j.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new oi((function(){n.tween.onEnterFrame()}),h),this.tween=new fi(i,(function(t){n._tweenFunc(t)}),o,0,1,1e3*e,s),this._addListeners(),pi.attrs[a]||(pi.attrs[a]={}),pi.attrs[a][this._id]||(pi.attrs[a][this._id]={}),pi.tweens[a]||(pi.tweens[a]={}),t)void 0===si[i]&&this._addAttr(i,t[i]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){var i,n,r,a,o,s,h,c,l=this.node,d=l._id;if(r=pi.tweens[d][t],r&&delete pi.attrs[d][r][t],i=l.getAttr(t),j._isArray(e))if(n=[],o=Math.max(e.length,i.length),"points"===t&&e.length!==i.length&&(e.length>i.length?(h=i,i=j._prepareArrayForTween(i,e,l.closed())):(s=e,e=j._prepareArrayForTween(e,i,l.closed()))),0===t.indexOf("fill"))for(a=0;a<o;a++)if(a%2===0)n.push(e[a]-i[a]);else{var u=j.colorToRGBA(i[a]);c=j.colorToRGBA(e[a]),i[a]=u,n.push({r:c.r-u.r,g:c.g-u.g,b:c.b-u.b,a:c.a-u.a})}else for(a=0;a<o;a++)n.push(e[a]-i[a]);else-1!==ui.indexOf(t)?(i=j.colorToRGBA(i),c=j.colorToRGBA(e),n={r:c.r-i.r,g:c.g-i.g,b:c.b-i.b,a:c.a-i.a}):n=e-i;pi.attrs[d][this._id][t]={start:i,diff:n,end:e,trueEnd:s,trueStart:h},pi.tweens[d][t]=this._id}_tweenFunc(t){var e,i,n,r,a,o,s,h,c=this.node,l=pi.attrs[c._id][this._id];for(e in l){if(i=l[e],n=i.start,r=i.diff,h=i.end,j._isArray(n))if(a=[],s=Math.max(n.length,h.length),0===e.indexOf("fill"))for(o=0;o<s;o++)o%2===0?a.push((n[o]||0)+r[o]*t):a.push("rgba("+Math.round(n[o].r+r[o].r*t)+","+Math.round(n[o].g+r[o].g*t)+","+Math.round(n[o].b+r[o].b*t)+","+(n[o].a+r[o].a*t)+")");else for(o=0;o<s;o++)a.push((n[o]||0)+r[o]*t);else a=-1!==ui.indexOf(e)?"rgba("+Math.round(n.r+r.r*t)+","+Math.round(n.g+r.g*t)+","+Math.round(n.b+r.b*t)+","+(n.a+r.a*t)+")":n+r*t;c.setAttr(e,a)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var t=this.node,e=pi.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var t=this.node,e=pi.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(1e3*t),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var t,e=this.node._id,i=this._id,n=pi.tweens[e];for(t in this.pause(),n)delete pi.tweens[e][t];delete pi.attrs[e][i]}}pi.attrs={},pi.tweens={},zt.prototype.to=function(t){var e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()};var i=new pi(t);i.play()};const gi={BackEaseIn(t,e,i,n){var r=1.70158;return i*(t/=n)*t*((r+1)*t-r)+e},BackEaseOut(t,e,i,n){var r=1.70158;return i*((t=t/n-1)*t*((r+1)*t+r)+1)+e},BackEaseInOut(t,e,i,n){var r=1.70158;return(t/=n/2)<1?i/2*(t*t*((1+(r*=1.525))*t-r))+e:i/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},ElasticEaseIn(t,e,i,n,r,a){var o=0;return 0===t?e:1===(t/=n)?e+i:(a||(a=.3*n),!r||r<Math.abs(i)?(r=i,o=a/4):o=a/(2*Math.PI)*Math.asin(i/r),-r*Math.pow(2,10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/a)+e)},ElasticEaseOut(t,e,i,n,r,a){var o=0;return 0===t?e:1===(t/=n)?e+i:(a||(a=.3*n),!r||r<Math.abs(i)?(r=i,o=a/4):o=a/(2*Math.PI)*Math.asin(i/r),r*Math.pow(2,-10*t)*Math.sin((t*n-o)*(2*Math.PI)/a)+i+e)},ElasticEaseInOut(t,e,i,n,r,a){var o=0;return 0===t?e:2===(t/=n/2)?e+i:(a||(a=n*(.3*1.5)),!r||r<Math.abs(i)?(r=i,o=a/4):o=a/(2*Math.PI)*Math.asin(i/r),t<1?r*Math.pow(2,10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/a)*-.5+e:r*Math.pow(2,-10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/a)*.5+i+e)},BounceEaseOut(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},BounceEaseIn(t,e,i,n){return i-gi.BounceEaseOut(n-t,0,i,n)+e},BounceEaseInOut(t,e,i,n){return t<n/2?.5*gi.BounceEaseIn(2*t,0,i,n)+e:.5*gi.BounceEaseOut(2*t-n,0,i,n)+.5*i+e},EaseIn(t,e,i,n){return i*(t/=n)*t+e},EaseOut(t,e,i,n){return-i*(t/=n)*(t-2)+e},EaseInOut(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},StrongEaseIn(t,e,i,n){return i*(t/=n)*t*t*t*t+e},StrongEaseOut(t,e,i,n){return i*((t=t/n-1)*t*t*t*t+1)+e},StrongEaseInOut(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},Linear(t,e,i,n){return i*t/n+e}},yi=j._assign(P["a"],{Util:j,Transform:A,Node:zt,Container:Ut,Stage:Ee,stages:Me,Layer:ii,FastLayer:ni,Group:ri,DD:_t,Shape:Ke,shapes:He,Animation:oi,Tween:pi,Easings:gi,Context:pt,Canvas:mt});class vi extends Ke{_sceneFunc(t){var e=P["a"].getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),i=this.clockwise(),n=P["a"].getAngle(i?360-this.angle():this.angle()),r=Math.cos(Math.min(n,Math.PI)),a=1,o=Math.sin(Math.min(Math.max(Math.PI,n),3*Math.PI/2)),s=Math.sin(Math.min(n,Math.PI/2)),h=r*(r>0?t:e),c=a*(a>0?e:t),l=o*(o>0?t:e),d=s*(s>0?e:t);return{x:h,y:i?-1*d:l,width:c-h,height:d-l}}}function xi(t,e,i,n,r,a,o){var s=Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2)),h=Math.sqrt(Math.pow(r-i,2)+Math.pow(a-n,2)),c=o*s/(s+h),l=o*h/(s+h),d=i-c*(r-t),u=n-c*(a-e),f=i+l*(r-t),p=n+l*(a-e);return[d,u,f,p]}function mi(t,e){var i,n,r=t.length,a=[];for(i=2;i<r-2;i+=2)n=xi(t[i-2],t[i-1],t[i],t[i+1],t[i+2],t[i+3],e),isNaN(n[0])||(a.push(n[0]),a.push(n[1]),a.push(t[i]),a.push(t[i+1]),a.push(n[2]),a.push(n[3]));return a}vi.prototype._centroid=!0,vi.prototype.className="Arc",vi.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Object(P["b"])(vi),et.addGetterSetter(vi,"innerRadius",0,U()),et.addGetterSetter(vi,"outerRadius",0,U()),et.addGetterSetter(vi,"angle",0,U()),et.addGetterSetter(vi,"clockwise",!1,J());class bi extends Ke{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",(function(){this._clearCache("tensionPoints")}))}_sceneFunc(t){var e,i,n,r=this.points(),a=r.length,o=this.tension(),s=this.closed(),h=this.bezier();if(a){if(t.beginPath(),t.moveTo(r[0],r[1]),0!==o&&a>4){e=this.getTensionPoints(),i=e.length,n=s?0:4,s||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);while(n<i-2)t.bezierCurveTo(e[n++],e[n++],e[n++],e[n++],e[n++],e[n++]);s||t.quadraticCurveTo(e[i-2],e[i-1],r[a-2],r[a-1])}else if(h){n=2;while(n<a)t.bezierCurveTo(r[n++],r[n++],r[n++],r[n++],r[n++],r[n++])}else for(n=2;n<a;n+=2)t.lineTo(r[n],r[n+1]);s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():mi(this.points(),this.tension())}_getTensionPointsClosed(){var t=this.points(),e=t.length,i=this.tension(),n=xi(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),r=xi(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),a=mi(t,i),o=[n[2],n[3]].concat(a).concat([r[0],r[1],t[e-2],t[e-1],r[2],r[3],n[0],n[1],t[0],t[1]]);return o}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};t=0!==this.tension()?[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:this.points();for(var e,i,n=t[0],r=t[0],a=t[1],o=t[1],s=0;s<t.length/2;s++)e=t[2*s],i=t[2*s+1],n=Math.min(n,e),r=Math.max(r,e),a=Math.min(a,i),o=Math.max(o,i);return{x:n,y:a,width:r-n,height:o-a}}}bi.prototype.className="Line",bi.prototype._attrsAffectingSize=["points","bezier","tension"],Object(P["b"])(bi),et.addGetterSetter(bi,"closed",!1),et.addGetterSetter(bi,"bezier",!1),et.addGetterSetter(bi,"tension",0,U()),et.addGetterSetter(bi,"points",[],K());class wi extends Ke{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this.dataArray=wi.parsePathData(this.data()),this.pathLength=0;for(var e=0;e<this.dataArray.length;++e)this.pathLength+=this.dataArray[e].pathLength;this.on("dataChange.konva",(function(){this.dataArray=wi.parsePathData(this.data()),this.pathLength=0;for(var t=0;t<this.dataArray.length;++t)this.pathLength+=this.dataArray[t].pathLength}))}_sceneFunc(t){var e=this.dataArray;t.beginPath();for(var i=!1,n=0;n<e.length;n++){var r=e[n].command,a=e[n].points;switch(r){case"L":t.lineTo(a[0],a[1]);break;case"M":t.moveTo(a[0],a[1]);break;case"C":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"Q":t.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case"A":var o=a[0],s=a[1],h=a[2],c=a[3],l=a[4],d=a[5],u=a[6],f=a[7],p=h>c?h:c,g=h>c?1:h/c,y=h>c?c/h:1;t.translate(o,s),t.rotate(u),t.scale(g,y),t.arc(0,0,p,l,l+d,1-f),t.scale(1/g,1/y),t.rotate(-u),t.translate(-o,-s);break;case"z":i=!0,t.closePath();break}}i||this.hasFill()?t.fillStrokeShape(this):t.strokeShape(this)}getSelfRect(){var t=[];this.dataArray.forEach((function(e){if("A"===e.command){var i=e.points[4],n=e.points[5],r=e.points[4]+n,a=Math.PI/180;if(Math.abs(i-r)<a&&(a=Math.abs(i-r)),n<0)for(let n=i-a;n>r;n-=a){const i=wi.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],n,0);t.push(i.x,i.y)}else for(let n=i+a;n<r;n+=a){const i=wi.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],n,0);t.push(i.x,i.y)}}else if("C"===e.command)for(let o=0;o<=1;o+=.01){const i=wi.getPointOnCubicBezier(o,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);t.push(i.x,i.y)}else t=t.concat(e.points)}));for(var e,i,n=t[0],r=t[0],a=t[1],o=t[1],s=0;s<t.length/2;s++)e=t[2*s],i=t[2*s+1],isNaN(e)||(n=Math.min(n,e),r=Math.max(r,e)),isNaN(i)||(a=Math.min(a,i),o=Math.max(o,i));return{x:n,y:a,width:r-n,height:o-a}}getLength(){return this.pathLength}getPointAtLength(t){var e,i=0,n=this.dataArray.length;if(!n)return null;while(i<n&&t>this.dataArray[i].pathLength)t-=this.dataArray[i].pathLength,++i;if(i===n)return e=this.dataArray[i-1].points.slice(-2),{x:e[0],y:e[1]};if(t<.01)return e=this.dataArray[i].points.slice(0,2),{x:e[0],y:e[1]};var r=this.dataArray[i],a=r.points;switch(r.command){case"L":return wi.getPointOnLine(t,r.start.x,r.start.y,a[0],a[1]);case"C":return wi.getPointOnCubicBezier(t/r.pathLength,r.start.x,r.start.y,a[0],a[1],a[2],a[3],a[4],a[5]);case"Q":return wi.getPointOnQuadraticBezier(t/r.pathLength,r.start.x,r.start.y,a[0],a[1],a[2],a[3]);case"A":var o=a[0],s=a[1],h=a[2],c=a[3],l=a[4],d=a[5],u=a[6];return l+=d*t/r.pathLength,wi.getPointOnEllipticalArc(o,s,h,c,l,u)}return null}static getLineLength(t,e,i,n){return Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))}static getPointOnLine(t,e,i,n,r,a,o){void 0===a&&(a=e),void 0===o&&(o=i);var s=(r-i)/(n-e+1e-8),h=Math.sqrt(t*t/(1+s*s));n<e&&(h*=-1);var c,l=s*h;if(n===e)c={x:a,y:o+l};else if((o-i)/(a-e+1e-8)===s)c={x:a+h,y:o+l};else{var d,u,f=this.getLineLength(e,i,n,r),p=(a-e)*(n-e)+(o-i)*(r-i);p/=f*f,d=e+p*(n-e),u=i+p*(r-i);var g=this.getLineLength(a,o,d,u),y=Math.sqrt(t*t-g*g);h=Math.sqrt(y*y/(1+s*s)),n<e&&(h*=-1),l=s*h,c={x:d+h,y:u+l}}return c}static getPointOnCubicBezier(t,e,i,n,r,a,o,s,h){function c(t){return t*t*t}function l(t){return 3*t*t*(1-t)}function d(t){return 3*t*(1-t)*(1-t)}function u(t){return(1-t)*(1-t)*(1-t)}var f=s*c(t)+a*l(t)+n*d(t)+e*u(t),p=h*c(t)+o*l(t)+r*d(t)+i*u(t);return{x:f,y:p}}static getPointOnQuadraticBezier(t,e,i,n,r,a,o){function s(t){return t*t}function h(t){return 2*t*(1-t)}function c(t){return(1-t)*(1-t)}var l=a*s(t)+n*h(t)+e*c(t),d=o*s(t)+r*h(t)+i*c(t);return{x:l,y:d}}static getPointOnEllipticalArc(t,e,i,n,r,a){var o=Math.cos(a),s=Math.sin(a),h={x:i*Math.cos(r),y:n*Math.sin(r)};return{x:t+(h.x*o-h.y*s),y:e+(h.x*s+h.y*o)}}static parsePathData(t){if(!t)return[];var e=t,i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var n=0;n<i.length;n++)e=e.replace(new RegExp(i[n],"g"),"|"+i[n]);var r,a=e.split("|"),o=[],s=[],h=0,c=0,l=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(n=1;n<a.length;n++){var d=a[n],u=d.charAt(0);d=d.slice(1),s.length=0;while(r=l.exec(d))s.push(r[0]);for(var f=[],p=0,g=s.length;p<g;p++)if("00"!==s[p]){var y=parseFloat(s[p]);isNaN(y)?f.push(0):f.push(y)}else f.push(0,0);while(f.length>0){if(isNaN(f[0]))break;var v,x,m,b,w,_,S,P,A,C,R=null,L=[],k=h,T=c;switch(u){case"l":h+=f.shift(),c+=f.shift(),R="L",L.push(h,c);break;case"L":h=f.shift(),c=f.shift(),L.push(h,c);break;case"m":var M=f.shift(),E=f.shift();if(h+=M,c+=E,R="M",o.length>2&&"z"===o[o.length-1].command)for(var O=o.length-2;O>=0;O--)if("M"===o[O].command){h=o[O].points[0]+M,c=o[O].points[1]+E;break}L.push(h,c),u="l";break;case"M":h=f.shift(),c=f.shift(),R="M",L.push(h,c),u="L";break;case"h":h+=f.shift(),R="L",L.push(h,c);break;case"H":h=f.shift(),R="L",L.push(h,c);break;case"v":c+=f.shift(),R="L",L.push(h,c);break;case"V":c=f.shift(),R="L",L.push(h,c);break;case"C":L.push(f.shift(),f.shift(),f.shift(),f.shift()),h=f.shift(),c=f.shift(),L.push(h,c);break;case"c":L.push(h+f.shift(),c+f.shift(),h+f.shift(),c+f.shift()),h+=f.shift(),c+=f.shift(),R="C",L.push(h,c);break;case"S":x=h,m=c,v=o[o.length-1],"C"===v.command&&(x=h+(h-v.points[2]),m=c+(c-v.points[3])),L.push(x,m,f.shift(),f.shift()),h=f.shift(),c=f.shift(),R="C",L.push(h,c);break;case"s":x=h,m=c,v=o[o.length-1],"C"===v.command&&(x=h+(h-v.points[2]),m=c+(c-v.points[3])),L.push(x,m,h+f.shift(),c+f.shift()),h+=f.shift(),c+=f.shift(),R="C",L.push(h,c);break;case"Q":L.push(f.shift(),f.shift()),h=f.shift(),c=f.shift(),L.push(h,c);break;case"q":L.push(h+f.shift(),c+f.shift()),h+=f.shift(),c+=f.shift(),R="Q",L.push(h,c);break;case"T":x=h,m=c,v=o[o.length-1],"Q"===v.command&&(x=h+(h-v.points[0]),m=c+(c-v.points[1])),h=f.shift(),c=f.shift(),R="Q",L.push(x,m,h,c);break;case"t":x=h,m=c,v=o[o.length-1],"Q"===v.command&&(x=h+(h-v.points[0]),m=c+(c-v.points[1])),h+=f.shift(),c+=f.shift(),R="Q",L.push(x,m,h,c);break;case"A":b=f.shift(),w=f.shift(),_=f.shift(),S=f.shift(),P=f.shift(),A=h,C=c,h=f.shift(),c=f.shift(),R="A",L=this.convertEndpointToCenterParameterization(A,C,h,c,S,P,b,w,_);break;case"a":b=f.shift(),w=f.shift(),_=f.shift(),S=f.shift(),P=f.shift(),A=h,C=c,h+=f.shift(),c+=f.shift(),R="A",L=this.convertEndpointToCenterParameterization(A,C,h,c,S,P,b,w,_);break}o.push({command:R||u,points:L,start:{x:k,y:T},pathLength:this.calcLength(k,T,R||u,L)})}"z"!==u&&"Z"!==u||o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(t,e,i,n){var r,a,o,s,h=wi;switch(i){case"L":return h.getLineLength(t,e,n[0],n[1]);case"C":for(r=0,a=h.getPointOnCubicBezier(0,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),s=.01;s<=1;s+=.01)o=h.getPointOnCubicBezier(s,t,e,n[0],n[1],n[2],n[3],n[4],n[5]),r+=h.getLineLength(a.x,a.y,o.x,o.y),a=o;return r;case"Q":for(r=0,a=h.getPointOnQuadraticBezier(0,t,e,n[0],n[1],n[2],n[3]),s=.01;s<=1;s+=.01)o=h.getPointOnQuadraticBezier(s,t,e,n[0],n[1],n[2],n[3]),r+=h.getLineLength(a.x,a.y,o.x,o.y),a=o;return r;case"A":r=0;var c=n[4],l=n[5],d=n[4]+l,u=Math.PI/180;if(Math.abs(c-d)<u&&(u=Math.abs(c-d)),a=h.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],c,0),l<0)for(s=c-u;s>d;s-=u)o=h.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],s,0),r+=h.getLineLength(a.x,a.y,o.x,o.y),a=o;else for(s=c+u;s<d;s+=u)o=h.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],s,0),r+=h.getLineLength(a.x,a.y,o.x,o.y),a=o;return o=h.getPointOnEllipticalArc(n[0],n[1],n[2],n[3],d,0),r+=h.getLineLength(a.x,a.y,o.x,o.y),r}return 0}static convertEndpointToCenterParameterization(t,e,i,n,r,a,o,s,h){var c=h*(Math.PI/180),l=Math.cos(c)*(t-i)/2+Math.sin(c)*(e-n)/2,d=-1*Math.sin(c)*(t-i)/2+Math.cos(c)*(e-n)/2,u=l*l/(o*o)+d*d/(s*s);u>1&&(o*=Math.sqrt(u),s*=Math.sqrt(u));var f=Math.sqrt((o*o*(s*s)-o*o*(d*d)-s*s*(l*l))/(o*o*(d*d)+s*s*(l*l)));r===a&&(f*=-1),isNaN(f)&&(f=0);var p=f*o*d/s,g=f*-s*l/o,y=(t+i)/2+Math.cos(c)*p-Math.sin(c)*g,v=(e+n)/2+Math.sin(c)*p+Math.cos(c)*g,x=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},m=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(x(t)*x(e))},b=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(m(t,e))},w=b([1,0],[(l-p)/o,(d-g)/s]),_=[(l-p)/o,(d-g)/s],S=[(-1*l-p)/o,(-1*d-g)/s],P=b(_,S);return m(_,S)<=-1&&(P=Math.PI),m(_,S)>=1&&(P=0),0===a&&P>0&&(P-=2*Math.PI),1===a&&P<0&&(P+=2*Math.PI),[y,v,o,s,w,P,c,a]}}wi.prototype.className="Path",wi.prototype._attrsAffectingSize=["data"],Object(P["b"])(wi),et.addGetterSetter(wi,"data");class _i extends bi{_sceneFunc(t){super._sceneFunc(t);var e=2*Math.PI,i=this.points(),n=i,r=0!==this.tension()&&i.length>4;r&&(n=this.getTensionPoints());var a,o,s=this.pointerLength(),h=i.length;if(r){const t=[n[n.length-4],n[n.length-3],n[n.length-2],n[n.length-1],i[h-2],i[h-1]],e=wi.calcLength(n[n.length-4],n[n.length-3],"C",t),r=wi.getPointOnQuadraticBezier(Math.min(1,1-s/e),t[0],t[1],t[2],t[3],t[4],t[5]);a=i[h-2]-r.x,o=i[h-1]-r.y}else a=i[h-2]-i[h-4],o=i[h-1]-i[h-3];var c=(Math.atan2(o,a)+e)%e,l=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[h-2],i[h-1]),t.rotate(c),t.moveTo(0,0),t.lineTo(-s,l/2),t.lineTo(-s,-l/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),r?(a=(n[0]+n[2])/2-i[0],o=(n[1]+n[3])/2-i[1]):(a=i[2]-i[0],o=i[3]-i[1]),t.rotate((Math.atan2(-o,-a)+e)%e),t.moveTo(0,0),t.lineTo(-s,l/2),t.lineTo(-s,-l/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){var e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e}}}_i.prototype.className="Arrow",Object(P["b"])(_i),et.addGetterSetter(_i,"pointerLength",10,U()),et.addGetterSetter(_i,"pointerWidth",10,U()),et.addGetterSetter(_i,"pointerAtBeginning",!1),et.addGetterSetter(_i,"pointerAtEnding",!0);class Si extends Ke{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}}Si.prototype._centroid=!0,Si.prototype.className="Circle",Si.prototype._attrsAffectingSize=["radius"],Object(P["b"])(Si),et.addGetterSetter(Si,"radius",0,U());class Pi extends Ke{_sceneFunc(t){var e=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),e!==i&&t.scale(1,i/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radiusX()}getHeight(){return 2*this.radiusY()}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}}Pi.prototype.className="Ellipse",Pi.prototype._centroid=!0,Pi.prototype._attrsAffectingSize=["radiusX","radiusY"],Object(P["b"])(Pi),et.addComponentsGetterSetter(Pi,"radius",["x","y"]),et.addGetterSetter(Pi,"radiusX",0,U()),et.addGetterSetter(Pi,"radiusY",0,U());class Ai extends Ke{constructor(t){super(t),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&4===t.readyState||t&&t["addEventListener"]&&t["addEventListener"]("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),i=this.getHeight(),n=this.attrs.image;let r;if(n){const t=this.attrs.cropWidth,a=this.attrs.cropHeight;r=t&&a?[n,this.cropX(),this.cropY(),t,a,0,0,e,i]:[n,0,0,e,i]}(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)),n&&t.drawImage.apply(t,r)}_hitFunc(t){var e=this.width(),i=this.height();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e;return null!==(t=this.attrs.width)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.width}getHeight(){var t,e;return null!==(t=this.attrs.height)&&void 0!==t?t:null===(e=this.image())||void 0===e?void 0:e.height}static fromURL(t,e,i=null){var n=j.createImageElement();n.onload=function(){var t=new Ai({image:n});e(t)},n.onerror=i,n.crossOrigin="Anonymous",n.src=t}}Ai.prototype.className="Image",Object(P["b"])(Ai),et.addGetterSetter(Ai,"image"),et.addComponentsGetterSetter(Ai,"crop",["x","y","width","height"]),et.addGetterSetter(Ai,"cropX",0,U()),et.addGetterSetter(Ai,"cropY",0,U()),et.addGetterSetter(Ai,"cropWidth",0,U()),et.addGetterSetter(Ai,"cropHeight",0,U());var Ci=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height"],Ri="Change.konva",Li="none",ki="up",Ti="right",Mi="down",Ei="left",Oi=Ci.length;class Di extends ri{constructor(t){super(t),this.on("add.konva",(function(t){this._addListeners(t.child),this._sync()}))}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){var e,i=this,n=function(){i._sync()};for(e=0;e<Oi;e++)t.on(Ci[e]+Ri,n)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var t,e,i,n,r,a,o,s=this.getText(),h=this.getTag();if(s&&h){switch(t=s.width(),e=s.height(),i=h.pointerDirection(),n=h.pointerWidth(),o=h.pointerHeight(),r=0,a=0,i){case ki:r=t/2,a=-1*o;break;case Ti:r=t+n,a=e/2;break;case Mi:r=t/2,a=e+o;break;case Ei:r=-1*n,a=e/2;break}h.setAttrs({x:-1*r,y:-1*a,width:t,height:e}),s.setAttrs({x:-1*r,y:-1*a})}}}Di.prototype.className="Label",Object(P["b"])(Di);class Ii extends Ke{_sceneFunc(t){var e=this.width(),i=this.height(),n=this.pointerDirection(),r=this.pointerWidth(),a=this.pointerHeight(),o=this.cornerRadius();let s=0,h=0,c=0,l=0;"number"===typeof o?s=h=c=l=Math.min(o,e/2,i/2):(s=Math.min(o[0]||0,e/2,i/2),h=Math.min(o[1]||0,e/2,i/2),l=Math.min(o[2]||0,e/2,i/2),c=Math.min(o[3]||0,e/2,i/2)),t.beginPath(),t.moveTo(s,0),n===ki&&(t.lineTo((e-r)/2,0),t.lineTo(e/2,-1*a),t.lineTo((e+r)/2,0)),t.lineTo(e-h,0),t.arc(e-h,h,h,3*Math.PI/2,0,!1),n===Ti&&(t.lineTo(e,(i-a)/2),t.lineTo(e+r,i/2),t.lineTo(e,(i+a)/2)),t.lineTo(e,i-l),t.arc(e-l,i-l,l,0,Math.PI/2,!1),n===Mi&&(t.lineTo((e+r)/2,i),t.lineTo(e/2,i+a),t.lineTo((e-r)/2,i)),t.lineTo(c,i),t.arc(c,i-c,c,Math.PI/2,Math.PI,!1),n===Ei&&(t.lineTo(0,(i+a)/2),t.lineTo(-1*r,i/2),t.lineTo(0,(i-a)/2)),t.lineTo(0,s),t.arc(s,s,s,Math.PI,3*Math.PI/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){var t=0,e=0,i=this.pointerWidth(),n=this.pointerHeight(),r=this.pointerDirection(),a=this.width(),o=this.height();return r===ki?(e-=n,o+=n):r===Mi?o+=n:r===Ei?(t-=1.5*i,a+=i):r===Ti&&(a+=1.5*i),{x:t,y:e,width:a,height:o}}}Ii.prototype.className="Tag",Object(P["b"])(Ii),et.addGetterSetter(Ii,"pointerDirection",Li),et.addGetterSetter(Ii,"pointerWidth",0,U()),et.addGetterSetter(Ii,"pointerHeight",0,U()),et.addGetterSetter(Ii,"cornerRadius",0,X(4));class Wi extends Ke{_sceneFunc(t){var e=this.cornerRadius(),i=this.width(),n=this.height();if(t.beginPath(),e){let r=0,a=0,o=0,s=0;"number"===typeof e?r=a=o=s=Math.min(e,i/2,n/2):(r=Math.min(e[0]||0,i/2,n/2),a=Math.min(e[1]||0,i/2,n/2),s=Math.min(e[2]||0,i/2,n/2),o=Math.min(e[3]||0,i/2,n/2)),t.moveTo(r,0),t.lineTo(i-a,0),t.arc(i-a,a,a,3*Math.PI/2,0,!1),t.lineTo(i,n-s),t.arc(i-s,n-s,s,0,Math.PI/2,!1),t.lineTo(o,n),t.arc(o,n-o,o,Math.PI/2,Math.PI,!1),t.lineTo(0,r),t.arc(r,r,r,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,i,n);t.closePath(),t.fillStrokeShape(this)}}Wi.prototype.className="Rect",Object(P["b"])(Wi),et.addGetterSetter(Wi,"cornerRadius",0,X(4));class Gi extends Ke{_sceneFunc(t){const e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;i++)t.lineTo(e[i].x,e[i].y);t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,i=[];for(var n=0;n<t;n++)i.push({x:e*Math.sin(2*n*Math.PI/t),y:-1*e*Math.cos(2*n*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();var e=t[0].x,i=t[0].y,n=t[0].x,r=t[0].y;return t.forEach(t=>{e=Math.min(e,t.x),i=Math.max(i,t.x),n=Math.min(n,t.y),r=Math.max(r,t.y)}),{x:e,y:n,width:i-e,height:r-n}}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Gi.prototype.className="RegularPolygon",Gi.prototype._centroid=!0,Gi.prototype._attrsAffectingSize=["radius"],Object(P["b"])(Gi),et.addGetterSetter(Gi,"radius",0,U()),et.addGetterSetter(Gi,"sides",0,U());var Fi=2*Math.PI;class Bi extends Ke{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Fi,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Fi,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Bi.prototype.className="Ring",Bi.prototype._centroid=!0,Bi.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Object(P["b"])(Bi),et.addGetterSetter(Bi,"innerRadius",0,U()),et.addGetterSetter(Bi,"outerRadius",0,U());class Hi extends Ke{constructor(t){super(t),this._updated=!0,this.anim=new oi(()=>{var t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",(function(){this.frameIndex(0)})),this.on("frameIndexChange.konva",(function(){this._updated=!0})),this.on("frameRateChange.konva",(function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}))}_sceneFunc(t){var e=this.animation(),i=this.frameIndex(),n=4*i,r=this.animations()[e],a=this.frameOffsets(),o=r[n+0],s=r[n+1],h=r[n+2],c=r[n+3],l=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,h,c),t.closePath(),t.fillStrokeShape(this)),l)if(a){var d=a[e],u=2*i;t.drawImage(l,o,s,h,c,d[u+0],d[u+1],h,c)}else t.drawImage(l,o,s,h,c,0,0,h,c)}_hitFunc(t){var e=this.animation(),i=this.frameIndex(),n=4*i,r=this.animations()[e],a=this.frameOffsets(),o=r[n+2],s=r[n+3];if(t.beginPath(),a){var h=a[e],c=2*i;t.rect(h[c+0],h[c+1],o,s)}else t.rect(0,0,o,s);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var t=this;this.interval=setInterval((function(){t._updateIndex()}),1e3/this.frameRate())}start(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var t=this.frameIndex(),e=this.animation(),i=this.animations(),n=i[e],r=n.length/4;t<r-1?this.frameIndex(t+1):this.frameIndex(0)}}Hi.prototype.className="Sprite",Object(P["b"])(Hi),et.addGetterSetter(Hi,"animation"),et.addGetterSetter(Hi,"animations"),et.addGetterSetter(Hi,"frameOffsets"),et.addGetterSetter(Hi,"image"),et.addGetterSetter(Hi,"frameIndex",0,U()),et.addGetterSetter(Hi,"frameRate",17,U()),et.backCompat(Hi,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class Ni extends Ke{_sceneFunc(t){var e=this.innerRadius(),i=this.outerRadius(),n=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(var r=1;r<2*n;r++){var a=r%2===0?i:e,o=a*Math.sin(r*Math.PI/n),s=-1*a*Math.cos(r*Math.PI/n);t.lineTo(o,s)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.outerRadius()}getHeight(){return 2*this.outerRadius()}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}function ji(t){return Array.from(t)}Ni.prototype.className="Star",Ni.prototype._centroid=!0,Ni.prototype._attrsAffectingSize=["innerRadius","outerRadius"],Object(P["b"])(Ni),et.addGetterSetter(Ni,"numPoints",5,U()),et.addGetterSetter(Ni,"innerRadius",0,U()),et.addGetterSetter(Ni,"outerRadius",0,U());var zi,Yi="auto",Ui="center",Xi="justify",qi="Change.konva",Vi="2d",Qi="-",Ki="left",Ji="text",Zi="Text",$i="top",tn="bottom",en="middle",nn="normal",rn="px ",an=" ",on="right",sn="word",hn="char",cn="none",ln="…",dn=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],un=dn.length;function fn(t){return t.split(",").map(t=>{t=t.trim();const e=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!i&&(t=`"${t}"`),t}).join(", ")}function pn(){return zi||(zi=j.createCanvasElement().getContext(Vi),zi)}function gn(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function yn(t){t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function vn(t){return t=t||{},t.fillLinearGradientColorStops||t.fillRadialGradientColorStops||t.fillPatternImage||(t.fill=t.fill||"black"),t}class xn extends Ke{constructor(t){super(vn(t)),this._partialTextX=0,this._partialTextY=0;for(var e=0;e<un;e++)this.on(dn[e]+qi,this._setTextData);this._setTextData()}_sceneFunc(t){var e=this.textArr,i=e.length;if(this.text()){var n,r=this.padding(),a=this.fontSize(),o=this.lineHeight()*a,s=this.verticalAlign(),h=0,c=this.align(),l=this.getWidth(),d=this.letterSpacing(),u=this.fill(),f=this.textDecoration(),p=-1!==f.indexOf("underline"),g=-1!==f.indexOf("line-through"),y=0,v=(y=o/2,0),x=0;for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",en),t.setAttr("textAlign",Ki),s===en?h=(this.getHeight()-i*o-2*r)/2:s===tn&&(h=this.getHeight()-i*o-2*r),t.translate(r,h+r),n=0;n<i;n++){v=0,x=0;var m,b,w,_=e[n],S=_.text,P=_.width,A=_.lastInParagraph;if(t.save(),c===on?v+=l-P-2*r:c===Ui&&(v+=(l-P-2*r)/2),p&&(t.save(),t.beginPath(),t.moveTo(v,y+x+Math.round(a/2)),m=S.split(" ").length-1,b=0===m,w=c===Xi&&A&&!b?l-2*r:P,t.lineTo(v+Math.round(w),y+x+Math.round(a/2)),t.lineWidth=a/15,t.strokeStyle=u,t.stroke(),t.restore()),g&&(t.save(),t.beginPath(),t.moveTo(v,y+x),m=S.split(" ").length-1,b=0===m,w=c===Xi&&A&&!b?l-2*r:P,t.lineTo(v+Math.round(w),y+x),t.lineWidth=a/15,t.strokeStyle=u,t.stroke(),t.restore()),0!==d||c===Xi){m=S.split(" ").length-1;for(var C=ji(S),R=0;R<C.length;R++){var L=C[R];" "!==L||A||c!==Xi||(v+=(l-2*r-P)/m),this._partialTextX=v,this._partialTextY=y+x,this._partialText=L,t.fillStrokeShape(this),v+=this.measureSize(L).width+d}}else this._partialTextX=v,this._partialTextY=y+x,this._partialText=S,t.fillStrokeShape(this);t.restore(),i>1&&(y+=o)}}}_hitFunc(t){var e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}setText(t){var e=j._isString(t)?t:null===t||void 0===t?"":t+"";return this._setAttr(Ji,e),this}getWidth(){var t=this.attrs.width===Yi||void 0===this.attrs.width;return t?this.getTextWidth()+2*this.padding():this.attrs.width}getHeight(){var t=this.attrs.height===Yi||void 0===this.attrs.height;return t?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return j.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,i=pn(),n=this.fontSize();return i.save(),i.font=this._getContextFont(),e=i.measureText(t),i.restore(),{width:e.width,height:n}}_getContextFont(){return this.fontStyle()+an+this.fontVariant()+an+(this.fontSize()+rn)+fn(this.fontFamily())}_addTextLine(t){this.align()===Xi&&(t=t.trim());var e=this._getTextWidth(t);return this.textArr.push({text:t,width:e,lastInParagraph:!1})}_getTextWidth(t){var e=this.letterSpacing(),i=t.length;return pn().measureText(t).width+(i?e*(i-1):0)}_setTextData(){var t=this.text().split("\n"),e=+this.fontSize(),i=0,n=this.lineHeight()*e,r=this.attrs.width,a=this.attrs.height,o=r!==Yi&&void 0!==r,s=a!==Yi&&void 0!==a,h=this.padding(),c=r-2*h,l=a-2*h,d=0,u=this.wrap(),f=u!==cn,p=u!==hn&&f,g=this.ellipsis();this.textArr=[],pn().font=this._getContextFont();for(var y=g?this._getTextWidth(ln):0,v=0,x=t.length;v<x;++v){var m=t[v],b=this._getTextWidth(m);if(o&&b>c)while(m.length>0){var w=0,_=m.length,S="",P=0;while(w<_){var A=w+_>>>1,C=m.slice(0,A+1),R=this._getTextWidth(C)+y;R<=c?(w=A+1,S=C,P=R):_=A}if(!S)break;if(p){var L,k=m[S.length],T=k===an||k===Qi;L=T&&P<=c?S.length:Math.max(S.lastIndexOf(an),S.lastIndexOf(Qi))+1,L>0&&(w=L,S=S.slice(0,w),P=this._getTextWidth(S))}if(S=S.trimRight(),this._addTextLine(S),i=Math.max(i,P),d+=n,!f||s&&d+n>l){var M=this.textArr[this.textArr.length-1];if(M&&g){var E=this._getTextWidth(M.text+ln)<c;E||(M.text=M.text.slice(0,M.text.length-3)),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(M.text+ln)}break}if(m=m.slice(w),m=m.trimLeft(),m.length>0&&(b=this._getTextWidth(m),b<=c)){this._addTextLine(m),d+=n,i=Math.max(i,b);break}}else this._addTextLine(m),d+=n,i=Math.max(i,b);if(s&&d+n>l)break;this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0)}this.textHeight=e,this.textWidth=i}getStrokeScaleEnabled(){return!0}}xn.prototype._fillFunc=gn,xn.prototype._strokeFunc=yn,xn.prototype.className=Zi,xn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],Object(P["b"])(xn),et.overWriteSetter(xn,"width",q()),et.overWriteSetter(xn,"height",q()),et.addGetterSetter(xn,"fontFamily","Arial"),et.addGetterSetter(xn,"fontSize",12,U()),et.addGetterSetter(xn,"fontStyle",nn),et.addGetterSetter(xn,"fontVariant",nn),et.addGetterSetter(xn,"padding",0,U()),et.addGetterSetter(xn,"align",Ki),et.addGetterSetter(xn,"verticalAlign",$i),et.addGetterSetter(xn,"lineHeight",1,U()),et.addGetterSetter(xn,"wrap",sn),et.addGetterSetter(xn,"ellipsis",!1,J()),et.addGetterSetter(xn,"letterSpacing",0,U()),et.addGetterSetter(xn,"text","",V()),et.addGetterSetter(xn,"textDecoration","");var mn="",bn="normal";function wn(t){t.fillText(this.partialText,0,0)}function _n(t){t.strokeText(this.partialText,0,0)}class Sn extends Ke{constructor(t){super(t),this.dummyCanvas=j.createCanvasElement(),this.dataArray=[],this.dataArray=wi.parsePathData(this.attrs.data),this.on("dataChange.konva",(function(){this.dataArray=wi.parsePathData(this.attrs.data),this._setTextData()})),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),i=this.fill(),n=this.fontSize(),r=this.glyphInfo;"underline"===e&&t.beginPath();for(var a=0;a<r.length;a++){t.save();var o=r[a].p0;t.translate(o.x,o.y),t.rotate(r[a].rotation),this.partialText=r[a].text,t.fillStrokeShape(this),"underline"===e&&(0===a&&t.moveTo(0,n/2+1),t.lineTo(n,n/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=i,t.lineWidth=n/20,t.stroke()),t.restore()}_hitFunc(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var i=e[0].p0;t.moveTo(i.x,i.y)}for(var n=0;n<e.length;n++){var r=e[n].p1;t.lineTo(r.x,r.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return j.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return xn.prototype.setText.call(this,t)}_getContextFont(){return xn.prototype._getContextFont.call(this)}_getTextSize(t){var e=this.dummyCanvas,i=e.getContext("2d");i.save(),i.font=this._getContextFont();var n=i.measureText(t);return i.restore(),{width:n.width,height:parseInt(this.attrs.fontSize,10)}}_setTextData(){var t=this,e=this._getTextSize(this.attrs.text),i=this.letterSpacing(),n=this.align(),r=this.kerningFunc();this.textWidth=e.width,this.textHeight=e.height;var a=Math.max(this.textWidth+((this.attrs.text||"").length-1)*i,0);this.glyphInfo=[];for(var o=0,s=0;s<t.dataArray.length;s++)t.dataArray[s].pathLength>0&&(o+=t.dataArray[s].pathLength);var h=0;"center"===n&&(h=Math.max(0,o/2-a/2)),"right"===n&&(h=Math.max(0,o-a));for(var c,l,d,u=ji(this.text()),f=this.text().split(" ").length-1,p=-1,g=0,y=function(){g=0;for(var e=t.dataArray,i=p+1;i<e.length;i++){if(e[i].pathLength>0)return p=i,e[i];"M"===e[i].command&&(c={x:e[i].points[0],y:e[i].points[1]})}return{}},v=function(e){var r=t._getTextSize(e).width+i;" "===e&&"justify"===n&&(r+=(o-a)/f);var s=0,h=0;l=void 0;while(Math.abs(r-s)/r>.01&&h<20){h++;var u=s;while(void 0===d)d=y(),d&&u+d.pathLength<r&&(u+=d.pathLength,d=void 0);if(d==={}||void 0===c)return;var p=!1;switch(d.command){case"L":wi.getLineLength(c.x,c.y,d.points[0],d.points[1])>r?l=wi.getPointOnLine(r,c.x,c.y,d.points[0],d.points[1],c.x,c.y):d=void 0;break;case"A":var v=d.points[4],x=d.points[5],m=d.points[4]+x;0===g?g=v+1e-8:r>s?g+=Math.PI/180*x/Math.abs(x):g-=Math.PI/360*x/Math.abs(x),(x<0&&g<m||x>=0&&g>m)&&(g=m,p=!0),l=wi.getPointOnEllipticalArc(d.points[0],d.points[1],d.points[2],d.points[3],g,d.points[6]);break;case"C":0===g?g=r>d.pathLength?1e-8:r/d.pathLength:r>s?g+=(r-s)/d.pathLength/2:g=Math.max(g-(s-r)/d.pathLength/2,0),g>1&&(g=1,p=!0),l=wi.getPointOnCubicBezier(g,d.start.x,d.start.y,d.points[0],d.points[1],d.points[2],d.points[3],d.points[4],d.points[5]);break;case"Q":0===g?g=r/d.pathLength:r>s?g+=(r-s)/d.pathLength:g-=(s-r)/d.pathLength,g>1&&(g=1,p=!0),l=wi.getPointOnQuadraticBezier(g,d.start.x,d.start.y,d.points[0],d.points[1],d.points[2],d.points[3]);break}void 0!==l&&(s=wi.getLineLength(c.x,c.y,l.x,l.y)),p&&(p=!1,d=void 0)}},x="C",m=t._getTextSize(x).width+i,b=h/m-1,w=0;w<b;w++){if(v(x),void 0===c||void 0===l)break;c=l}for(var _=0;_<u.length;_++){if(v(u[_]),void 0===c||void 0===l)break;var S=wi.getLineLength(c.x,c.y,l.x,l.y),P=0;if(r)try{P=r(u[_-1],u[_])*this.fontSize()}catch(R){P=0}c.x+=P,l.x+=P,this.textWidth+=P;var A=wi.getPointOnLine(P+S/2,c.x,c.y,l.x,l.y),C=Math.atan2(l.y-c.y,l.x-c.x);this.glyphInfo.push({transposeX:A.x,transposeY:A.y,text:u[_],rotation:C,p0:c,p1:l}),c=l}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach((function(e){t.push(e.p0.x),t.push(e.p0.y),t.push(e.p1.x),t.push(e.p1.y)}));for(var e,i,n=t[0]||0,r=t[0]||0,a=t[1]||0,o=t[1]||0,s=0;s<t.length/2;s++)e=t[2*s],i=t[2*s+1],n=Math.min(n,e),r=Math.max(r,e),a=Math.min(a,i),o=Math.max(o,i);var h=this.fontSize();return{x:n-h/2,y:a-h/2,width:r-n+h,height:o-a+h}}}Sn.prototype._fillFunc=wn,Sn.prototype._strokeFunc=_n,Sn.prototype._fillFuncHit=wn,Sn.prototype._strokeFuncHit=_n,Sn.prototype.className="TextPath",Sn.prototype._attrsAffectingSize=["text","fontSize","data"],Object(P["b"])(Sn),et.addGetterSetter(Sn,"data"),et.addGetterSetter(Sn,"fontFamily","Arial"),et.addGetterSetter(Sn,"fontSize",12,U()),et.addGetterSetter(Sn,"fontStyle",bn),et.addGetterSetter(Sn,"align","left"),et.addGetterSetter(Sn,"letterSpacing",0,U()),et.addGetterSetter(Sn,"textBaseline","middle"),et.addGetterSetter(Sn,"fontVariant",bn),et.addGetterSetter(Sn,"text",mn),et.addGetterSetter(Sn,"textDecoration",null),et.addGetterSetter(Sn,"kerningFunc",null);var Pn="tr-konva",An=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map(t=>t+"."+Pn).join(" "),Cn="nodesRect",Rn=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],Ln={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const kn="ontouchstart"in P["a"]._global;function Tn(t,e){if("rotater"===t)return"crosshair";e+=j.degToRad(Ln[t]||0);var i=(j.radToDeg(e)%360+360)%360;return j._inRange(i,337.5,360)||j._inRange(i,0,22.5)?"ns-resize":j._inRange(i,22.5,67.5)?"nesw-resize":j._inRange(i,67.5,112.5)?"ew-resize":j._inRange(i,112.5,157.5)?"nwse-resize":j._inRange(i,157.5,202.5)?"ns-resize":j._inRange(i,202.5,247.5)?"nesw-resize":j._inRange(i,247.5,292.5)?"ew-resize":j._inRange(i,292.5,337.5)?"nwse-resize":(j.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}var Mn=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],En=1e8;function On(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function Dn(t,e,i){const n=i.x+(t.x-i.x)*Math.cos(e)-(t.y-i.y)*Math.sin(e),r=i.y+(t.x-i.x)*Math.sin(e)+(t.y-i.y)*Math.cos(e);return Object.assign(Object.assign({},t),{rotation:t.rotation+e,x:n,y:r})}function In(t,e){const i=On(t);return Dn(t,e,i)}function Wn(t,e,i){let n=e;for(let r=0;r<t.length;r++){const a=P["a"].getAngle(t[r]),o=Math.abs(a-e)%(2*Math.PI),s=Math.min(o,2*Math.PI-o);s<i&&(n=a)}return n}class Gn extends ri{constructor(t){super(t),this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(An,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return j.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return Pn+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach(),this._nodes=t,1===t.length&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(t=>{const e=()=>{1===this.nodes().length&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),this._transforming||this.isDragging()||this.update()},i=t._attrsAffectingSize.map(t=>t+"Change."+this._getEventNamespace()).join(" ");t.on(i,e),t.on(Rn.map(t=>t+"."+this._getEventNamespace()).join(" "),e),t.on("absoluteTransformChange."+this._getEventNamespace(),e),this._proxyDrag(t)}),this._resetTransformCache();var e=!!this.findOne(".top-left");return e&&this.update(),this}_proxyDrag(t){let e;t.on("dragstart."+this._getEventNamespace(),i=>{e=t.getAbsolutePosition(),this.isDragging()||t===this.findOne(".back")||this.startDrag(i,!1)}),t.on("dragmove."+this._getEventNamespace(),i=>{if(!e)return;const n=t.getAbsolutePosition(),r=n.x-e.x,a=n.y-e.y;this.nodes().forEach(e=>{if(e===t)return;if(e.isDragging())return;const n=e.getAbsolutePosition();e.setAbsolutePosition({x:n.x+r,y:n.y+a}),e.startDrag(i)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(Cn),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(Cn,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),i){var n=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=t.getAbsoluteScale(i),a=t.getAbsolutePosition(i),o=n.x*r.x-t.offsetX()*r.x,s=n.y*r.y-t.offsetY()*r.y;const h=(P["a"].getAngle(t.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI),c={x:a.x+o*Math.cos(h)+s*Math.sin(-h),y:a.y+s*Math.cos(h)+o*Math.sin(h),width:n.width*r.x,height:n.height*r.y,rotation:h};return Dn(c,-P["a"].getAngle(e),{x:0,y:0})}__getNodeRect(){var t=this.getNode();if(!t)return{x:-En,y:-En,width:0,height:0,rotation:0};const e=[];this.nodes().map(t=>{const i=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var n=[{x:i.x,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x+i.width,y:i.y+i.height},{x:i.x,y:i.y+i.height}],r=t.getAbsoluteTransform();n.forEach((function(t){var i=r.point(t);e.push(i)}))});const i=new A;var n,r,a,o;i.rotate(-P["a"].getAngle(this.rotation())),e.forEach((function(t){var e=i.point(t);void 0===n&&(n=a=e.x,r=o=e.y),n=Math.min(n,e.x),r=Math.min(r,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y)})),i.invert();const s=i.point({x:n,y:r});return{x:s.x,y:s.y,width:a-n,height:o-r,rotation:P["a"].getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Mn.forEach(function(t){this._createAnchor(t)}.bind(this)),this._createAnchor("rotater")}_createAnchor(t){var e=new Wi({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:kn?10:"auto"}),i=this;e.on("mousedown touchstart",(function(t){i._handleMouseDown(t)})),e.on("dragstart",t=>{e.stopDrag(),t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),e.on("mouseenter",()=>{var i=P["a"].getAngle(this.rotation()),n=Tn(t,i);e.getStage().content&&(e.getStage().content.style.cursor=n),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){var t=new Ke({name:"back",width:0,height:0,draggable:!0,sceneFunc(t){var e=this.getParent(),i=e.padding();t.beginPath(),t.rect(-i,-i,this.width()+2*i,this.height()+2*i),t.moveTo(this.width()/2,-i),e.rotateEnabled()&&t.lineTo(this.width()/2,-e.rotateAnchorOffset()*j._sign(this.height())-i),t.fillStrokeShape(this)},hitFunc:(t,e)=>{if(this.shouldOverdrawWholeArea()){var i=this.padding();t.beginPath(),t.rect(-i,-i,e.width()+2*i,e.height()+2*i),t.fillStrokeShape(e)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",t=>{t.cancelBubble=!0}),t.on("dragmove",t=>{t.cancelBubble=!0}),t.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),i=e.width,n=e.height,r=Math.sqrt(Math.pow(i,2)+Math.pow(n,2));this.sin=Math.abs(n/r),this.cos=Math.abs(i/r),"undefined"!==typeof window&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var a=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-a.x,y:o.y-a.y},this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(e=>{e._fire("transformstart",{evt:t.evt,target:e})})}_handleMouseMove(t){var e,i,n,r=this.findOne("."+this._movingAnchorName),a=r.getStage();a.setPointersPositions(t);const o=a.getPointerPosition();let s={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const h=r.getAbsolutePosition();this.anchorDragBoundFunc()&&(s=this.anchorDragBoundFunc()(h,s,t)),r.setAbsolutePosition(s);const c=r.getAbsolutePosition();if(h.x!==c.x||h.y!==c.y)if("rotater"!==this._movingAnchorName){var l=this.keepRatio()||t.shiftKey,d=this.centeredScaling()||t.altKey;if("top-left"===this._movingAnchorName){if(l){var u=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};n=Math.sqrt(Math.pow(u.x-r.x(),2)+Math.pow(u.y-r.y(),2));var f=this.findOne(".top-left").x()>u.x?-1:1,p=this.findOne(".top-left").y()>u.y?-1:1;e=n*this.cos*f,i=n*this.sin*p,this.findOne(".top-left").x(u.x-e),this.findOne(".top-left").y(u.y-i)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(r.y());else if("top-right"===this._movingAnchorName){if(l){u=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};n=Math.sqrt(Math.pow(r.x()-u.x,2)+Math.pow(u.y-r.y(),2));f=this.findOne(".top-right").x()<u.x?-1:1,p=this.findOne(".top-right").y()>u.y?-1:1;e=n*this.cos*f,i=n*this.sin*p,this.findOne(".top-right").x(u.x+e),this.findOne(".top-right").y(u.y-i)}var g=r.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else if("middle-left"===this._movingAnchorName)this.findOne(".top-left").x(r.x());else if("middle-right"===this._movingAnchorName)this.findOne(".bottom-right").x(r.x());else if("bottom-left"===this._movingAnchorName){if(l){u=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};n=Math.sqrt(Math.pow(u.x-r.x(),2)+Math.pow(r.y()-u.y,2));f=u.x<r.x()?-1:1,p=r.y()<u.y?-1:1;e=n*this.cos*f,i=n*this.sin*p,r.x(u.x-e),r.y(u.y+i)}g=r.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)}else if("bottom-center"===this._movingAnchorName)this.findOne(".bottom-right").y(r.y());else if("bottom-right"===this._movingAnchorName){if(l){u=d?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};n=Math.sqrt(Math.pow(r.x()-u.x,2)+Math.pow(r.y()-u.y,2));f=this.findOne(".bottom-right").x()<u.x?-1:1,p=this.findOne(".bottom-right").y()<u.y?-1:1;e=n*this.cos*f,i=n*this.sin*p,this.findOne(".bottom-right").x(u.x+e),this.findOne(".bottom-right").y(u.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));d=this.centeredScaling()||t.altKey;if(d){var y=this.findOne(".top-left"),v=this.findOne(".bottom-right"),x=y.x(),m=y.y(),b=this.getWidth()-v.x(),w=this.getHeight()-v.y();v.move({x:-x,y:-m}),y.move({x:b,y:w})}var _=this.findOne(".top-left").getAbsolutePosition();e=_.x,i=_.y;var S=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),A=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:i,width:S,height:A,rotation:P["a"].getAngle(this.rotation())},t)}else{var C=this._getNodeRect();e=r.x()-C.width/2,i=-r.y()+C.height/2;let n=Math.atan2(-i,e)+Math.PI/2;C.height<0&&(n-=Math.PI);var R=P["a"].getAngle(this.rotation());const a=R+n,o=P["a"].getAngle(this.rotationSnapTolerance()),s=Wn(this.rotationSnaps(),a,o),h=s-C.rotation,c=In(C,h);this._fitNodesInto(c,t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){if(this._transforming){this._transforming=!1,"undefined"!==typeof window&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach(e=>{e._fire("transformend",{evt:t,target:e})}),this._movingAnchorName=null}}_fitNodesInto(t,e){var i=this._getNodeRect();const n=1;if(j._inRange(t.width,2*-this.padding()-n,n))return void this.update();if(j._inRange(t.height,2*-this.padding()-n,n))return void this.update();const r=this.flipEnabled();var a=new A;if(a.rotate(P["a"].getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const e=a.point({x:2*-this.padding(),y:0});if(t.x+=e.x,t.y+=e.y,t.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,!r)return void this.update()}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const e=a.point({x:2*this.padding(),y:0});if(this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.width+=2*this.padding(),!r)return void this.update()}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const e=a.point({x:0,y:2*-this.padding()});if(t.x+=e.x,t.y+=e.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding(),!r)return void this.update()}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const e=a.point({x:0,y:2*this.padding()});if(this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=e.x,this._anchorDragOffset.y-=e.y,t.height+=2*this.padding(),!r)return void this.update()}if(this.boundBoxFunc()){const e=this.boundBoxFunc()(i,t);e?t=e:j.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const o=1e7,s=new A;s.translate(i.x,i.y),s.rotate(i.rotation),s.scale(i.width/o,i.height/o);const h=new A;h.translate(t.x,t.y),h.rotate(t.rotation),h.scale(t.width/o,t.height/o);const c=h.multiply(s.invert());this._nodes.forEach(t=>{var i;const n=t.getParent().getAbsoluteTransform(),r=t.getTransform().copy();r.translate(t.offsetX(),t.offsetY());const a=new A;a.multiply(n.copy().invert()).multiply(c).multiply(n).multiply(r);const o=a.decompose();t.setAttrs(o),this._fire("transform",{evt:e,target:t}),t._fire("transform",{evt:e,target:t}),null===(i=t.getLayer())||void 0===i||i.batchDraw()}),this.rotation(j._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){const i=this.findOne(t);i.setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(j._getRotation(e.rotation));var i=e.width,n=e.height,r=this.enabledAnchors(),a=this.resizeEnabled(),o=this.padding(),s=this.anchorSize();this.find("._anchor").forEach(t=>{t.setAttrs({width:s,height:s,offsetX:s/2,offsetY:s/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:s/2+o,offsetY:s/2+o,visible:a&&r.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:s/2+o,visible:a&&r.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:s/2-o,offsetY:s/2+o,visible:a&&r.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:n/2,offsetX:s/2+o,visible:a&&r.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:n/2,offsetX:s/2-o,visible:a&&r.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:n,offsetX:s/2+o,offsetY:s/2-o,visible:a&&r.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:n,offsetY:s/2-o,visible:a&&r.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:n,offsetX:s/2-o,offsetY:s/2-o,visible:a&&r.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:i/2,y:-this.rotateAnchorOffset()*j._sign(n)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:n,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0}),null===(t=this.getLayer())||void 0===t||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),ri.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return zt.prototype.toObject.call(this)}}function Fn(t){return t instanceof Array||j.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach((function(t){-1===Mn.indexOf(t)&&j.warn("Unknown anchor name: "+t+". Available names are: "+Mn.join(", "))})),t||[]}Gn.prototype.className="Transformer",Object(P["b"])(Gn),et.addGetterSetter(Gn,"enabledAnchors",Mn,Fn),et.addGetterSetter(Gn,"flipEnabled",!0,J()),et.addGetterSetter(Gn,"resizeEnabled",!0),et.addGetterSetter(Gn,"anchorSize",10,U()),et.addGetterSetter(Gn,"rotateEnabled",!0),et.addGetterSetter(Gn,"rotationSnaps",[]),et.addGetterSetter(Gn,"rotateAnchorOffset",50,U()),et.addGetterSetter(Gn,"rotationSnapTolerance",5,U()),et.addGetterSetter(Gn,"borderEnabled",!0),et.addGetterSetter(Gn,"anchorStroke","rgb(0, 161, 255)"),et.addGetterSetter(Gn,"anchorStrokeWidth",1,U()),et.addGetterSetter(Gn,"anchorFill","white"),et.addGetterSetter(Gn,"anchorCornerRadius",0,U()),et.addGetterSetter(Gn,"borderStroke","rgb(0, 161, 255)"),et.addGetterSetter(Gn,"borderStrokeWidth",1,U()),et.addGetterSetter(Gn,"borderDash"),et.addGetterSetter(Gn,"keepRatio",!0),et.addGetterSetter(Gn,"centeredScaling",!1),et.addGetterSetter(Gn,"ignoreStroke",!1),et.addGetterSetter(Gn,"padding",0,U()),et.addGetterSetter(Gn,"node"),et.addGetterSetter(Gn,"nodes"),et.addGetterSetter(Gn,"boundBoxFunc"),et.addGetterSetter(Gn,"anchorDragBoundFunc"),et.addGetterSetter(Gn,"shouldOverdrawWholeArea",!1),et.addGetterSetter(Gn,"useSingleNodeRotation",!0),et.backCompat(Gn,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class Bn extends Ke{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,P["a"].getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return 2*this.radius()}getHeight(){return 2*this.radius()}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}function Hn(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}Bn.prototype.className="Wedge",Bn.prototype._centroid=!0,Bn.prototype._attrsAffectingSize=["radius"],Object(P["b"])(Bn),et.addGetterSetter(Bn,"radius",0,U()),et.addGetterSetter(Bn,"angle",0,U()),et.addGetterSetter(Bn,"clockwise",!1),et.backCompat(Bn,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Nn=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],jn=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function zn(t,e){var i,n,r,a,o,s,h,c,l,d,u,f,p,g,y,v,x,m,b,w,_,S,P,A,C=t.data,R=t.width,L=t.height,k=e+e+1,T=R-1,M=L-1,E=e+1,O=E*(E+1)/2,D=new Hn,I=null,W=D,G=null,F=null,B=Nn[e],H=jn[e];for(r=1;r<k;r++)W=W.next=new Hn,r===E&&(I=W);for(W.next=D,h=s=0,n=0;n<L;n++){for(v=x=m=b=c=l=d=u=0,f=E*(w=C[s]),p=E*(_=C[s+1]),g=E*(S=C[s+2]),y=E*(P=C[s+3]),c+=O*w,l+=O*_,d+=O*S,u+=O*P,W=D,r=0;r<E;r++)W.r=w,W.g=_,W.b=S,W.a=P,W=W.next;for(r=1;r<E;r++)a=s+((T<r?T:r)<<2),c+=(W.r=w=C[a])*(A=E-r),l+=(W.g=_=C[a+1])*A,d+=(W.b=S=C[a+2])*A,u+=(W.a=P=C[a+3])*A,v+=w,x+=_,m+=S,b+=P,W=W.next;for(G=D,F=I,i=0;i<R;i++)C[s+3]=P=u*B>>H,0!==P?(P=255/P,C[s]=(c*B>>H)*P,C[s+1]=(l*B>>H)*P,C[s+2]=(d*B>>H)*P):C[s]=C[s+1]=C[s+2]=0,c-=f,l-=p,d-=g,u-=y,f-=G.r,p-=G.g,g-=G.b,y-=G.a,a=h+((a=i+e+1)<T?a:T)<<2,v+=G.r=C[a],x+=G.g=C[a+1],m+=G.b=C[a+2],b+=G.a=C[a+3],c+=v,l+=x,d+=m,u+=b,G=G.next,f+=w=F.r,p+=_=F.g,g+=S=F.b,y+=P=F.a,v-=w,x-=_,m-=S,b-=P,F=F.next,s+=4;h+=R}for(i=0;i<R;i++){for(x=m=b=v=l=d=u=c=0,s=i<<2,f=E*(w=C[s]),p=E*(_=C[s+1]),g=E*(S=C[s+2]),y=E*(P=C[s+3]),c+=O*w,l+=O*_,d+=O*S,u+=O*P,W=D,r=0;r<E;r++)W.r=w,W.g=_,W.b=S,W.a=P,W=W.next;for(o=R,r=1;r<=e;r++)s=o+i<<2,c+=(W.r=w=C[s])*(A=E-r),l+=(W.g=_=C[s+1])*A,d+=(W.b=S=C[s+2])*A,u+=(W.a=P=C[s+3])*A,v+=w,x+=_,m+=S,b+=P,W=W.next,r<M&&(o+=R);for(s=i,G=D,F=I,n=0;n<L;n++)a=s<<2,C[a+3]=P=u*B>>H,P>0?(P=255/P,C[a]=(c*B>>H)*P,C[a+1]=(l*B>>H)*P,C[a+2]=(d*B>>H)*P):C[a]=C[a+1]=C[a+2]=0,c-=f,l-=p,d-=g,u-=y,f-=G.r,p-=G.g,g-=G.b,y-=G.a,a=i+((a=n+E)<M?a:M)*R<<2,c+=v+=G.r=C[a],l+=x+=G.g=C[a+1],d+=m+=G.b=C[a+2],u+=b+=G.a=C[a+3],G=G.next,f+=w=F.r,p+=_=F.g,g+=S=F.b,y+=P=F.a,v-=w,x-=_,m-=S,b-=P,F=F.next,s+=R}}const Yn=function(t){var e=Math.round(this.blurRadius());e>0&&zn(t,e)};et.addGetterSetter(zt,"blurRadius",0,U(),et.afterSetFilter);const Un=function(t){var e,i=255*this.brightness(),n=t.data,r=n.length;for(e=0;e<r;e+=4)n[e]+=i,n[e+1]+=i,n[e+2]+=i};et.addGetterSetter(zt,"brightness",0,U(),et.afterSetFilter);const Xn=function(t){var e,i=Math.pow((this.contrast()+100)/100,2),n=t.data,r=n.length,a=150,o=150,s=150;for(e=0;e<r;e+=4)a=n[e],o=n[e+1],s=n[e+2],a/=255,a-=.5,a*=i,a+=.5,a*=255,o/=255,o-=.5,o*=i,o+=.5,o*=255,s/=255,s-=.5,s*=i,s+=.5,s*=255,a=a<0?0:a>255?255:a,o=o<0?0:o>255?255:o,s=s<0?0:s>255?255:s,n[e]=a,n[e+1]=o,n[e+2]=s};et.addGetterSetter(zt,"contrast",0,U(),et.afterSetFilter);const qn=function(t){var e=10*this.embossStrength(),i=255*this.embossWhiteLevel(),n=this.embossDirection(),r=this.embossBlend(),a=0,o=0,s=t.data,h=t.width,c=t.height,l=4*h,d=c;switch(n){case"top-left":a=-1,o=-1;break;case"top":a=-1,o=0;break;case"top-right":a=-1,o=1;break;case"right":a=0,o=1;break;case"bottom-right":a=1,o=1;break;case"bottom":a=1,o=0;break;case"bottom-left":a=1,o=-1;break;case"left":a=0,o=-1;break;default:j.error("Unknown emboss direction: "+n)}do{var u=(d-1)*l,f=a;d+f<1&&(f=0),d+f>c&&(f=0);var p=(d-1+f)*h*4,g=h;do{var y=u+4*(g-1),v=o;g+v<1&&(v=0),g+v>h&&(v=0);var x=p+4*(g-1+v),m=s[y]-s[x],b=s[y+1]-s[x+1],w=s[y+2]-s[x+2],_=m,S=_>0?_:-_,P=b>0?b:-b,A=w>0?w:-w;if(P>S&&(_=b),A>S&&(_=w),_*=e,r){var C=s[y]+_,R=s[y+1]+_,L=s[y+2]+_;s[y]=C>255?255:C<0?0:C,s[y+1]=R>255?255:R<0?0:R,s[y+2]=L>255?255:L<0?0:L}else{var k=i-_;k<0?k=0:k>255&&(k=255),s[y]=s[y+1]=s[y+2]=k}}while(--g)}while(--d)};function Vn(t,e,i,n,r){var a,o=i-e,s=r-n;return 0===o?n+s/2:0===s?n:(a=(t-e)/o,a=s*a+n,a)}et.addGetterSetter(zt,"embossStrength",.5,U(),et.afterSetFilter),et.addGetterSetter(zt,"embossWhiteLevel",.5,U(),et.afterSetFilter),et.addGetterSetter(zt,"embossDirection","top-left",null,et.afterSetFilter),et.addGetterSetter(zt,"embossBlend",!1,null,et.afterSetFilter);const Qn=function(t){var e,i,n,r,a=t.data,o=a.length,s=a[0],h=s,c=a[1],l=c,d=a[2],u=d,f=this.enhance();if(0!==f){for(r=0;r<o;r+=4)e=a[r+0],e<s?s=e:e>h&&(h=e),i=a[r+1],i<c?c=i:i>l&&(l=i),n=a[r+2],n<d?d=n:n>u&&(u=n);var p,g,y,v,x,m,b,w,_;for(h===s&&(h=255,s=0),l===c&&(l=255,c=0),u===d&&(u=255,d=0),f>0?(g=h+f*(255-h),y=s-f*(s-0),x=l+f*(255-l),m=c-f*(c-0),w=u+f*(255-u),_=d-f*(d-0)):(p=.5*(h+s),g=h+f*(h-p),y=s+f*(s-p),v=.5*(l+c),x=l+f*(l-v),m=c+f*(c-v),b=.5*(u+d),w=u+f*(u-b),_=d+f*(d-b)),r=0;r<o;r+=4)a[r+0]=Vn(a[r+0],s,h,y,g),a[r+1]=Vn(a[r+1],c,l,m,x),a[r+2]=Vn(a[r+2],d,u,_,w)}};et.addGetterSetter(zt,"enhance",0,U(),et.afterSetFilter);const Kn=function(t){var e,i,n=t.data,r=n.length;for(e=0;e<r;e+=4)i=.34*n[e]+.5*n[e+1]+.16*n[e+2],n[e]=i,n[e+1]=i,n[e+2]=i};et.addGetterSetter(zt,"hue",0,U(),et.afterSetFilter),et.addGetterSetter(zt,"saturation",0,U(),et.afterSetFilter),et.addGetterSetter(zt,"luminance",0,U(),et.afterSetFilter);const Jn=function(t){var e,i,n,r,a,o=t.data,s=o.length,h=1,c=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,d=127*this.luminance(),u=h*c*Math.cos(l*Math.PI/180),f=h*c*Math.sin(l*Math.PI/180),p=.299*h+.701*u+.167*f,g=.587*h-.587*u+.33*f,y=.114*h-.114*u-.497*f,v=.299*h-.299*u-.328*f,x=.587*h+.413*u+.035*f,m=.114*h-.114*u+.293*f,b=.299*h-.3*u+1.25*f,w=.587*h-.586*u-1.05*f,_=.114*h+.886*u-.2*f;for(e=0;e<s;e+=4)i=o[e+0],n=o[e+1],r=o[e+2],a=o[e+3],o[e+0]=p*i+g*n+y*r+d,o[e+1]=v*i+x*n+m*r+d,o[e+2]=b*i+w*n+_*r+d,o[e+3]=a},Zn=function(t){var e,i,n,r,a,o=t.data,s=o.length,h=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,d=h*c*Math.cos(l*Math.PI/180),u=h*c*Math.sin(l*Math.PI/180),f=.299*h+.701*d+.167*u,p=.587*h-.587*d+.33*u,g=.114*h-.114*d-.497*u,y=.299*h-.299*d-.328*u,v=.587*h+.413*d+.035*u,x=.114*h-.114*d+.293*u,m=.299*h-.3*d+1.25*u,b=.587*h-.586*d-1.05*u,w=.114*h+.886*d-.2*u;for(e=0;e<s;e+=4)i=o[e+0],n=o[e+1],r=o[e+2],a=o[e+3],o[e+0]=f*i+p*n+g*r,o[e+1]=y*i+v*n+x*r,o[e+2]=m*i+b*n+w*r,o[e+3]=a};et.addGetterSetter(zt,"hue",0,U(),et.afterSetFilter),et.addGetterSetter(zt,"saturation",0,U(),et.afterSetFilter),et.addGetterSetter(zt,"value",0,U(),et.afterSetFilter);const $n=function(t){var e,i=t.data,n=i.length;for(e=0;e<n;e+=4)i[e]=255-i[e],i[e+1]=255-i[e+1],i[e+2]=255-i[e+2]};var tr=function(t,e,i){var n,r,a,o,s=t.data,h=e.data,c=t.width,l=t.height,d=i.polarCenterX||c/2,u=i.polarCenterY||l/2,f=0,p=0,g=0,y=0,v=Math.sqrt(d*d+u*u);r=c-d,a=l-u,o=Math.sqrt(r*r+a*a),v=o>v?o:v;var x,m,b,w,_=l,S=c,P=360/S*Math.PI/180;for(m=0;m<S;m+=1)for(b=Math.sin(m*P),w=Math.cos(m*P),x=0;x<_;x+=1)r=Math.floor(d+v*x/_*w),a=Math.floor(u+v*x/_*b),n=4*(a*c+r),f=s[n+0],p=s[n+1],g=s[n+2],y=s[n+3],n=4*(m+x*c),h[n+0]=f,h[n+1]=p,h[n+2]=g,h[n+3]=y},er=function(t,e,i){var n,r,a,o,s,h,c=t.data,l=e.data,d=t.width,u=t.height,f=i.polarCenterX||d/2,p=i.polarCenterY||u/2,g=0,y=0,v=0,x=0,m=Math.sqrt(f*f+p*p);r=d-f,a=u-p,h=Math.sqrt(r*r+a*a),m=h>m?h:m;var b,w,_,S,P=u,A=d,C=i.polarRotation||0;for(r=0;r<d;r+=1)for(a=0;a<u;a+=1)o=r-f,s=a-p,b=Math.sqrt(o*o+s*s)*P/m,w=(180*Math.atan2(s,o)/Math.PI+360+C)%360,w=w*A/360,_=Math.floor(w),S=Math.floor(b),n=4*(S*d+_),g=c[n+0],y=c[n+1],v=c[n+2],x=c[n+3],n=4*(a*d+r),l[n+0]=g,l[n+1]=y,l[n+2]=v,l[n+3]=x};const ir=function(t){var e,i,n,r,a,o,s,h,c,l,d=t.width,u=t.height,f=Math.round(this.kaleidoscopePower()),p=Math.round(this.kaleidoscopeAngle()),g=Math.floor(d*(p%360)/360);if(!(f<1)){var y=j.createCanvasElement();y.width=d,y.height=u;var v=y.getContext("2d").getImageData(0,0,d,u);tr(t,v,{polarCenterX:d/2,polarCenterY:u/2});var x=d/Math.pow(2,f);while(x<=8)x*=2,f-=1;x=Math.ceil(x);var m=x,b=0,w=m,_=1;for(g+x>d&&(b=m,w=0,_=-1),i=0;i<u;i+=1)for(e=b;e!==w;e+=_)n=Math.round(e+g)%d,c=4*(d*i+n),a=v.data[c+0],o=v.data[c+1],s=v.data[c+2],h=v.data[c+3],l=4*(d*i+e),v.data[l+0]=a,v.data[l+1]=o,v.data[l+2]=s,v.data[l+3]=h;for(i=0;i<u;i+=1)for(m=Math.floor(x),r=0;r<f;r+=1){for(e=0;e<m+1;e+=1)c=4*(d*i+e),a=v.data[c+0],o=v.data[c+1],s=v.data[c+2],h=v.data[c+3],l=4*(d*i+2*m-e-1),v.data[l+0]=a,v.data[l+1]=o,v.data[l+2]=s,v.data[l+3]=h;m*=2}er(v,t,{polarRotation:0})}};function nr(t,e,i){var n=4*(i*t.width+e),r=[];return r.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),r}function rr(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function ar(t){for(var e=[0,0,0],i=0;i<t.length;i++)e[0]+=t[i][0],e[1]+=t[i][1],e[2]+=t[i][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function or(t,e){var i=nr(t,0,0),n=nr(t,t.width-1,0),r=nr(t,0,t.height-1),a=nr(t,t.width-1,t.height-1),o=e||10;if(rr(i,n)<o&&rr(n,a)<o&&rr(a,r)<o&&rr(r,i)<o){for(var s=ar([n,i,a,r]),h=[],c=0;c<t.width*t.height;c++){var l=rr(s,[t.data[4*c],t.data[4*c+1],t.data[4*c+2]]);h[c]=l<o?0:255}return h}}function sr(t,e){for(var i=0;i<t.width*t.height;i++)t.data[4*i+3]=e[i]}function hr(t,e,i){for(var n=[1,1,1,1,0,1,1,1,1],r=Math.round(Math.sqrt(n.length)),a=Math.floor(r/2),o=[],s=0;s<i;s++)for(var h=0;h<e;h++){for(var c=s*e+h,l=0,d=0;d<r;d++)for(var u=0;u<r;u++){var f=s+d-a,p=h+u-a;if(f>=0&&f<i&&p>=0&&p<e){var g=f*e+p,y=n[d*r+u];l+=t[g]*y}}o[c]=2040===l?255:0}return o}function cr(t,e,i){for(var n=[1,1,1,1,1,1,1,1,1],r=Math.round(Math.sqrt(n.length)),a=Math.floor(r/2),o=[],s=0;s<i;s++)for(var h=0;h<e;h++){for(var c=s*e+h,l=0,d=0;d<r;d++)for(var u=0;u<r;u++){var f=s+d-a,p=h+u-a;if(f>=0&&f<i&&p>=0&&p<e){var g=f*e+p,y=n[d*r+u];l+=t[g]*y}}o[c]=l>=1020?255:0}return o}function lr(t,e,i){for(var n=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],r=Math.round(Math.sqrt(n.length)),a=Math.floor(r/2),o=[],s=0;s<i;s++)for(var h=0;h<e;h++){for(var c=s*e+h,l=0,d=0;d<r;d++)for(var u=0;u<r;u++){var f=s+d-a,p=h+u-a;if(f>=0&&f<i&&p>=0&&p<e){var g=f*e+p,y=n[d*r+u];l+=t[g]*y}}o[c]=l}return o}et.addGetterSetter(zt,"kaleidoscopePower",2,U(),et.afterSetFilter),et.addGetterSetter(zt,"kaleidoscopeAngle",0,U(),et.afterSetFilter);const dr=function(t){var e=this.threshold(),i=or(t,e);return i&&(i=hr(i,t.width,t.height),i=cr(i,t.width,t.height),i=lr(i,t.width,t.height),sr(t,i)),t};et.addGetterSetter(zt,"threshold",0,U(),et.afterSetFilter);const ur=function(t){var e,i=255*this.noise(),n=t.data,r=n.length,a=i/2;for(e=0;e<r;e+=4)n[e+0]+=a-2*a*Math.random(),n[e+1]+=a-2*a*Math.random(),n[e+2]+=a-2*a*Math.random()};et.addGetterSetter(zt,"noise",.2,U(),et.afterSetFilter);const fr=function(t){var e,i,n,r,a,o,s,h,c,l,d,u,f,p,g=Math.ceil(this.pixelSize()),y=t.width,v=t.height,x=Math.ceil(y/g),m=Math.ceil(v/g),b=t.data;if(g<=0)j.error("pixelSize value can not be <= 0");else for(u=0;u<x;u+=1)for(f=0;f<m;f+=1){for(r=0,a=0,o=0,s=0,h=u*g,c=h+g,l=f*g,d=l+g,p=0,e=h;e<c;e+=1)if(!(e>=y))for(i=l;i<d;i+=1)i>=v||(n=4*(y*i+e),r+=b[n+0],a+=b[n+1],o+=b[n+2],s+=b[n+3],p+=1);for(r/=p,a/=p,o/=p,s/=p,e=h;e<c;e+=1)if(!(e>=y))for(i=l;i<d;i+=1)i>=v||(n=4*(y*i+e),b[n+0]=r,b[n+1]=a,b[n+2]=o,b[n+3]=s)}};et.addGetterSetter(zt,"pixelSize",8,U(),et.afterSetFilter);const pr=function(t){var e,i=Math.round(254*this.levels())+1,n=t.data,r=n.length,a=255/i;for(e=0;e<r;e+=1)n[e]=Math.floor(n[e]/a)*a};et.addGetterSetter(zt,"levels",.5,U(),et.afterSetFilter);const gr=function(t){var e,i,n=t.data,r=n.length,a=this.red(),o=this.green(),s=this.blue();for(e=0;e<r;e+=4)i=(.34*n[e]+.5*n[e+1]+.16*n[e+2])/255,n[e]=i*a,n[e+1]=i*o,n[e+2]=i*s,n[e+3]=n[e+3]};et.addGetterSetter(zt,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),et.addGetterSetter(zt,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),et.addGetterSetter(zt,"blue",0,Y,et.afterSetFilter);const yr=function(t){var e,i,n=t.data,r=n.length,a=this.red(),o=this.green(),s=this.blue(),h=this.alpha();for(e=0;e<r;e+=4)i=1-h,n[e]=a*h+n[e]*i,n[e+1]=o*h+n[e+1]*i,n[e+2]=s*h+n[e+2]*i};et.addGetterSetter(zt,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),et.addGetterSetter(zt,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),et.addGetterSetter(zt,"blue",0,Y,et.afterSetFilter),et.addGetterSetter(zt,"alpha",1,(function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t}));const vr=function(t){var e,i,n,r,a=t.data,o=a.length;for(e=0;e<o;e+=4)i=a[e+0],n=a[e+1],r=a[e+2],a[e+0]=Math.min(255,.393*i+.769*n+.189*r),a[e+1]=Math.min(255,.349*i+.686*n+.168*r),a[e+2]=Math.min(255,.272*i+.534*n+.131*r)},xr=function(t){var e=t.data,i=t.width,n=t.height,r=4*i,a=n;do{var o=(a-1)*r,s=i;do{var h=o+4*(s-1),c=e[h],l=e[h+1],d=e[h+2];c>127&&(c=255-c),l>127&&(l=255-l),d>127&&(d=255-d),e[h]=c,e[h+1]=l,e[h+2]=d}while(--s)}while(--a)},mr=function(t){var e,i=255*this.threshold(),n=t.data,r=n.length;for(e=0;e<r;e+=1)n[e]=n[e]<i?0:255};et.addGetterSetter(zt,"threshold",.5,U(),et.afterSetFilter);const br=yi.Util._assign(yi,{Arc:vi,Arrow:_i,Circle:Si,Ellipse:Pi,Image:Ai,Label:Di,Tag:Ii,Line:bi,Path:wi,Rect:Wi,RegularPolygon:Gi,Ring:Bi,Sprite:Hi,Star:Ni,Text:xn,TextPath:Sn,Transformer:Gn,Wedge:Bn,Filters:{Blur:Yn,Brighten:Un,Contrast:Xn,Emboss:qn,Enhance:Qn,Grayscale:Kn,HSL:Jn,HSV:Zn,Invert:$n,Kaleidoscope:ir,Mask:dr,Noise:ur,Pixelate:fr,Posterize:pr,RGB:gr,RGBA:yr,Sepia:vr,Solarize:xr,Threshold:mr}});var wr=br;function _r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sr(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Pr(t,e,i){return e&&Sr(t.prototype,e),i&&Sr(t,i),t}var Ar=800,Cr={roadWidth:40,bicycleLaneWidth:15,greenWidth:10,doubleYellowLineInterval:10,defaultSolidRoadLength:80,defaultRoadLength:2e3,defaultRoadNumber:4,manRadianLength:35,manRoadLength:30,manRoadInterval:16,manRoadLineWidth:1,manCarInterval:4,walkwayWidth:20,dashLength:12,busDashLength:30,tidalDashLength:24,roadPole:130},Rr={},Lr={radian:0,interval:1},kr={doubleYellowLine:"doubleYellowLine",greenArea:"greenArea",singleYellowLine:"singleYellowLine"},Tr={toAngle:function(t){return 180*t/Math.PI},toRadian:function(t){return t*Math.PI/180},pointRotateByPoint:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],n=t.x-i[0],r=t.y-i[1],a=Tr.toAngle(Math.atan(r/n));n<0&&(a+=180);var o=Math.sqrt(n*n+r*r);return{x:Math.cos(Tr.toRadian(a-e))*o+i[0],y:Math.sin(Tr.toRadian(a-e))*o+i[1]}},pointRotateAngel:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],n=t.x,r=t.y,a=Tr.toAngle(Math.atan(r/n));n<0&&(a+=180);var o=Math.sqrt(n*n+r*r);return{x:Math.cos(Tr.toRadian(a-e))*o+i[0],y:Math.sin(Tr.toRadian(a-e))*o+i[1]}},getDistance:function(t,e,i,n){var r=Math.abs(i-t),a=Math.abs(n-e),o=Math.sqrt(Math.pow(r,2)+Math.pow(a,2));return o},twoBezier:function(t,e,i,n){var r=y(e,2),a=r[0],o=r[1],s=y(i,2),h=s[0],c=s[1],l=y(n,2),d=l[0],u=l[1],f=(1-t)*(1-t)*a+2*t*(1-t)*h+t*t*d,p=(1-t)*(1-t)*o+2*t*(1-t)*c+t*t*u;return[f,p]},getArcPoint:function(t,e){var i=20,n=[],r=y(t,2),a=r[0],o=r[1],s=y(e,2),h=s[0],c=s[1];if(a>h){i=-20;var l=[h,c,a,o];a=l[0],o=l[1],h=l[2],c=l[3]}for(var d=a+Math.cos(Tr.toRadian(i+Tr.toAngle(Math.atan((c-o)/(h-a)))))*Math.sqrt((c-o)*(c-o)+(h-a)*(h-a))/2/Math.cos(Tr.toRadian(i)),u=o+Math.sin(Tr.toRadian(i+Tr.toAngle(Math.atan((c-o)/(h-a)))))*Math.sqrt((c-o)*(c-o)+(h-a)*(h-a))/2/Math.cos(Tr.toRadian(i)),f=0;f<1;f+=.01){var p=Tr.twoBezier(f,[a,o],[d,u],[h,c]);n.push(p)}return n},calculateAngle:function(t,e){var i=t-e;return i<0&&(i+=360),i},degreeToAngle:function(t){var e=0;return t>=0&&t<=90?e=90-t:t>90&&t<180?e=360-t+90:t>=180&&t<=270?e=270-t+180:t>270&&t<=360&&(e=360-t+90),e},calculateLeftRightRadian:function(t,e){var i=t-e,n=0;return i<0&&(i+=360),i<=90?n=Tr.toRadian(90-i):i>90&&(n=Tr.toRadian(i-90)),n},getSplitPoint:function(t,e,i){for(var n=[],r=Tr.getDistance(t.x,t.y,e.x,e.y),a=(e.x-t.x)/r*i,o=(e.y-t.y)/r*i,s=Math.ceil(r/i/2),h=0;h<s;h++)n.push([[t.x+2*a*h,t.y+2*o*h],[t.x+a*(2*h+1),t.y+o*(2*h+1)]]);return n}},Mr=function(){function t(e){_r(this,t);var i=Object.assign({entrances:[],origin:[0,0],centerLineMode:!1,drawOption:{},is_have_son:0,baseWidth:800,clientWidth:800,clientHeight:800},e),n=2==i.is_have_son?1.1:.8;for(var r in Cr)Rr[r]=i.baseWidth*n/Ar*Cr[r];i.expandManRadian&&(Rr.manRadianLength=3*Rr.manRadianLength),this.entrances=i.entrances,this.origin=i.origin,this.centerLineMode=i.centerLineMode,this.roadNumber=this.entrances.length,this.drawOption=i.drawOption,this.is_have_son=i.is_have_son,this.baseWidth=i.baseWidth,this.clientWidth=i.clientWidth,this.clientHeight=i.clientHeight,this.roadNumber<2?console.error("路口模型不能小于两个方向。"):this.init()}return Pr(t,[{key:"init",value:function(){var t=this;this.entranceArray=this.entrances.map((function(e,i){return e.roadNumber=t.roadNumber,e.number=i,e.origin=t.origin,e.centerLineMode=t.centerLineMode,e.drawOption=t.drawOption,e.entranceNum=t.entrances.length,e.is_have_son=t.is_have_son,e.baseWidth=t.baseWidth,e.clientWidth=t.clientWidth,e.clientHeight=t.clientHeight,e.secondIn=t.entrances[1].motor_lanes.length,2===t.is_have_son?new Or(e):new Er(e)})),2!=this.is_have_son&&this.entranceArray.map((function(e,i){var n={degreeLeft:i===t.roadNumber-1?t.entranceArray[0].degree:t.entranceArray[i+1].degree,degreeRight:0===i?t.entranceArray[t.roadNumber-1].degree:t.entranceArray[i-1].degree,widthLeft:i===t.roadNumber-1?t.entranceArray[0].rightWidth:t.entranceArray[i+1].rightWidth,widthRight:0===i?t.entranceArray[t.roadNumber-1].leftWidth:t.entranceArray[i-1].leftWidth};e.setLeftAndRight(n)}))}}]),t}(),Er=function(){function t(e){_r(this,t);var i=Object.assign({entranceNum:4,en_id:1,in:2,inBicycleLane:0,out:2,name:"道路",outBicycleLane:0,origin:[0,0],centerLineMode:!0,road_center_mode:kr.singleYellowLine,canalization:0,drawOption:{},motor_lanes:[],degree:0,angle:0,roadNumber:Rr.defaultRoadNumber,number:0,roadLength:Rr.defaultRoadLength,centerToManRoadDistance:0},e);this.entranceNum=i.entranceNum,this.en_id=i.en_id,this.name=i.name,this["in"]=i.motor_lanes.length,this.inBicycleLane=i.inBicycleLane,this.out=i.exit_lanes.length,this.outBicycleLane=i.outBicycleLane,this.origin=i.origin,this.centerLineMode=i.centerLineMode,this.drawOption=i.drawOption,this.road_center_mode=i.road_center_mode,this.canalization=i.canalization,this.motor_lanes=i.motor_lanes,this.degree=i.degree,this.angle=Tr.degreeToAngle(i.degree),this.roadLength=i.roadLength,this.roadNumber=i.roadNumber,this.number=i.number,this.centerToManRoadDistance=i.centerToManRoadDistance,this.calculation("width"),this.point={},this.correctPoint={},this.pointData={},this.lineData={},this.polygonData={}}return Pr(t,[{key:"setLeftAndRight",value:function(t){var e=Object.assign({angleLeft:0,angleRight:0,degreeLeft:0,degreeRight:0,widthLeft:4*Rr.roadWidth,widthRight:4*Rr.roadWidth},t);this.angleLeft=e.angleLeft,this.angleRight=e.angleRight,this.degreeLeft=e.degreeLeft,this.degreeRight=e.degreeRight,this.widthLeft=e.widthLeft,this.widthRight=e.widthRight,this.calculation("point")}},{key:"calculation",value:function(t){var e=this,i=Tr.calculateLeftRightRadian(this.degreeLeft,this.degree),n=Tr.calculateLeftRightRadian(this.degree,this.degreeRight),r=Tr.calculateAngle(this.degreeLeft,this.degree),a=Tr.calculateAngle(this.degree,this.degreeRight),o=0,s=0,h=0,c=0;switch(this.road_center_mode){case kr.doubleYellowLine:c=Rr.doubleYellowLineInterval;break;case kr.greenArea:c=Rr.greenWidth;break;case kr.singleYellowLine:c=0;break}switch(t){case"width":this.leftWidth=this.out*Rr.roadWidth+c/2+this.outBicycleLane*Rr.bicycleLaneWidth,this.rightWidth=this["in"]*Rr.roadWidth+c/2+this.inBicycleLane*Rr.bicycleLaneWidth,this.width=this.leftWidth+this.rightWidth,this.centerLineMode&&(this.leftWidth=this.rightWidth=this.width/2);break;case"point":if(this.point={AL:{x:this.centerLineMode?-this.width/2:-(this.out*Rr.roadWidth+c/2+this.outBicycleLane*Rr.bicycleLaneWidth)},AR:{x:this.centerLineMode?this.width/2:this["in"]*Rr.roadWidth+c/2+this.inBicycleLane*Rr.bicycleLaneWidth}},this.point.AL.y=r<=90?Math.tan(i)*this.point.AL.x-this.widthLeft/Math.cos(i):r>90&&r<180?-Math.tan(i)*this.point.AL.x-this.widthLeft/Math.cos(i):-20,a<=90?this.point.AR.y=-Math.tan(n)*this.point.AR.x-this.widthRight/Math.cos(n):a>90&&a<180&&(this.point.AR.y=Math.tan(n)*this.point.AR.x-this.widthRight/Math.cos(n)),r>=180&&(this.point.AL.y=this.point.AR.y),a>=180&&(this.point.AR.y=this.point.AL.y),2===this.entranceNum&&(this.point.AL.y=2.5*-Rr.roadWidth,this.point.AR.y=2.5*-Rr.roadWidth),this.point.CL={x:this.point.AL.x,y:Math.min(this.point.AL.y,this.point.AR.y)-Rr.defaultRoadLength},this.point.CR={x:this.point.AR.x,y:Math.min(this.point.AL.y,this.point.AR.y)-Rr.defaultRoadLength},this.point.BLO={x:this.point.AL.x,y:0!==this.centerToManRoadDistance?-this.centerToManRoadDistance:this.point.AL.y-(Rr.manRoadLength+Rr.manRadianLength)},this.point.BRO={x:this.point.AR.x,y:0!==this.centerToManRoadDistance?-this.centerToManRoadDistance:this.point.AR.y-(Rr.manRoadLength+Rr.manRadianLength)},this.point.BL={x:this.point.AL.x,y:0!==this.centerToManRoadDistance?-this.centerToManRoadDistance:Math.min(this.point.AL.y,this.point.AR.y)-(Rr.manRoadLength+Rr.manRadianLength)},this.point.BR={x:this.point.AR.x,y:0!==this.centerToManRoadDistance?-this.centerToManRoadDistance:Math.min(this.point.AL.y,this.point.AR.y)-(Rr.manRoadLength+Rr.manRadianLength)},this.point.roadPole={x:this.point.BR.x+Rr.walkwayWidth/2,y:this.point.BR.y-Rr.roadPole},this.point.roadPoleL={x:this.point.BL.x-Rr.walkwayWidth/2,y:this.point.BL.y-Rr.roadPole},this.point.B1L={x:this.point.BL.x-Rr.walkwayWidth,y:this.point.BL.y},this.point.B1R={x:this.point.BR.x+Rr.walkwayWidth,y:this.point.BR.y},this.point.C1L={x:this.point.AL.x-Rr.walkwayWidth,y:Math.min(this.point.AL.y,this.point.AR.y)-Rr.defaultRoadLength},this.point.C1R={x:this.point.AR.x+Rr.walkwayWidth,y:Math.min(this.point.AL.y,this.point.AR.y)-Rr.defaultRoadLength},this.point.roadName={x:this.point.BL.x-Rr.walkwayWidth-12,y:this.point.BL.y},this.road_center_mode===kr.greenArea){this.point.E1={x:this.point.CL.x+this.out*Rr.roadWidth+this.outBicycleLane*Rr.bicycleLaneWidth,y:Math.min(this.point.AL.y,this.point.AR.y)-Rr.defaultRoadLength},this.point.F1={x:this.point.CL.x+this.out*Rr.roadWidth+Rr.greenWidth+this.outBicycleLane*Rr.bicycleLaneWidth,y:Math.min(this.point.AL.y,this.point.AR.y)-Rr.defaultRoadLength},this.point.FToE=[];var l=0,d=this.point.CL.x+this.out*Rr.roadWidth+this.outBicycleLane*Rr.bicycleLaneWidth+Rr.greenWidth/2,u=this.point.BL.y+(this.out*Rr.roadWidth+this.outBicycleLane*Rr.bicycleLaneWidth+Rr.greenWidth/2)/(this.point.BR.x-this.point.BL.x)*(this.point.BR.y-this.point.BL.y)-Rr.greenWidth/2;do{this.point.FToE.push({x:d+Math.cos(Tr.toRadian(l))*Rr.greenWidth/2,y:u+Math.sin(Tr.toRadian(l))*Rr.greenWidth/2}),l+=Lr.interval}while(l<=180)}this.calculation("point2");break;case"point2":this.calculation("BToD"),this.calculation("ALToAR"),this.calculation("pointH"),this.calculation("pointLaneFlow"),this.calculation("pointRoadFlow"),this.calculation("pointWaitArea");var f=function(t){Array.isArray(e.point[t])?(e.correctPoint[t]=[],e.point[t].forEach((function(i,n){Array.isArray(i)?(e.correctPoint[t][n]=[],i.map((function(i){e.correctPoint[t][n].push(Tr.pointRotateAngel(i,-e.angle,e.origin))}))):e.correctPoint[t].push(Tr.pointRotateAngel(i,-e.angle,e.origin))}))):e.correctPoint[t]=Tr.pointRotateAngel(e.point[t],-e.angle,e.origin)};for(var p in this.point)f(p);this.calculation("RoadPolygon"),this.calculation("walkwayPolygonR"),this.calculation("walkwayPolygonL"),this.calculation("manRoadLine"),this.calculation("carRoadLine0"),this.calculation("carRoadLine1"),this.calculation("carRoadLine2"),this.calculation("carRoadLine3"),this.calculation("carRoadLine4"),this.calculation("fdsplitLine"),this.calculation("laneFlowPolygon"),this.calculation("roadFlowPolygon"),this.road_center_mode===kr.greenArea&&this.calculation("greenPolygon");break;case"BToD":var g={x:this.point.AR.x+Math.cos(n)*(Rr.manRoadLength+Rr.manRadianLength),y:this.point.AR.y+Math.sin(n)*(Rr.manRoadLength+Rr.manRadianLength)};a<=90?g={x:this.point.AR.x+Math.cos(n)*(Rr.manRoadLength+Rr.manRadianLength),y:this.point.AR.y-Math.sin(n)*(Rr.manRoadLength+Rr.manRadianLength)}:a>180&&(g={x:this.point.AR.x,y:this.point.AR.y-Math.sin(n)*(Rr.manRoadLength+Rr.manRadianLength)}),this.point.BToDR=[],this.point.B1ToD1R=[];var v=this.point.BR,x=(v.x,v.y),m=g,b=m.x,w=m.y,_=this.point.BR.x,S=_+Math.cos(Tr.toRadian(20+Tr.toAngle(Math.atan((w-x)/(b-_)))))*Math.sqrt((w-x)*(w-x)+(b-_)*(b-_))/2/Math.cos(Tr.toRadian(20)),P=x+Math.sin(Tr.toRadian(20+Tr.toAngle(Math.atan((w-x)/(b-_)))))*Math.sqrt((w-x)*(w-x)+(b-_)*(b-_))/2/Math.cos(Tr.toRadian(20));if(a<180&&2!==this.entranceNum)for(var A=0;A<1;A+=.01){var C=Tr.twoBezier(A,[_,x],[S,P],[b,w]),R=y(C,2),L=R[0],k=R[1];this.point.BToDR.push({x:L,y:k})}else this.point.BToDR=[{x:_,y:x},{x:b,y:w}];if(g={x:g.x+Math.sin(n)*Rr.walkwayWidth,y:g.y-Math.cos(n)*Rr.walkwayWidth},this.point.rightPoint=g,_+=Rr.walkwayWidth,b=g.x,w=g.y,S=_+Math.cos(Tr.toRadian(20+Tr.toAngle(Math.atan((w-x)/(b-_)))))*Math.sqrt((w-x)*(w-x)+(b-_)*(b-_))/2/Math.cos(Tr.toRadian(20)),P=x+Math.sin(Tr.toRadian(20+Tr.toAngle(Math.atan((w-x)/(b-_)))))*Math.sqrt((w-x)*(w-x)+(b-_)*(b-_))/2/Math.cos(Tr.toRadian(20)),this.point.OOO={x:S,y:P},a<180&&2!==this.entranceNum)for(var T=0;T<1;T+=.01){var M=Tr.twoBezier(T,[_,x],[S,P],[b,w]),E=y(M,2),O=E[0],D=E[1];this.point.B1ToD1R.push({x:O,y:D})}else this.point.B1ToD1R=[{x:_,y:x},{x:b,y:w}];break;case"ALToAR":this.point.ALToAR=[],this.point.BLToBR=[],o=this.point.BL.x,h=(this.point.BR.y-this.point.BL.y)/this.width*Rr.manRoadInterval,s=this.point.BL.y;do{this.point.ALToAR.push({x:o,y:s+Rr.manRoadLength}),this.point.BLToBR.push({x:o,y:s}),o+=Rr.manRoadInterval,s+=h}while(o<=this.point.BR.x);break;case"pointH":h=(this.point.BR.y-this.point.BL.y)/(this.point.BR.x-this.point.BL.x)*Rr.roadWidth,this.point.H0=[],this.point.H1=[],this.point.H2=[];for(var I=0;I<this["in"]+this.out+1;I++){switch(this.road_center_mode){case kr.doubleYellowLine:var W=(this.point.BR.y-this.point.BL.y)/(this.point.BR.x-this.point.BL.x)*Rr.doubleYellowLineInterval;o=this.point.BR.x-Rr.roadWidth*I-(I<this["in"]?0:Rr.doubleYellowLineInterval)-this.inBicycleLane*Rr.bicycleLaneWidth,s=this.point.BR.y-Rr.manCarInterval-h*I-(I<this["in"]?0:W)-h*this.inBicycleLane*Rr.bicycleLaneWidth/Rr.roadWidth;break;case kr.greenArea:var G=(this.point.BR.y-this.point.BL.y)/(this.point.BR.x-this.point.BL.x)*Rr.greenWidth;o=this.point.BR.x-Rr.roadWidth*I-(I<this["in"]?0:Rr.greenWidth)-this.inBicycleLane*Rr.bicycleLaneWidth,s=this.point.BR.y-Rr.manCarInterval-h*I-(I<this["in"]?0:G)-h*this.inBicycleLane*Rr.bicycleLaneWidth/Rr.roadWidth;break;case kr.singleYellowLine:o=this.point.BR.x-Rr.roadWidth*I-this.inBicycleLane*Rr.bicycleLaneWidth,s=this.point.BR.y-Rr.manCarInterval-h*I-h*this.inBicycleLane*Rr.bicycleLaneWidth/Rr.roadWidth;break}if(this.point.H0.push({x:o,y:s}),this.point.H1.push({x:o,y:s-Rr.defaultSolidRoadLength}),this.point.H2.push({x:o,y:this.point.CR.y}),(this.road_center_mode===kr.greenArea||this.road_center_mode===kr.doubleYellowLine)&&I===this["in"]-1){switch(this.road_center_mode){case kr.doubleYellowLine:o=this.point.BR.x-Rr.roadWidth*(I+1)-this.inBicycleLane*Rr.bicycleLaneWidth,s=this.point.BR.y-Rr.manCarInterval-h*(I+1)-h*this.inBicycleLane*Rr.bicycleLaneWidth/Rr.roadWidth;break;case kr.greenArea:o=this.point.BR.x-Rr.roadWidth*(I+1)-this.inBicycleLane*Rr.bicycleLaneWidth,s=this.point.BR.y-Rr.manCarInterval-h*(I+1)-h*this.inBicycleLane*Rr.bicycleLaneWidth/Rr.roadWidth;break}this.point.H0.push({x:o,y:s}),this.point.H1.push({x:o,y:s-Rr.defaultSolidRoadLength}),this.point.H2.push({x:o,y:this.point.CR.y})}}break;case"pointLaneFlow":this.point.pointLaneFlow=[],this.motor_lanes.forEach((function(t,i){var n=Dr(t.id,t.lane_flow,Rr,e,null);if(e.point.pointLaneFlow.push(n),t.has_waiting_area&&(1===t.lane_flow||2===t.lane_flow)){var r=Dr(t.id,t.lane_flow,Rr,e,"waitAreaFlow"),a=Dr(t.id,t.lane_flow,Rr,e,"waitArea");e.point.pointLaneFlow.push(r),e.point.pointLaneFlow.push(a)}}));break;case"pointRoadFlow":this.point.pointRoadFlow=[],this.point.pointRoadFlowText=[];for(var F=1;F<=4;F++){var B=Ir(F,Rr,this),H=B.roadFlowPoints,N=B.flowTextPoint;this.point.pointRoadFlow.push(H),this.point.pointRoadFlowText.push(N)}break;case"pointWaitArea":this.point.pointWaitArea=[],this.motor_lanes.forEach((function(t,i){if(t.has_waiting_area&&(1===t.lane_flow||2===t.lane_flow)){var n=Nr(t.id,t.lane_flow,Rr,e);e.point.pointWaitArea.push(n)}}));break;case"RoadPolygon":this.polygonData[t]=[];for(var j=this.correctPoint.BToDR.length-1;j>=0;j--){var z=this.correctPoint.BToDR[j];this.polygonData[t].push([z.x,z.y])}this.polygonData[t].push([this.correctPoint.CR.x,this.correctPoint.CR.y]),this.polygonData[t].push([this.correctPoint.CL.x,this.correctPoint.CL.y]),this.polygonData[t].push([this.correctPoint.BL.x,this.correctPoint.BL.y]);break;case"walkwayPolygonR":this.polygonData[t]=[];for(var Y=this.correctPoint.BToDR.length-1;Y>0;Y--)this.polygonData[t].push([this.correctPoint.BToDR[Y].x,this.correctPoint.BToDR[Y].y]);this.polygonData[t].push([this.correctPoint.CR.x,this.correctPoint.CR.y]),this.polygonData[t].push([this.correctPoint.C1R.x,this.correctPoint.C1R.y]),this.correctPoint.B1ToD1R.map((function(i){e.polygonData[t].push([i.x,i.y])}));break;case"walkwayPolygonL":this.polygonData[t]=[],this.polygonData[t].push([this.correctPoint.B1L.x,this.correctPoint.B1L.y]),this.polygonData[t].push([this.correctPoint.C1L.x,this.correctPoint.C1L.y]),this.polygonData[t].push([this.correctPoint.CL.x,this.correctPoint.CL.y]),this.polygonData[t].push([this.correctPoint.BL.x,this.correctPoint.BL.y]);break;case"greenPolygon":this.polygonData[t]=[],this.correctPoint.FToE.map((function(i){e.polygonData[t].push([i.x,i.y])})),this.polygonData[t].push([this.correctPoint.E1.x,this.correctPoint.E1.y]),this.polygonData[t].push([this.correctPoint.F1.x,this.correctPoint.F1.y]);break;case"manRoadLine":this.lineData[t]=[];for(var U=0,X=this.correctPoint.ALToAR.length;U<X;U++)this.lineData[t].push([[this.correctPoint.ALToAR[U].x,this.correctPoint.ALToAR[U].y],[this.correctPoint.BLToBR[U].x,this.correctPoint.BLToBR[U].y]]);break;case"carRoadLine0":this.lineData[t]=[],this.lineData[t].push([[this.correctPoint.H2[0].x,this.correctPoint.H2[0].y],[this.correctPoint.H0[0].x,this.correctPoint.H0[0].y]]),this.lineData[t].push([[this.correctPoint.H2[this.correctPoint.H2.length-1].x,this.correctPoint.H2[this.correctPoint.H2.length-1].y],[this.correctPoint.H0[this.correctPoint.H2.length-1].x,this.correctPoint.H0[this.correctPoint.H2.length-1].y]]);break;case"carRoadLine1":this.lineData[t]=[];for(var q=0,V=this["in"];q<V;q++)if(q){var Q=this.motor_lanes[this["in"]-q].lane_type,K=this.motor_lanes[this["in"]-(q+1)]?this.motor_lanes[this["in"]-(q+1)].lane_type:0;1===Q||2===Q||1===K||2===K?this.lineData[t].push([[this.correctPoint.H0[q].x,this.correctPoint.H0[q].y],[this.correctPoint.H0[q+1].x,this.correctPoint.H0[q+1].y]]):this.lineData[t].push([[this.correctPoint.H1[q].x,this.correctPoint.H1[q].y],[this.correctPoint.H0[q].x,this.correctPoint.H0[q].y],[this.correctPoint.H0[q+1].x,this.correctPoint.H0[q+1].y],[this.correctPoint.H0[q].x,this.correctPoint.H0[q].y]])}else this.lineData[t].push([[this.correctPoint.H0[q].x,this.correctPoint.H0[q].y],[this.correctPoint.H0[q+1].x,this.correctPoint.H0[q+1].y]]);break;case"carRoadLine2":this.lineData[t]=[];for(var J=1,Z=this.correctPoint.H0.length;J<Z;J++)if(J!==this["in"])if(J<this["in"]+1){var $=this.motor_lanes[this["in"]-J].lane_type,tt=this.motor_lanes[this["in"]-(J+1)]?this.motor_lanes[this["in"]-(J+1)].lane_type:0;if(1===$||2===$||1===tt||2===tt)continue;var et=Tr.getSplitPoint(this.correctPoint.H1[J],this.correctPoint.H2[J],Rr.dashLength);this.lineData[t]=this.lineData[t].concat(et)}else{var it=Tr.getSplitPoint(this.correctPoint.H0[J],this.correctPoint.H2[J],Rr.dashLength);this.lineData[t]=this.lineData[t].concat(it)}break;case"carRoadLine3":switch(this.lineData[t]=[],this.road_center_mode){case kr.greenArea:this.lineData[t].push([[this.correctPoint.H0[this["in"]].x,this.correctPoint.H0[this["in"]].y],[this.correctPoint.H2[this["in"]].x,this.correctPoint.H2[this["in"]].y],[this.correctPoint.H2[this["in"]+1].x,this.correctPoint.H2[this["in"]+1].y],[this.correctPoint.H0[this["in"]+1].x,this.correctPoint.H0[this["in"]+1].y]]);break;case kr.doubleYellowLine:this.lineData[t].push([[this.correctPoint.H0[this["in"]].x,this.correctPoint.H0[this["in"]].y],[this.correctPoint.H2[this["in"]].x,this.correctPoint.H2[this["in"]].y]]),this.lineData[t].push([[this.correctPoint.H0[this["in"]+1].x,this.correctPoint.H0[this["in"]+1].y],[this.correctPoint.H2[this["in"]+1].x,this.correctPoint.H2[this["in"]+1].y]]);break;case kr.singleYellowLine:this.lineData[t].push([[this.correctPoint.H0[this["in"]].x,this.correctPoint.H0[this["in"]].y],[this.correctPoint.H2[this["in"]].x,this.correctPoint.H2[this["in"]].y]]);break}break;case"carRoadLine4":this.lineData[t]=[],this.motor_lanes.forEach((function(i,n){var r=e["in"]-n,a=e["in"]-(n+1);if(1===i.lane_type){var o=Tr.pointRotateAngel({x:e.point.H0[r].x+3,y:e.point.H0[r].y},-e.angle,e.origin),s=Tr.pointRotateAngel({x:e.point.H2[r].x+3,y:e.point.H2[r].y},-e.angle,e.origin),h=Tr.pointRotateAngel({x:e.point.H0[a].x-3,y:e.point.H0[a].y},-e.angle,e.origin),c=Tr.pointRotateAngel({x:e.point.H2[a].x-3,y:e.point.H2[a].y},-e.angle,e.origin),l=Tr.getSplitPoint(e.correctPoint.H0[r],e.correctPoint.H2[r],Rr.tidalDashLength),d=Tr.getSplitPoint(o,s,Rr.tidalDashLength),u=Tr.getSplitPoint(e.correctPoint.H0[a],e.correctPoint.H2[a],Rr.tidalDashLength),f=Tr.getSplitPoint(h,c,Rr.tidalDashLength);e.lineData[t]=e.lineData[t].concat(l).concat(d).concat(u).concat(f)}else if(2===i.lane_type){var p=Tr.getSplitPoint(e.correctPoint.H0[r],e.correctPoint.H2[r],Rr.busDashLength),g=Tr.getSplitPoint(e.correctPoint.H0[a],e.correctPoint.H2[a],Rr.busDashLength);e.lineData[t]=e.lineData[t].concat(p).concat(g)}}));break;case"fdsplitLine":this.lineData[t]=[];var nt=this.motor_lanes.findIndex((function(t){return 4===t.lane_type}));if(nt>-1){var rt=this.correctPoint.H0[this["in"]-nt],at=rt.x,ot=rt.y,st=this.correctPoint.H2[this["in"]-nt],ht=st.x,ct=st.y;this.lineData[t].push([[at,ot],[ht,ct]])}break;case"laneFlowPolygon":this.polygonData[t]=[],this.correctPoint.pointLaneFlow.forEach((function(i,n){e.polygonData[t][n]=[],i.forEach((function(i){e.polygonData[t][n].push([i.x,i.y])}))}));break;case"roadFlowPolygon":this.polygonData[t]=[],this.correctPoint.pointRoadFlow.forEach((function(i,n){e.polygonData[t][n]=[],i.forEach((function(i){e.polygonData[t][n].push([i.x,i.y])}))}));break;default:break}}}]),t}(),Or=function(){function t(e){_r(this,t);var i=Object.assign({en_id:1,in:2,name:"道路",origin:[0,0],degree:0,angle:0,road_center_mode:kr.singleYellowLine,motor_lanes:[],secondIn:3,baseWidth:800,clientWidth:800,clientHeight:800},e);this.en_id=i.en_id,this.name=i.name,this["in"]=i.motor_lanes.length,this.motor_lanes=i.motor_lanes,this.road_center_mode=i.road_center_mode,this.degree=this.getDegreeByEnId(this.en_id),this.angle=Tr.degreeToAngle(this.degree),this.origin=i.origin,this.secondIn=i.secondIn,this.drawOption=i.drawOption,this.baseWidth=i.baseWidth,this.clientWidth=i.baseWidth,this.clientHeight=i.clientHeight,this.point={},this.correctPoint={},this.pointData={},this.lineData={},this.polygonData={},this.calculation("point")}return Pr(t,[{key:"getDegreeByEnId",value:function(t){var e={1:270,2:90,3:75};return e[t]}},{key:"calculation",value:function(t){var e=this,i=0;switch(this.road_center_mode){case kr.doubleYellowLine:i=Rr.doubleYellowLineInterval;break;case kr.greenArea:i=Rr.greenWidth;break;case kr.singleYellowLine:i=0;break}switch(t){case"point":if(1===this.en_id){var n=Rr.roadWidth*this.secondIn+i,r=Rr.roadWidth*(this.secondIn+this["in"])+i,a=this.clientHeight/2;this.point={AL:{x:n,y:a},AR:{x:r,y:a},BL:{x:n,y:-a},BR:{x:r,y:-a}}}else if(2===this.en_id){var o=Rr.roadWidth*this["in"],s=this.clientHeight/2;this.point={AL:{x:-o,y:s},AR:{x:0,y:s},BL:{x:-o,y:-s},BR:{x:0,y:-s}}}else if(3===this.en_id){var h=Rr.roadWidth*this["in"]/2,c=Rr.roadWidth*this["in"]/2/Math.tan(this.angle*Math.PI/180);this.point={AL:{x:-h,y:-c},AR:{x:h,y:-c},BL:{x:-h,y:-c-Rr.defaultRoadLength},BR:{x:h,y:-c-Rr.defaultRoadLength}}}this.point.roadName={x:this.point.AR.x+12,y:this.point.AR.y},this.calculation("point2");break;case"point2":this.calculation("pointH"),this.calculation("pointLaneFlow"),this.calculation("pointRoadFlow");var l=function(t){Array.isArray(e.point[t])?(e.correctPoint[t]=[],e.point[t].forEach((function(i,n){Array.isArray(i)?(e.correctPoint[t][n]=[],i.map((function(i){e.correctPoint[t][n].push(Tr.pointRotateAngel(i,-e.angle,e.origin))}))):e.correctPoint[t].push(Tr.pointRotateAngel(i,-e.angle,e.origin))}))):e.correctPoint[t]=Tr.pointRotateAngel(e.point[t],-e.angle,e.origin)};for(var d in this.point)l(d);this.calculation("RoadPolygon"),this.calculation("carRoadLine0"),this.calculation("carRoadLine1"),this.calculation("carRoadLine2"),this.calculation("carRoadLine3"),this.calculation("laneFlowPolygon"),this.calculation("roadFlowPolygon"),this.calculation("poly"),this.calculation("line");break;case"pointH":var u=0;this.point.H0=[],this.point.H1=[],this.point.H2=[];for(var f=0;f<this["in"]+1;f++)this.point.H0.push({x:this.point.AR.x-f*Rr.roadWidth,y:this.point.AR.y}),this.point.H1.push({x:this.point.BR.x-f*Rr.roadWidth,y:this.point.BR.y}),this.point.H2.push({x:this.point.BR.x-f*Rr.roadWidth,y:this.point.BR.y}),this.road_center_mode!==kr.greenArea&&this.road_center_mode!==kr.doubleYellowLine||f!==this["in"]||1!==this.en_id||(u=this.point.AR.x-f*Rr.roadWidth-i,this.point.AR.y,this.point.H0.push({x:u,y:this.point.AR.y}),this.point.H1.push({x:u,y:this.point.BR.y}),this.point.H2.push({x:u,y:this.point.BR.y}));break;case"pointLaneFlow":this.point.pointLaneFlow=[],this.motor_lanes.forEach((function(t,i){var n=Dr(t.id,t.lane_flow,Rr,e,null);e.point.pointLaneFlow.push(n)}));break;case"pointRoadFlow":this.point.pointRoadFlow=[],this.point.pointRoadFlowText=[];for(var p=1;p<=14;p++){var g=Ir(p,Rr,this),y=g.roadFlowPoints,v=g.flowTextPoint;this.point.pointRoadFlow.push(y),this.point.pointRoadFlowText.push(v)}break;case"RoadPolygon":this.polygonData[t]=[],3===this.en_id?(this.polygonData[t].push([0,6*Rr.roadWidth]),this.polygonData[t].push([this.correctPoint.AR.x,this.correctPoint.AR.y]),this.polygonData[t].push([this.correctPoint.BR.x,this.correctPoint.BR.y]),this.polygonData[t].push([this.correctPoint.BL.x,this.correctPoint.BL.y]),this.polygonData[t].push([this.correctPoint.AL.x,this.correctPoint.AL.y])):(this.polygonData[t].push([this.correctPoint.AL.x,this.correctPoint.AL.y]),this.polygonData[t].push([this.correctPoint.AR.x,this.correctPoint.AR.y]),this.polygonData[t].push([this.correctPoint.BR.x,this.correctPoint.BR.y]),this.polygonData[t].push([this.correctPoint.BL.x,this.correctPoint.BL.y]));case"carRoadLine0":this.lineData[t]=[],1===this.en_id?this.lineData[t].push([[this.correctPoint.H1[0].x,this.correctPoint.H1[0].y],[this.correctPoint.H0[0].x,this.correctPoint.H0[0].y]]):2===this.en_id?(this.lineData[t].push([[this.correctPoint.H0[0].x,this.correctPoint.H0[0].y],[this.correctPoint.H1[0].x,6*Rr.roadWidth]]),this.lineData[t].push([[this.correctPoint.H0[0].x,-Rr.roadWidth],[this.correctPoint.H1[0].x,this.correctPoint.H1[0].y]])):3===this.en_id&&(this.lineData[t].push([[this.correctPoint.H0[this["in"]].x,this.correctPoint.H0[this["in"]].y],[this.correctPoint.H1[this["in"]].x,this.correctPoint.H1[this["in"]].y]]),this.lineData[t].push([[0,6*Rr.roadWidth],[this.correctPoint.H0[0].x,this.correctPoint.H0[0].y]]),this.lineData[t].push([[this.correctPoint.H0[0].x,this.correctPoint.H0[0].y],[this.correctPoint.H1[0].x,this.correctPoint.H1[0].y]]));break;case"carRoadLine1":this.lineData[t]=[],3===this.en_id&&this.lineData[t].push([[this.correctPoint.H0[0].x,this.correctPoint.H0[0].y],[this.correctPoint.H0[this["in"]].x,this.correctPoint.H0[this["in"]].y]]);break;case"carRoadLine2":this.lineData[t]=[];for(var x=1;x<this["in"];x++)this.lineData[t].push([[this.correctPoint.H0[x].x,this.correctPoint.H0[x].y],[this.correctPoint.H1[x].x,this.correctPoint.H1[x].y]]);3===this.en_id&&this.lineData[t].push([[this.correctPoint.H0[this["in"]].x,-Rr.roadWidth],[this.correctPoint.H0[this["in"]].x,6*Rr.roadWidth]]);break;case"carRoadLine3":if(this.lineData[t]=[],1==this.en_id)switch(this.road_center_mode){case kr.greenArea:this.lineData[t].push([[this.correctPoint.H0[this["in"]].x,this.correctPoint.H0[this["in"]].y],[this.correctPoint.H2[this["in"]].x,this.correctPoint.H2[this["in"]].y],[this.correctPoint.H2[this["in"]+1].x,this.correctPoint.H2[this["in"]+1].y],[this.correctPoint.H0[this["in"]+1].x,this.correctPoint.H0[this["in"]+1].y]]);break;case kr.doubleYellowLine:this.lineData[t].push([[this.correctPoint.H0[this["in"]].x,this.correctPoint.H0[this["in"]].y],[this.correctPoint.H2[this["in"]].x,this.correctPoint.H2[this["in"]].y]]),this.lineData[t].push([[this.correctPoint.H0[this["in"]+1].x,this.correctPoint.H0[this["in"]+1].y],[this.correctPoint.H2[this["in"]+1].x,this.correctPoint.H2[this["in"]+1].y]]);break;case kr.singleYellowLine:this.lineData[t].push([[this.correctPoint.H0[this["in"]].x,this.correctPoint.H0[this["in"]].y],[this.correctPoint.H1[this["in"]].x,this.correctPoint.H1[this["in"]].y]]);break}break;case"laneFlowPolygon":this.polygonData[t]=[],this.correctPoint.pointLaneFlow.forEach((function(i,n){e.polygonData[t][n]=[],i.forEach((function(i){e.polygonData[t][n].push([i.x,i.y])}))}));break;case"roadFlowPolygon":this.polygonData[t]=[],this.correctPoint.pointRoadFlow.forEach((function(i,n){e.polygonData[t][n]=[],i.forEach((function(i){e.polygonData[t][n].push([i.x,i.y])}))}));break;case"poly":this.polygonData.walkwayPolygonL=[],this.polygonData.walkwayPolygonR=[];break;case"line":this.lineData.manRoadLine=[];break;case"greenPolygon":this.polygonData.greenPolygon=[];break}}}]),t}();function Dr(t,e,i,n,r){var a=[],o=n.point.H0[n["in"]-t+1],s=o.x,h=o.y,c=n.point.H0[n["in"]-t].y,l=i.roadWidth,d=n.drawOption.laneFlowOffetStopLine*-l,u=(h+c)/2+d-2*l;if(1===e)r&&"waitAreaFlow"===r&&(s-=l/3,u+=2.2*l+i.manRoadLength+i.manCarInterval),a.push({x:s+3*l/4,y:u}),a.push({x:s+3*l/4,y:u+l}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+l/4,y:u+11*l/8}),a.push({x:s+3*l/8,y:u+3*l/2}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+l}),a.push({x:s+3*l/4,y:u});else if(2===e)r&&"waitAreaFlow"===r&&(u+=2.2*l+i.manRoadLength+i.manCarInterval),a.push({x:s+l/2,y:u}),a.push({x:s+l/2,y:u+3*l/2}),a.push({x:s+5*l/8,y:u+11*l/8}),a.push({x:s+3*l/8,y:u+11*l/8}),a.push({x:s+l/2,y:u+3*l/2}),a.push({x:s+l/2,y:u});else if(3===e)a.push({x:s+l/4,y:u}),a.push({x:s+l/4,y:u+l}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+11*l/8}),a.push({x:s+5*l/8,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+l/4,y:u+l}),a.push({x:s+l/4,y:u});else if(4===e);else if(5===e)a.push({x:s+3*l/4,y:u}),a.push({x:s+3*l/4,y:u+l}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+l/4,y:u+11*l/8}),a.push({x:s+3*l/8,y:u+3*l/2}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+l}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+5*l/8,y:u+11*l/8}),a.push({x:s+7*l/8,y:u+11*l/8}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+3*l/4,y:u});else if(6===e)a.push({x:s+l/4,y:u}),a.push({x:s+l/4,y:u+l}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+11*l/8}),a.push({x:s+5*l/8,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+l/4,y:u+l}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+1*l/8,y:u+11*l/8}),a.push({x:s+3*l/8,y:u+11*l/8}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+l/4,y:u});else if(7===e)a.push({x:s+l/2,y:u}),a.push({x:s+l/2,y:u+l}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+l/4,y:u+11*l/8}),a.push({x:s+3*l/8,y:u+3*l/2}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+l/2,y:u+l}),a.push({x:s+l/2,y:u+3*l/2}),a.push({x:s+3*l/8,y:u+11*l/8}),a.push({x:s+5*l/8,y:u+11*l/8}),a.push({x:s+l/2,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+5*l/5,y:u+11*l/8}),a.push({x:s+7*l/8,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+l/2,y:u+l}),a.push({x:s+l/2,y:u});else if(8===e)a.push({x:s+3*l/4,y:u}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+l/4,y:u+l}),a.push({x:s+l/8,y:u+9*l/8}),a.push({x:s+3*l/8,y:u+9*l/8}),a.push({x:s+l/4,y:u+l}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+3*l/2}),a.push({x:s+3*l/4,y:u});else if(9===e)a.push({x:s+3*l/4,y:u}),a.push({x:s+3*l/4,y:u+l}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+l/4,y:u+11*l/8}),a.push({x:s+3*l/8,y:u+3*l/2}),a.push({x:s+l/4,y:u+3*l/2}),a.push({x:s+3*l/4,y:u+l}),a.push({x:s+1*l/4,y:u+l}),a.push({x:s+1*l/4,y:u+1*l/2}),a.push({x:s+1*l/8,y:u+5*l/8}),a.push({x:s+3*l/8,y:u+5*l/8}),a.push({x:s+1*l/4,y:u+1*l/2}),a.push({x:s+1*l/4,y:u+l}),a.push({x:s+3*l/4,y:u+l}),a.push({x:s+3*l/4,y:u});else if(10===e){a.push({x:s+l,y:c}),a.push({x:s,y:h});var f=l/5,p=i.defaultSolidRoadLength;while(p>0)a.push({x:s,y:h-p}),a.push({x:s+f,y:h-p+3}),a.push({x:s,y:h-p}),a.push({x:s,y:Math.min(h-p+f,h)}),p-=f;a.push({x:s+l,y:c});var g=f;while(g<=i.defaultSolidRoadLength)a.push({x:s+l,y:c-g}),a.push({x:s+l-f,y:c-g+f}),a.push({x:s+l,y:c-g}),g+=f}else"variableClick"===e&&a.push({x:s+l/2,y:u});return a}function Ir(t,e,i){var n=[],r={},a=i.point.H0[i["in"]],o=a.x,s=a.y,h=i.point.H0[i["in"]-1].y,c=e.roadWidth,l=-2*c,d=0;1===t?(d+=0,l+=(h-s)/2):2===t?i["in"]>3?(d+=(i.point.H0[0].x-i.point.H0[i["in"]].x-c)/2,l+=(i.point.H0[0].y-i.point.H0[i["in"]].y)/2):(d+=c,l+=(h-s)/2*3):3===t?i["in"]>3?(d+=i.point.H0[0].x-i.point.H0[i["in"]].x-c,l+=i.point.H0[0].y-i.point.H0[i["in"]].y-(h-s)/2):(d+=2*c,l+=(h-s)/2*5):4===t&&(d=0,l+=e.manCarInterval+e.manRoadLength/2+2*c);var u=(h-s)*i["in"],f=c*(i["in"]-1),p=o+d,g=s+l;return 1===t?(n.push({x:p+7*c/8,y:g}),n.push({x:p+7*c/8,y:g+3*c/2}),n.push({x:p+3*c/8,y:g+3*c/2}),n.push({x:p+3*c/8,y:g+13*c/8}),n.push({x:p+1*c/8,y:g+11*c/8}),n.push({x:p+3*c/8,y:g+9*c/8}),n.push({x:p+3*c/8,y:g+5*c/4}),n.push({x:p+5*c/8,y:g+5*c/4}),n.push({x:p+5*c/8,y:g}),r={x:p+3*c/4,y:g-c/2}):2===t?(n.push({x:p+3*c/8,y:g}),n.push({x:p+3*c/8,y:g+5*c/4}),n.push({x:p+c/4,y:g+5*c/4}),n.push({x:p+c/2,y:g+13*c/8}),n.push({x:p+3*c/4,y:g+5*c/4}),n.push({x:p+5*c/8,y:g+5*c/4}),n.push({x:p+5*c/8,y:g}),r={x:p+c/2,y:g-c/2}):3===t?(n.push({x:p+1*c/8,y:g}),n.push({x:p+1*c/8,y:g+3*c/2}),n.push({x:p+5*c/8,y:g+3*c/2}),n.push({x:p+5*c/8,y:g+13*c/8}),n.push({x:p+7*c/8,y:g+11*c/8}),n.push({x:p+5*c/8,y:g+9*c/8}),n.push({x:p+5*c/8,y:g+5*c/4}),n.push({x:p+3*c/8,y:g+5*c/4}),n.push({x:p+3*c/8,y:g}),r={x:p+c/4,y:g-c/2}):4===t&&(n.push({x:p,y:g}),n.push({x:p+2*c/8,y:g-2*c/8}),n.push({x:p+2*c/8,y:g-c/8}),n.push({x:p+6*c/8+f,y:g-c/8+u}),n.push({x:p+6*c/8+f,y:g-2*c/8+u}),n.push({x:p+c+f,y:g+u}),n.push({x:p+6*c/8+f,y:g+2*c/8+u}),n.push({x:p+6*c/8+f,y:g+1*c/8+u}),n.push({x:p+2*c/8,y:g+1*c/8}),n.push({x:p+2*c/8,y:g+2*c/8}),n.push({x:p,y:g})),{roadFlowPoints:n,flowTextPoint:r}}function Wr(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main",r=[],a=i/3+2,o=-t*i+2+1*i/12,s=i/9;return"fd"===n&&(s*=.5,a+=5*s),2===e?a+=s:3===e?a+=2*s:4===e?(o-=3*s/8,a+=s/8):10===e?(o-=3*s/8,a=a+s/8+1.5*s):11===e?(o-=3*s/8,a=a+s/8-1.5*s):12===e?(a+=4.5*s,s=i/20):13===e&&(a+=5*s,s=i/20),1===e?(r.push({x:a+7*s/8,y:o}),r.push({x:a+7*s/8,y:o+10*s/8}),r.push({x:a+2*s/8,y:o+13*s/8}),r.push({x:a+2*s/8,y:o+15*s/8}),r.push({x:a,y:o+12*s/8}),r.push({x:a+2*s/8,y:o+9*s/8}),r.push({x:a+2*s/8,y:o+11*s/8}),r.push({x:a+5*s/8,y:o+9*s/8}),r.push({x:a+5*s/8,y:o})):2===e?(r.push({x:a+3*s/8,y:o}),r.push({x:a+3*s/8,y:o+11*s/8}),r.push({x:a+s/4,y:o+11*s/8}),r.push({x:a+s/2,y:o+15*s/8}),r.push({x:a+3*s/4,y:o+11*s/8}),r.push({x:a+5*s/8,y:o+11*s/8}),r.push({x:a+5*s/8,y:o})):3===e?(r.push({x:a+1*s/8,y:o}),r.push({x:a+1*s/8,y:o+10*s/8}),r.push({x:a+6*s/8,y:o+13*s/8}),r.push({x:a+6*s/8,y:o+15*s/8}),r.push({x:a+s,y:o+12*s/8}),r.push({x:a+6*s/8,y:o+9*s/8}),r.push({x:a+6*s/8,y:o+11*s/8}),r.push({x:a+3*s/8,y:o+9*s/8}),r.push({x:a+3*s/8,y:o})):4===e?(r.push({x:a,y:o}),r.push({x:a+2*s/8,y:o-2*s/8}),r.push({x:a+2*s/8,y:o-s/8}),r.push({x:a+4*s/8+2*s,y:o-s/8}),r.push({x:a+4*s/8+2*s,y:o-2*s/8}),r.push({x:a+6*s/8+2*s,y:o}),r.push({x:a+4*s/8+2*s,y:o+2*s/8}),r.push({x:a+4*s/8+2*s,y:o+1*s/8}),r.push({x:a+2*s/8,y:o+1*s/8}),r.push({x:a+2*s/8,y:o+2*s/8}),r.push({x:a,y:o})):8===e?(r.push({x:a+7*s/8,y:o}),r.push({x:a+7*s/8,y:o+8*s/8}),r.push({x:a+1*s/8,y:o+8*s/8}),r.push({x:a+1*s/8,y:o+4*s/8}),r.push({x:a+0*s/8,y:o+4*s/8}),r.push({x:a+2*s/8,y:o+2*s/8}),r.push({x:a+4*s/8,y:o+4*s/8}),r.push({x:a+3*s/8,y:o+4*s/8}),r.push({x:a+3*s/8,y:o+6*s/8}),r.push({x:a+5*s/8,y:o+6*s/8}),r.push({x:a+5*s/8,y:o})):10===e||11===e?(r.push({x:a,y:o}),r.push({x:a+2*s/8,y:o-2*s/8}),r.push({x:a+2*s/8,y:o-s/8}),r.push({x:a+4*s/8+2*s,y:o-s/8}),r.push({x:a+4*s/8+2*s,y:o-2*s/8}),r.push({x:a+6*s/8+2*s,y:o}),r.push({x:a+4*s/8+2*s,y:o+2*s/8}),r.push({x:a+4*s/8+2*s,y:o+1*s/8}),r.push({x:a+2*s/8,y:o+1*s/8}),r.push({x:a+2*s/8,y:o+2*s/8}),r.push({x:a,y:o})):12===e?(r.push({x:a+7*s/8,y:o}),r.push({x:a+7*s/8,y:o+10*s/8}),r.push({x:a+2*s/8,y:o+13*s/8}),r.push({x:a+2*s/8,y:o+15*s/8}),r.push({x:a,y:o+12*s/8}),r.push({x:a+2*s/8,y:o+9*s/8}),r.push({x:a+2*s/8,y:o+11*s/8}),r.push({x:a+5*s/8,y:o+9*s/8}),r.push({x:a+5*s/8,y:o})):13===e&&(r.push({x:a+3*s/8,y:o}),r.push({x:a+3*s/8,y:o+11*s/8}),r.push({x:a+s/4,y:o+11*s/8}),r.push({x:a+s/2,y:o+15*s/8}),r.push({x:a+3*s/4,y:o+11*s/8}),r.push({x:a+5*s/8,y:o+11*s/8}),r.push({x:a+5*s/8,y:o})),r}function Gr(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main",n=[],r=e.point.H0[e["in"]],a=r.x,o=r.y,s=e.point.H0[e["in"]].y,h=e.point.H0[e["in"]-1].y,c=h-s,l=.75*Rr.roadWidth;if(o+=Rr.manCarInterval+Rr.manRoadLength+.5*l,"fd"===i&&(a+=3*l,l*=.8),1===t)n.push({x:a+7*l/8,y:o}),n.push({x:a+7*l/8,y:o+10*l/8}),n.push({x:a+2*l/8,y:o+13*l/8}),n.push({x:a+2*l/8,y:o+15*l/8}),n.push({x:a,y:o+12*l/8}),n.push({x:a+2*l/8,y:o+9*l/8}),n.push({x:a+2*l/8,y:o+11*l/8}),n.push({x:a+5*l/8,y:o+9*l/8}),n.push({x:a+5*l/8,y:o});else if(2===t)a+=l,o+=c,n.push({x:a+3*l/8,y:o}),n.push({x:a+3*l/8,y:o+11*l/8}),n.push({x:a+l/4,y:o+11*l/8}),n.push({x:a+l/2,y:o+15*l/8}),n.push({x:a+3*l/4,y:o+11*l/8}),n.push({x:a+5*l/8,y:o+11*l/8}),n.push({x:a+5*l/8,y:o});else if(3===t)a+=2*l,o+=2*c,n.push({x:a+1*l/8,y:o}),n.push({x:a+1*l/8,y:o+10*l/8}),n.push({x:a+6*l/8,y:o+13*l/8}),n.push({x:a+6*l/8,y:o+15*l/8}),n.push({x:a+l,y:o+12*l/8}),n.push({x:a+6*l/8,y:o+9*l/8}),n.push({x:a+6*l/8,y:o+11*l/8}),n.push({x:a+3*l/8,y:o+9*l/8}),n.push({x:a+3*l/8,y:o});else if(4===t||10===t){var d=l;l*=.5;var u=e.point.H0[e["in"]].y,f=e.point.H0[e["in"]-1].y;a+=1.5*l;var p=3*(f-u);o+=2*c-.5*l,n.push({x:a,y:o}),n.push({x:a+2*l/8,y:o-2*l/8}),n.push({x:a+2*l/8,y:o-l/8}),n.push({x:a+6*l/8+d,y:o-l/8+p}),n.push({x:a+6*l/8+d,y:o-2*l/8+p}),n.push({x:a+l+d,y:o+p}),n.push({x:a+6*l/8+d,y:o+2*l/8+p}),n.push({x:a+6*l/8+d,y:o+1*l/8+p}),n.push({x:a+2*l/8,y:o+1*l/8}),n.push({x:a+2*l/8,y:o+2*l/8}),n.push({x:a,y:o})}else if(8===t)n.push({x:a+7*l/8,y:o}),n.push({x:a+7*l/8,y:o+8*l/8}),n.push({x:a+1*l/8,y:o+8*l/8}),n.push({x:a+1*l/8,y:o+4*l/8}),n.push({x:a+0*l/8,y:o+4*l/8}),n.push({x:a+2*l/8,y:o+2*l/8}),n.push({x:a+4*l/8,y:o+4*l/8}),n.push({x:a+3*l/8,y:o+4*l/8}),n.push({x:a+3*l/8,y:o+6*l/8}),n.push({x:a+5*l/8,y:o+6*l/8}),n.push({x:a+5*l/8,y:o});else if(11===t){var g=-l;l*=.5,a-=1.5*l;var y=e.point.H0[e["in"]].y,v=e.point.H0[e["in"]-1].y,x=3*(y-v);o-=.2*l,n.push({x:a,y:o}),n.push({x:a-2*l/8,y:o-2*l/8}),n.push({x:a-2*l/8,y:o-l/8}),n.push({x:a-6*l/8+g,y:o-l/8+x}),n.push({x:a-6*l/8+g,y:o-2*l/8+x}),n.push({x:a-l+g,y:o+x}),n.push({x:a-6*l/8+g,y:o+2*l/8+x}),n.push({x:a-6*l/8+g,y:o+1*l/8+x}),n.push({x:a-2*l/8,y:o+1*l/8}),n.push({x:a-2*l/8,y:o+2*l/8}),n.push({x:a,y:o})}else if(12===t){a+=5.5*l;var m=l/2;n.push({x:a+7*m/8,y:o}),n.push({x:a+7*m/8,y:o+3*m/2}),n.push({x:a+3*m/8,y:o+3*m/2}),n.push({x:a+3*m/8,y:o+13*m/8}),n.push({x:a+1*m/8,y:o+11*m/8}),n.push({x:a+3*m/8,y:o+9*m/8}),n.push({x:a+3*m/8,y:o+5*m/4}),n.push({x:a+5*m/8,y:o+5*m/4}),n.push({x:a+5*m/8,y:o})}else if(13===t){var b=l/2;a+=5.5*l+b,n.push({x:a+3*b/8,y:o}),n.push({x:a+3*b/8,y:o+5*b/4}),n.push({x:a+b/4,y:o+5*b/4}),n.push({x:a+b/2,y:o+13*b/8}),n.push({x:a+3*b/4,y:o+5*b/4}),n.push({x:a+5*b/8,y:o+5*b/4}),n.push({x:a+5*b/8,y:o})}return n}function Fr(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"main",a="fd"===r?.8*e:e,o=[],s=y(t,2),h=s[0],c=s[1];if(1===i)o.push({x:h+7*a/8,y:c}),o.push({x:h+7*a/8,y:c+3*a/2}),o.push({x:h+3*a/8,y:c+3*a/2}),o.push({x:h+3*a/8,y:c+13*a/8}),o.push({x:h+1*a/8,y:c+11*a/8}),o.push({x:h+3*a/8,y:c+9*a/8}),o.push({x:h+3*a/8,y:c+5*a/4}),o.push({x:h+5*a/8,y:c+5*a/4}),o.push({x:h+5*a/8,y:c});else if(2===i)o.push({x:h+3*a/8,y:c}),o.push({x:h+3*a/8,y:c+5*a/4}),o.push({x:h+a/4,y:c+5*a/4}),o.push({x:h+a/2,y:c+13*a/8}),o.push({x:h+3*a/4,y:c+5*a/4}),o.push({x:h+5*a/8,y:c+5*a/4}),o.push({x:h+5*a/8,y:c});else if(3===i)o.push({x:h+1*a/8,y:c}),o.push({x:h+1*a/8,y:c+3*a/2}),o.push({x:h+5*a/8,y:c+3*a/2}),o.push({x:h+5*a/8,y:c+13*a/8}),o.push({x:h+7*a/8,y:c+11*a/8}),o.push({x:h+5*a/8,y:c+9*a/8}),o.push({x:h+5*a/8,y:c+5*a/4}),o.push({x:h+3*a/8,y:c+5*a/4}),o.push({x:h+3*a/8,y:c});else if(4===i||10===i){var l=a*(n["in"]-1),d=n.point.H0[n["in"]].y,u=n.point.H0[n["in"]-1].y,f=(u-d)*n["in"];o.push({x:h,y:c}),o.push({x:h+2*a/8,y:c-2*a/8}),o.push({x:h+2*a/8,y:c-a/8}),o.push({x:h+6*a/8+l,y:c-a/8+f}),o.push({x:h+6*a/8+l,y:c-2*a/8+f}),o.push({x:h+a+l,y:c+f}),o.push({x:h+6*a/8+l,y:c+2*a/8+f}),o.push({x:h+6*a/8+l,y:c+1*a/8+f}),o.push({x:h+2*a/8,y:c+1*a/8}),o.push({x:h+2*a/8,y:c+2*a/8}),o.push({x:h,y:c})}else if(5===i)o.push({x:h+7*a/8,y:c}),o.push({x:h+7*a/8,y:c+11*a/8}),o.push({x:h+8*a/8,y:c+11*a/8}),o.push({x:h+6*a/8,y:c+13*a/8}),o.push({x:h+4*a/8,y:c+11*a/8}),o.push({x:h+5*a/8,y:c+11*a/8}),o.push({x:h+5*a/8,y:c+9*a/8}),o.push({x:h+3*a/8,y:c+9*a/8}),o.push({x:h+3*a/8,y:c+10*a/8}),o.push({x:h+1*a/8,y:c+8*a/8}),o.push({x:h+3*a/8,y:c+6*a/8}),o.push({x:h+3*a/8,y:c+7*a/8}),o.push({x:h+5*a/8,y:c+7*a/8}),o.push({x:h+5*a/8,y:c});else if(6===i)o.push({x:h+1*a/8,y:c}),o.push({x:h+1*a/8,y:c+11*a/8}),o.push({x:h+0*a/8,y:c+11*a/8}),o.push({x:h+2*a/8,y:c+13*a/8}),o.push({x:h+4*a/8,y:c+11*a/8}),o.push({x:h+3*a/8,y:c+11*a/8}),o.push({x:h+3*a/8,y:c+9*a/8}),o.push({x:h+5*a/8,y:c+9*a/8}),o.push({x:h+5*a/8,y:c+10*a/8}),o.push({x:h+7*a/8,y:c+8*a/8}),o.push({x:h+5*a/8,y:c+6*a/8}),o.push({x:h+5*a/8,y:c+7*a/8}),o.push({x:h+3*a/8,y:c+7*a/8}),o.push({x:h+3*a/8,y:c});else if(7===i)o.push({x:h+5*a/8,y:c}),o.push({x:h+5*a/8,y:c+7*a/8}),o.push({x:h+6*a/8,y:c+7*a/8}),o.push({x:h+6*a/8,y:c+6*a/8}),o.push({x:h+8*a/8,y:c+8*a/8}),o.push({x:h+6*a/8,y:c+10*a/8}),o.push({x:h+6*a/8,y:c+9*a/8}),o.push({x:h+5*a/8,y:c+9*a/8}),o.push({x:h+5*a/8,y:c+11*a/8}),o.push({x:h+6*a/8,y:c+11*a/8}),o.push({x:h+4*a/8,y:c+13*a/8}),o.push({x:h+2*a/8,y:c+11*a/8}),o.push({x:h+3*a/8,y:c+11*a/8}),o.push({x:h+3*a/8,y:c+9*a/8}),o.push({x:h+2*a/8,y:c+9*a/8}),o.push({x:h+2*a/8,y:c+10*a/8}),o.push({x:h+0*a/8,y:c+8*a/8}),o.push({x:h+2*a/8,y:c+6*a/8}),o.push({x:h+2*a/8,y:c+7*a/8}),o.push({x:h+3*a/8,y:c+7*a/8}),o.push({x:h+3*a/8,y:c});else if(8===i)o.push({x:h+7*a/8,y:c}),o.push({x:h+7*a/8,y:c+13*a/8}),o.push({x:h+1*a/8,y:c+13*a/8}),o.push({x:h+1*a/8,y:c+8*a/8}),o.push({x:h+0*a/8,y:c+8*a/8}),o.push({x:h+2*a/8,y:c+6*a/8}),o.push({x:h+4*a/8,y:c+8*a/8}),o.push({x:h+3*a/8,y:c+8*a/8}),o.push({x:h+3*a/8,y:c+11*a/8}),o.push({x:h+5*a/8,y:c+11*a/8}),o.push({x:h+5*a/8,y:c});else if(9===i)o.push({x:h+7*a/8,y:c}),o.push({x:h+7*a/8,y:c+12*a/8}),o.push({x:h+3*a/8,y:c+12*a/8}),o.push({x:h+3*a/8,y:c+13*a/8}),o.push({x:h+0*a/8,y:c+11*a/8}),o.push({x:h+3*a/8,y:c+9*a/8}),o.push({x:h+3*a/8,y:c+10*a/8}),o.push({x:h+5*a/8,y:c+10*a/8}),o.push({x:h+5*a/8,y:c+8*a/8}),o.push({x:h+1*a/8,y:c+8*a/8}),o.push({x:h+1*a/8,y:c+4*a/8}),o.push({x:h+0*a/8,y:c+4*a/8}),o.push({x:h+2*a/8,y:c+2*a/8}),o.push({x:h+4*a/8,y:c+4*a/8}),o.push({x:h+3*a/8,y:c+4*a/8}),o.push({x:h+3*a/8,y:c+6*a/8}),o.push({x:h+5*a/8,y:c+6*a/8}),o.push({x:h+5*a/8,y:c});else if(10===i);else if(11===i){var p=-a*(n.out-1),g=n.point.H0[n["in"]].y,v=n.point.H0[n["in"]-1].y,x=(g-v)*n.out;o.push({x:h,y:c}),o.push({x:h-2*a/8,y:c-2*a/8}),o.push({x:h-2*a/8,y:c-a/8}),o.push({x:h-6*a/8+p,y:c-a/8+x}),o.push({x:h-6*a/8+p,y:c-2*a/8+x}),o.push({x:h-a+p,y:c+x}),o.push({x:h-6*a/8+p,y:c+2*a/8+x}),o.push({x:h-6*a/8+p,y:c+1*a/8+x}),o.push({x:h-2*a/8,y:c+1*a/8}),o.push({x:h-2*a/8,y:c+2*a/8}),o.push({x:h,y:c})}else if(12===i){var m=.6*a;o.push({x:h+7*m/8,y:c}),o.push({x:h+7*m/8,y:c+3*m/2}),o.push({x:h+3*m/8,y:c+3*m/2}),o.push({x:h+3*m/8,y:c+13*m/8}),o.push({x:h+1*m/8,y:c+11*m/8}),o.push({x:h+3*m/8,y:c+9*m/8}),o.push({x:h+3*m/8,y:c+5*m/4}),o.push({x:h+5*m/8,y:c+5*m/4}),o.push({x:h+5*m/8,y:c})}else if(13===i){var b=.6*a;o.push({x:h+3*b/8,y:c}),o.push({x:h+3*b/8,y:c+5*b/4}),o.push({x:h+b/4,y:c+5*b/4}),o.push({x:h+b/2,y:c+13*b/8}),o.push({x:h+3*b/4,y:c+5*b/4}),o.push({x:h+5*b/8,y:c+5*b/4}),o.push({x:h+5*b/8,y:c})}else if(14===i){var w=.6*a;o.push({x:h+7*w/8,y:c}),o.push({x:h+7*w/8,y:c+11*w/8}),o.push({x:h+8*w/8,y:c+11*w/8}),o.push({x:h+6*w/8,y:c+13*w/8}),o.push({x:h+4*w/8,y:c+11*w/8}),o.push({x:h+5*w/8,y:c+11*w/8}),o.push({x:h+5*w/8,y:c+9*w/8}),o.push({x:h+3*w/8,y:c+9*w/8}),o.push({x:h+3*w/8,y:c+10*w/8}),o.push({x:h+1*w/8,y:c+8*w/8}),o.push({x:h+3*w/8,y:c+6*w/8}),o.push({x:h+3*w/8,y:c+7*w/8}),o.push({x:h+5*w/8,y:c+7*w/8}),o.push({x:h+5*w/8,y:c})}return o}function Br(t,e){var i=Rr.roadWidth,n=t.x,r=t.y,a=[];return"green"===e?(a.push({x:n,y:r-i/4}),a.push({x:n-3*i/64,y:r+i/4-i/64}),a.push({x:n-i/32,y:r+6*i/32}),a.push({x:n-i/64,y:r+6*i/32}),a.push({x:n-i/64,y:r+11*i/64}),a.push({x:n-3*i/64,y:r+10*i/64}),a.push({x:n-3*i/32,y:r+5*i/64}),a.push({x:n-11*i/64,y:r+i/32}),a.push({x:n-9*i/64,y:r+i/64}),a.push({x:n-i/16,y:r+i/16}),a.push({x:n-3*i/64,y:r+3*i/32}),a.push({x:n-i/64,y:r}),a.push({x:n-15*i/128,y:r-17*i/128}),a.push({x:n-9*i/64,y:r-17*i/128}),a.push({x:n-5*i/32,y:r-19*i/128}),a.push({x:n-7*i/64,y:r-11*i/64}),a.push({x:n+i/64,y:r-3*i/64}),a.push({x:n+7*i/64,y:r-9*i/64}),a.push({x:n+3*i/32,y:r-11*i/64}),a.push({x:n+7*i/64,y:r-6*i/32}),a.push({x:n+5*i/32,y:r-5*i/32}),a.push({x:n+7*i/128,y:r+i/128}),a.push({x:n+7*i/128,y:r+7*i/64}),a.push({x:n+3*i/32,y:r+2*i/32}),a.push({x:n+7*i/64,y:r-i/64}),a.push({x:n+9*i/64,y:r}),a.push({x:n+4*i/32,y:r+3*i/32}),a.push({x:n+2*i/32,y:r+5*i/32}),a.push({x:n+i/64,y:r+11*i/64}),a.push({x:n+i/64,y:r+i/4-i/64}),a.push({x:n,y:r-i/4})):"red"===e&&(a.push({x:n-i/32,y:r+i/4-i/32}),a.push({x:n-i/32+i/32/4,y:r+7*i/32-3*i/64}),a.push({x:n-5*i/64,y:r+i/4-3*i/32}),a.push({x:n-7*i/64,y:r+i/4-3*i/32}),a.push({x:n-3*i/32-i/32/4,y:r-i/64}),a.push({x:n-5*i/64,y:r-i/32}),a.push({x:n-5*i/64,y:r+2*i/32}),a.push({x:n-2*i/32,y:r+4*i/32}),a.push({x:n-i/32-i/64,y:r+i/64}),a.push({x:n-5*i/64-i/64,y:r-6*i/32}),a.push({x:n-7*i/64+4*i/64,y:r-7*i/32}),a.push({x:n,y:r-i/32}),a.push({x:n+7*i/64-4*i/64,y:r-7*i/32}),a.push({x:n+7*i/64,y:r-7*i/32}),a.push({x:n+i/32+i/64,y:r-i/64}),a.push({x:n+2*i/32,y:r+4*i/32}),a.push({x:n+5*i/64,y:r+2*i/32}),a.push({x:n+3*i/32+i/32/4,y:r-i/64}),a.push({x:n+7*i/64,y:r+i/4-11*i/64}),a.push({x:n+5*i/64,y:r+i/4-3*i/32}),a.push({x:n+i/32-i/32/4,y:r+7*i/32-3*i/64}),a.push({x:n+i/32,y:r+i/4-i/32})),a}function Hr(t,e){var i=Rr.roadWidth,n=t.x,r=t.y;r-=i/3;var a=[];return"left"===e?(n+=i/3,a.push({x:n-i/3/5,y:r+i/3}),a.push({x:n-i/3+i/3/6+i/3/15,y:r+2*i/3/5-i/3/10}),a.push({x:n-i/3-i/3/5+i/3/15,y:r+2*i/3/5-i/3/10}),a.push({x:n-4*i/3/5+i/3/15,y:r+i/3-i/3/6}),a.push({x:n-8*i/3/5,y:r+i/3-i/3/6}),a.push({x:n-8*i/3/5,y:r+i/3+i/3/6}),a.push({x:n-4*i/3/5+i/3/15,y:r+i/3+i/3/6}),a.push({x:n-i/3-i/3/5+i/3/15,y:r+8*i/3/5+i/3/10}),a.push({x:n-i/3+i/3/6+i/3/15,y:r+8*i/3/5+i/3/10}),a.push({x:n-i/3/5,y:r+i/3})):"right"===e&&(n-=i/3,a.push({y:r+i/3,x:n+i/3/5}),a.push({y:r+2*i/3/5-i/3/10,x:n+i/3-i/3/6-i/3/15}),a.push({y:r+2*i/3/5-i/3/10,x:n+i/3+i/3/5-i/3/15}),a.push({y:r+i/3-i/3/6,x:n+4*i/3/5-i/3/15}),a.push({y:r+i/3-i/3/6,x:n+8*i/3/5}),a.push({y:r+i/3+i/3/6,x:n+8*i/3/5}),a.push({y:r+i/3+i/3/6,x:n+4*i/3/5-i/3/15}),a.push({y:r+8*i/3/5+i/3/10,x:n+i/3+i/3/5-i/3/15}),a.push({y:r+8*i/3/5+i/3/10,x:n+i/3-i/3/6-i/3/15}),a.push({y:r+i/3,x:n+i/3/5})),a}function Nr(t,e,i,n){var r=[],a=n.point.H0[n["in"]-t+1],o=a.x,s=a.y,h=n.point.H0[n["in"]-t],c=h.x,l=h.y,d=i.roadWidth,u=i.manRoadLength+i.manCarInterval;return 1===e?(r.push({x:o,y:s+u}),r.push({x:o-d/16,y:s+u+5*d/8}),r.push({x:o-3*d/16,y:s+u+9*d/8}),r.push({x:o-6*d/16,y:s+u+13*d/8}),r.push({x:o-9*d/16,y:s+u+15*d/8}),r.push({x:o-12*d/16,y:s+u+16*d/8}),r.push({x:c-15*d/16,y:l+u+18*d/8}),r.push({x:c-12*d/16,y:l+u+16*d/8}),r.push({x:c-9*d/16,y:l+u+15*d/8}),r.push({x:c-6*d/16,y:l+u+13*d/8}),r.push({x:c-3*d/16,y:l+u+9*d/8}),r.push({x:c,y:l+u})):2===e&&(r.push({x:o,y:s+u}),r.push({x:o,y:s+u+2*d}),r.push({x:c,y:l+u+2*d}),r.push({x:c,y:l+u})),r}i("4ec9");var jr=new Map;jr.set(1,"A"),jr.set(2,"B"),jr.set(3,"C"),jr.set(4,"D"),jr.set(5,"E"),jr.set(6,"F"),jr.set(7,"G"),jr.set(8,"H"),jr.set(9,"I"),jr.set(10,"J"),jr.set(11,"K"),jr.set(12,"L"),jr.set(13,"M"),jr.set(14,"N"),jr.set(15,"O"),jr.set(16,"P"),jr.set(17,"Q"),jr.set(18,"R"),jr.set(19,"S"),jr.set(20,"T"),jr.set(21,"U"),jr.set(22,"V"),jr.set(23,"W"),jr.set(24,"X"),jr.set(25,"Y"),jr.set(26,"Z"),jr.set(27,"a"),jr.set(28,"b"),jr.set(29,"c"),jr.set(30,"d"),jr.set(31,"e"),jr.set(32,"f");var zr=new Map;zr.set(1,"左转"),zr.set(2,"直行"),zr.set(3,"右转"),zr.set(4,"人行"),zr.set(5,"左直"),zr.set(6,"直右"),zr.set(7,"通行"),zr.set(8,"掉头"),zr.set(9,"左掉头"),zr.set(10,"人行1"),zr.set(11,"人行2"),zr.set(12,"非机动车左"),zr.set(13,"非机动车直"),zr.set(14,"非机动车左直"),zr.set(32,"可变车道");var Yr=new Map;Yr.set(1,"东"),Yr.set(2,"南"),Yr.set(3,"西"),Yr.set(4,"北"),Yr.set(5,"方向1"),Yr.set(6,"方向2"),Yr.set(7,"方向3"),Yr.set(8,"方向4"),Yr.set(9,"方向5"),Yr.set(10,"方向6");var Ur="data:img/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAAlCAYAAADFniADAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADJmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMwNjcgNzkuMTU3NzQ3LCAyMDE1LzAzLzMwLTIzOjQwOjQyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjFFM0Y5QTYyNTkzMTFFN0EwNkVBMTUzMDlERkJGOUMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjFFM0Y5QTcyNTkzMTFFN0EwNkVBMTUzMDlERkJGOUMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMUUzRjlBNDI1OTMxMUU3QTA2RUExNTMwOURGQkY5QyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMUUzRjlBNTI1OTMxMUU3QTA2RUExNTMwOURGQkY5QyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PphkrBIAAAQ3SURBVFhH1ZjbaxxlGId3mt3ZndnZzaYm64GI0juhtLUFoQ29KBVRkFKpTTStVqoUWw+FllJavWih9KK3/QMqNkUIVsQ7ofSm1BrUoFRFQYQeTMxGm7iZTbqbPfj7zb4ZsnPIzG6zgT7wZvZ7Z+ebZ97v229movTcnoo0Q+7JjIJNHKEiYogoYhWC+Rqiiigj5hElRDF7Z5r50ISWggxPbiA0BAXCQqE5hAk5ygYSKAWZDmzSCMo8KJTLQ65Sb3rDsvsCIYpkEcshRKz+pF9ffKVwYCc2XYhmhioM7K8L/bP6nnhK4YAMNsl6q20Ych4XLimpkF5vtR3dq2INUvgCx7rdFXLCijXMMVsKO/gr8yznCpCR81ssrhTLuNyTOiw8rz2MlhQsuTAu18++VTTxsCvFlXpJTk7N9e77p/CMNJum7++ZXexDmn5YHkqtVmPpHuNnJrw4NjX71JBZGsb9Qn9ei70+1J38WXaFYuN4/q275eoZTJq/3jDiu891abdllxPeNydYKd5cfYUO35t9GkKf477QiyNWX5mbHx6cLKyT3YFsHMu/QyF8VNjHRbN4mX3W97qwfPiHd3tP3rs3u2a4YAk9ISleSufV+/PDuyfNDZLyZcNY/sDdSvU0PtoXzb7YJ/uWlBOVw/cIPrBaDfxQKqsvT5jXeHWSagBXM7MlHt37Rdb4XlINrB/LHxqvVD+Spou4onx7p7dzlzQXU2SlrBnvZJMaLa1TO07gEouSagAVS10vlodeyZnPScpm7Vj+w6WEYkrkz7cN9X1pOolSiuHJ14+mrj6rduyHGB85XGDip74pli/tyJmbJUWhI7lK9bg0XUDoj4OpxKunMtq4pJwoHD57vvjx0oS5dbRUvgAJz7WM0qjsvluVSt9kpXZY0i4g9PuRdGLgaDoxKSlPKPU4t/WmP6zGSLF80U8M8KnScyoQVYn8djyt9X+Qjv8rKT+qHDquDYF8lTVubI5H98DelJSTpYR+CSlEapQK9dxMvswaI30Qw0EzkgoEQjc/7tQGQgqRMqX41hEaLgF9iehgGDEI/Xg2o/e/m4o388o0Tym+BjXF5R5jdFsiNoCD/5OUCwiNnuvSX3vTUPOSCkuJUlyH+BrUFJ/1JH/arlliripgYfwOQoODSTX0MAuc38VV8qLouQ4Fcak7efMFLdYPMXu+QGjk/Gp9bwtC5D59WCni94sK5NPu5K8vilhCUW580q3v2anHWu3POs5+GcUDFl+nWn7Q451/hx6b2J6ItVR1MIcqWTKLpfiMzBfPwIW0DXAK5RbenBeGLyKJ6XprxZleECK2FMEOlr5Qb60Y/MdHw5A3SBF8gWvPbL3VdjiPXOuYS4rgixzGdlesgPN4rvSeUkQqxoOaXlgDYH9T0r8nvlIEB3Ksc4hWf+ZOrP6kX18ezv/kOYEchdr4P89I5H8Men4/6V5CMgAAAABJRU5ErkJggg==",Xr="data:img/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJpSURBVFhH7Za9axRBGIdPERv/gDQKQdTC0g9sLCKIYCUIKQRTCcE/QGIlSWslWvqBEEEhIEQLITYRFIKYTgvBIoIoopWIiFisz++ddzdz437MXe4a8YGHmX3nndm53Z256f1nlBRFMYNL+MFVfcabx4vfrIklTxsP3GA93KfirRuz7untkHgAV3HKQ62QN4sxh71JbVMYT2TWm5oh6UvILR57qBXyFkO6Me0x3dh+AGU8wUXFWvFEseqhVsjbCOnFZ1zBX3YVmMTdoWpseLeK7V4OBAPtx4v4gMs9IdqbwFO406422eGliOv1aJpO9QSoT+A0XsPX2MRvfIKX0b4FyvgVdK8GTxT6EDXQI/yqQAN69DH2HQjqp/GdRQPde4In5nLE+6R7wBs3Jm8v8OSUT3gbz+ILBYR3MbhM94KYvD1AkHwHv+EaXsFD3mRwrVdjeKiCkN63lqVWhlS9e+0PAgM2TmAYhlqGbTCvoziP1cc4Uhi47wlQ7EIt0Vv4HmMmrdMoYdBqAqB3nC7DmKz/k2w0IMYTSPmB2ohKlvGcdx8OBjiI9/E71qHHfg+1AvZh3QTnfLjBofPdMEYnVz1/IVz+xbINmJCzCuIP6Sae2AaU1y2yyRw3eeX1kgUvxRnaL3g9Hzo1rntCe/GhNdajb+ZSqBrd54EUOjVOoISmk/jUkvrRBLZ8Hvjo5TMv6ziON/A8ringvMT4DJCeFfJg5vG77ENt9tsC5TGs6UiWdcwbCAbVtlvyE495k9rS88C8N40WBk7/+/VPmMZWPH08cIPqnFBD/nlgK3Ajve/nqKP9eM4D/xi93h907cp7q/WVWwAAAABJRU5ErkJggg==",qr=Object(o["defineComponent"])({name:"tf-inter-model",props:{option:{type:Object,default:function(){return{}}}},setup:function(t,e){e.attrs,e.slots,e.emit,e.expose;var i=null,n=null,r=null,a=null,s=null,h=null,c=0,l=0,d=0,u=0,f=null,p=null,g=null,v=null,x=Object(o["ref"])(),m=Object(o["ref"])(),w=Object(o["ref"])(),_=Object(o["reactive"])({phaseWidth:100,drawOption:{centerLineMode:!1,drawPhase:!0,showRoadAsideLine:!0,showLaneDashedLine:!0,showManRoadLine:!0,showStopLine:!0,showManRoad:!0,showLaneFlow:!0,showRoadName:!0,laneFlowOffetStopLine:0,routeNameColor:"#000000",defaultFlowColor:"#008aaf",HighLightFlowColor:"#00ec00",saturationFlowColor:"#ffffff",phaseBackColor:"#ffffff",laneBackColor:"#283349",phaseNumColor:"#446a86",redColor:"#FF0000",greenColor:"#00EC00",yellowColor:"#E1E100",greyColor:"#cccccc"},interType:0}),P={getDrawOption:function(){_.drawOption=Object.assign({centerLineMode:!1,drawPhase:!0,showRoadAsideLine:!0,showLaneDashedLine:!0,showManRoadLine:!0,showStopLine:!0,showManRoad:!0,showLaneFlow:!0,showRoadName:!0,laneFlowOffetStopLine:0,routeNameColor:"#000000",defaultFlowColor:"#008aaf",HighLightFlowColor:"#00ec00",saturationFlowColor:"#ffffff",phaseBackColor:"#ffffff",laneBackColor:"#283349",phaseNumColor:"#446a86",redColor:"#FF0000",greenColor:"#00EC00",yellowColor:"#E1E100",greyColor:"#cccccc"},t.option)},clearHandler:function(){i&&i.destroy(),n&&n.destroy(),r&&r.destroy(),a&&a.destroy(),s&&s.destroy(),i=null,n=null,r=null,a=null,s=null,h=null},init:function(t){if(i&&this.clearHandler(),_.interType=t.is_have_son,P.getDrawOption(),console.log(),c=x.value.clientWidth,l=x.value.clientHeight,c&&l){var e,r;d=Math.min(c,l),i=new wr.Stage({container:m.value,width:c,height:l});var a=0,o=0;e=r=d,c>l?a=(c-l)/2:o=-(c-l)/2,n=new wr.Layer({x:_.drawOption.drawPhase?a+e/2+e/12:a+e/2,y:o+r/2}),n.height=r,n.width=r,i.add(n),P.drawInter(t)}},drawInter:function(t){var e=this.resetInterData(t);h=new Mr(e);var i=new wr.Shape({stroke:"#23324b",strokeWidth:5,fill:_.drawOption.laneBackColor,sceneFunc:function(t,e){t.beginPath();var i=h.entranceArray.map((function(t){return t.polygonData.RoadPolygon})).flat();i.forEach((function(e,i){0===i?t.moveTo(e[0],-e[1]):t.lineTo(e[0],-e[1])})),t.closePath(),t.fillStrokeShape(e)}});n.add(i),3===_.interType&&A.drawRoundabout(),h.entranceArray.map((function(t,e){var i=new wr.Shape({stroke:"#ffffff",fill:"#ffffff",strokeWidth:1,opacity:1,sceneFunc:function(e,i){e.beginPath(),_.drawOption.showManRoadLine&&t.lineData.manRoadLine.forEach((function(t){t.forEach((function(t,i){0===i?e.moveTo(t[0],-t[1]):e.lineTo(t[0],-t[1])}))})),_.drawOption.showRoadAsideLine&&t.lineData.carRoadLine0.forEach((function(t,i){t.forEach((function(t,i){0===i?e.moveTo(t[0],-t[1]):e.lineTo(t[0],-t[1])}))})),_.drawOption.showStopLine&&t.lineData.carRoadLine1.forEach((function(t,i){t.forEach((function(t,i){0===i?e.moveTo(t[0],-t[1]):e.lineTo(t[0],-t[1])}))})),_.drawOption.showLaneDashedLine&&2!==_.interType&&t.lineData.carRoadLine2.forEach((function(t){t.forEach((function(t,i){0===i?e.moveTo(t[0],-t[1]):e.lineTo(t[0],-t[1])}))})),e.closePath(),e.fillStrokeShape(i)}});if(n.add(i),2!==_.interType){if(_.drawOption.showLaneDashedLine){var r=new wr.Shape({stroke:_.drawOption.yellowColor,fill:_.drawOption.yellowColor,strokeWidth:1,opacity:1,sceneFunc:function(e,i){e.beginPath(),t.lineData.carRoadLine4.forEach((function(t){t.forEach((function(t,i){0===i?e.moveTo(t[0],-t[1]):e.lineTo(t[0],-t[1])}))})),e.closePath(),e.fillStrokeShape(i)}});n.add(r);var a={stroke:_.drawOption.greenColor,strokeWidth:2};A.drawLine(t.lineData.fdsplitLine,a),t.correctPoint.pointWaitArea.forEach((function(t){var e=[];t.forEach((function(t){e.push(t.x),e.push(-t.y)}));var i=new wr.Line({points:e,stroke:"#ffffff",strokeWidth:1,lineJoin:"round",dash:[3,5],lineCap:"round"});n.add(i)}))}if(_.drawOption.showManRoad){var o=new wr.Shape({fill:"black",sceneFunc:function(i,n){i.beginPath();var r=[t.polygonData.walkwayPolygonR,h.entranceArray[0===e?h.entranceArray.length-1:e-1].polygonData.walkwayPolygonL].flat();r.forEach((function(t,e){0===e?i.moveTo(t[0],-t[1]):i.lineTo(t[0],-t[1])})),i.closePath(),i.fillStrokeShape(n)}});n.add(o)}}else _.drawOption.showLaneDashedLine&&t.lineData.carRoadLine2.forEach((function(t){var e=new wr.Line({points:[t[0][0],-t[0][1],t[1][0],-t[1][1]],stroke:"#ffffff",strokeWidth:1,lineJoin:"round",dash:[8,8]});n.add(e)}));if("greenArea"===t.road_center_mode?A.drawPolygon(t.lineData.carRoadLine3[0],{fill:_.drawOption.greenColor,stroke:_.drawOption.greenColor}):A.drawLine(t.lineData.carRoadLine3,{stroke:_.drawOption.yellowColor}),_.drawOption.showRoadName){var s=new wr.Text({x:t.correctPoint.roadName.x,y:-t.correctPoint.roadName.y,text:t.name,fontSize:12,fontFamily:"Calibri",fill:_.drawOption.routeNameColor,rotation:A.getTextRotationByDegree(t.degree)});A.offsetText(s,t.degree),n.add(s)}if(_.drawOption.showLaneFlow){var c=new wr.Shape({stroke:"white",strokeWidth:1.5,sceneFunc:function(e,i){var n=t.polygonData.laneFlowPolygon;n.forEach((function(t,n){e.beginPath(),t.forEach((function(t,i){0===i?e.moveTo(t[0],-t[1]):e.lineTo(t[0],-t[1])})),e.closePath(),e.fillStrokeShape(i)}))}});n.add(c)}})),h.entranceArray.map((function(t,e){t.canalization&&2!==_.interType&&(A.drawCanalization(t.en_id),A.drawBikeLogo(t))})),n.draw()},resetInterData:function(t){var e=JSON.parse(JSON.stringify(S(S({},t),{},{drawOption:_.drawOption,baseWidth:d,clientWidth:c,clientHeight:l,expandManRadian:!1,centerLineMode:_.drawOption.centerLineMode})));return 3===_.interType&&(e.expandManRadian=!0),e.entrances.forEach((function(t,i){if(t.canalization&&0!==t.canalization&&(e.expandManRadian=!0,2===t.canalization||4===t.canalization)){var n=e.entrances[i>0?i-1:e.entrances.length-1];n.exit_lanes.push({id:n.exit_lanes.length+1,lane_flow:2})}})),e}},A={initLayer:function(){var t,e;r&&r.destroy();var n=0,a=0;t=e=d,c>l?n=(c-l)/2:a=-(c-l)/2,r=new wr.Layer({x:_.drawOption.drawPhase?n+t/2+t/12:n+t/2,y:a+e/2}),r.height=e,r.width=e,i.add(r)},getEnidWithDirection:function(t){var e=null,i=h.entrances.find((function(e){return e.orientation===t}));return i&&(e=i.en_id),e},drawRoadFlow:function(t,e){var i=this,n=this.getSortMovement(t);n.forEach((function(t){t.flowList.forEach((function(n,r){if(n.if_control){var a=h.entranceArray[t.en_id-1],o=i.getStartPoint(n.movements_type,r,t,"main"),s=Fr(o,Rr.roadWidth,n.movements_type,a),c=i.getRotateData(s,a.angle);i.drawRoadFlowWithData(c,n,e)}})),t.fdflowList.forEach((function(n,r){if(n.if_control){var a=h.entranceArray[t.en_id-1],o=i.getStartPoint(n.movements_type,r,t,"fd"),s=Fr(o,Rr.roadWidth,n.movements_type,a,"fd"),c=i.getRotateData(s,a.angle);i.drawRoadFlowWithData(c,n,e)}}))}))},drawRoadFlowWithData:function(t,e,i){var r=new wr.Shape({stroke:e.if_release?_.drawOption.HighLightFlowColor:_.drawOption.defaultFlowColor,fill:e.if_release?_.drawOption.HighLightFlowColor:_.drawOption.defaultFlowColor,strokeWidth:1,info:e,sceneFunc:function(e,i){e.beginPath(),t.forEach((function(t,i){0===i?e.moveTo(t.x,-t.y):e.lineTo(t.x,-t.y)})),e.closePath(),e.fillStrokeShape(i)}});i&&r.on("click",(function(t){i(t.target.attrs.info)})),n.add(r)},getRotateData:function(t,e){var i=[];return Array.isArray(t)?(i=[],t.forEach((function(t,n){Array.isArray(t)?(i[n]=[],t.map((function(t){i[n].push(Tr.pointRotateAngel(t,-e,[0,0]))}))):i.push(Tr.pointRotateAngel(t,-e,[0,0]))}))):i=Tr.pointRotateAngel(t,-e,[0,0]),i},getEntranceLaneNum:function(t){var e=t["in"],i=0,n=t.motor_lanes.findIndex((function(t){return 4===t.lane_type}));return n>-1&&(i=e-n-1,e=n+1),{mainIn:e,fdIn:i}},getStartPoint:function(t,e,i,n){var r=i.en_id,a=i.laneFlowTotal,o=i.fdlaneFlowTotal,s=h.entranceArray[r-1],c=this.getEntranceLaneNum(s),l=c.mainIn,d=s.point.H0[s["in"]],u=d.x,f=d.y,p=s.point.H0[s["in"]-1].y,g=Rr.roadWidth,y=p-f,v=0,x=-2*g,m=[0,0];return 4===t||10===t||11===t?(v=0,x+=Rr.manCarInterval+Rr.manRoadLength/2+2*g):12===t||13===t||14===t?o?s["in"]<=a+o?(v=(a+o)*g+g*(e-a)*3/4,x+=y*(a+o)+y*(e-a)*3/4):(v=s["in"]*g+g*(e-a)*3/4,x+=y*s["in"]+y*(e-a)*3/4):s["in"]<=a?(v=a*g+g*(e-a)*3/4,x+=y*a+y*(e-a)*3/4):(v=s["in"]*g+g*(e-a)*3/4,x+=y*s["in"]+y*(e-a)*3/4):o?s["in"]<=a+o?"main"===n?(v+=Rr.roadWidth*e,x+=y*e):"fd"===n&&(v+=Rr.roadWidth*(e+a),x+=y*(e+a)):"main"===n?(1===a&&(2!==t&&7!==t||(v+=Rr.roadWidth*(l-1)/2,x+=y*(Rr.roadWidth*(l-1)/2)),3!==t&&6!==t||(v+=Rr.roadWidth*(l-1),x+=y*(l-1))),a>1&&(v+=Rr.roadWidth*(s["in"]-1)/(a-1)*e,x+=y*(s["in"]-1)/(a-1)*e)):"fd"===n&&(v+=Rr.roadWidth*(s["in"]-1)/(a+o-1)*(e+a),x+=y*(s["in"]-1)/(a+o-1)*(e+a)):s["in"]<=a?(v+=Rr.roadWidth*e,x+=y*e):(1===a&&(2!==t&&7!==t||(v+=Rr.roadWidth*(s["in"]-1)/2,x+=y*(Rr.roadWidth*(s["in"]-1)/2)),3!==t&&6!==t||(v+=Rr.roadWidth*(s["in"]-1),x+=y*(s["in"]-1))),a>1&&(v+=Rr.roadWidth*(s["in"]-1)/(a-1)*e,x+=y*(s["in"]-1)/(a-1)*e)),m=[u+v,f+x],m},getSortMovement:function(t){var e=[];return h.entranceArray.forEach((function(i,n){var r=t.filter((function(t){var e=A.getEnidWithDirection(t.enter_port_direction);return e===i.en_id&&t.if_control})),a=r.filter((function(t){return(1===t.movements_type||5===t.movements_type||8===t.movements_type||9===t.movements_type)&&!t.fd_flow})),o=r.filter((function(t){return(1===t.movements_type||5===t.movements_type||8===t.movements_type||9===t.movements_type)&&t.fd_flow})),s=r.filter((function(t){return(2===t.movements_type||7===t.movements_type)&&!t.fd_flow})),h=r.filter((function(t){return(2===t.movements_type||7===t.movements_type)&&t.fd_flow})),c=r.filter((function(t){return(3===t.movements_type||6===t.movements_type)&&!t.fd_flow})),l=r.filter((function(t){return(3===t.movements_type||6===t.movements_type)&&t.fd_flow})),d=r.filter((function(t){return(4===t.movements_type||10===t.movements_type||11===t.movements_type)&&!t.fd_flow})),u=r.filter((function(t){return(12===t.movements_type||13===t.movements_type||14===t.movements_type)&&!t.fd_flow}));e.push({en_id:i.en_id,laneFlowTotal:a.length+s.length+c.length,flowList:[].concat(b(a),b(s),b(c),b(u),b(d)),fdlaneFlowTotal:o.length+h.length+l.length,fdflowList:[].concat(b(o),b(h),b(l))})})),e},drawFlowSaturation:function(t){var e=this;t.forEach((function(t,i){var r=h.entranceArray[t.en_id-1],a=r.polygonData.roadFlowPolygon[t.movements_type-1],o=new wr.Shape({stroke:_.drawOption.saturationFlowColor,fill:_.drawOption.saturationFlowColor,strokeWidth:1,info:t,sceneFunc:function(t,e){t.beginPath(),a.forEach((function(e,i){0===i?t.moveTo(e[0],-e[1]):t.lineTo(e[0],-e[1])})),t.closePath(),t.fillStrokeShape(e)}});n.add(o);var s=r.correctPoint.pointRoadFlowText[t.movements_type-1],c=s.x,l=s.y,d=new wr.Text({x:c,y:-l,text:t.data,fontSize:12,fontFamily:"Calibri",fill:_.drawOption.saturationFlowColor,rotation:e.getTextRotationByDegree(r.degree)});e.offsetText(d,r.degree),n.add(d)}))},fillEntranceOrLaneBack:function(t){var e=this;t.forEach((function(t){var i=h.entranceArray[t.en_id-1],n=i["in"],r=i.out,a=0,o=0,s=[];1===t.fillType?1===t.fillDirection?(a=0,o=n):2===t.fillDirection&&(a=n+e.getOutLineOffset(i.road_center_mode),o=n+r+e.getOutLineOffset(i.road_center_mode)):2===t.fillType&&(1===t.fillDirection?(a=n-t.laneNumber+1,o=n-t.laneNumber):2===t.fillDirection&&(a=n+t.laneNumber+e.getOutLineOffset(i.road_center_mode),o=n+t.laneNumber+e.getOutLineOffset(i.road_center_mode)-1));var c=i.point.H0,l=i.point.H2,d=Tr.pointRotateAngel(c[a],-i.angle),u=Tr.pointRotateAngel(c[o],-i.angle),f=Tr.pointRotateAngel(l[o],-i.angle),p=Tr.pointRotateAngel(l[a],-i.angle);t.length&&(f=Tr.pointRotateAngel({x:c[o].x,y:c[o].y-Rr.roadWidth*t.length},-i.angle),p=Tr.pointRotateAngel({x:c[a].x,y:c[a].y-Rr.roadWidth*t.length},-i.angle)),s=[[d.x,d.y],[u.x,u.y],[f.x,f.y],[p.x,p.y]],e.drawPolygon(s,t.style)}))},getOutLineOffset:function(t){var e=0;return t&&"singleYellowLine"!==t&&(e=1),e},drawEntranceHighLight:function(t){var e=this;t.forEach((function(t){var i=h.entranceArray[t.en_id-1],n=i["in"],r=[],a=i.point.H0,o=i.point.H2,s=Tr.pointRotateAngel(a[0],-i.angle),c=Tr.pointRotateAngel(a[n],-i.angle),l=Tr.pointRotateAngel(o[n],-i.angle),d=Tr.pointRotateAngel(o[0],-i.angle);t.length&&(l=Tr.pointRotateAngel({x:a[n].x,y:a[n].y-Rr.roadWidth*t.length},-i.angle),d=Tr.pointRotateAngel({x:a[0].x,y:a[0].y-Rr.roadWidth*t.length},-i.angle)),r=[[[s.x,s.y],[c.x,c.y]],[[c.x,c.y],[l.x,l.y]],[[s.x,s.y],[d.x,d.y]]],e.drawLine(r,t.style)}))},drawAdjacentInfo:function(t,e){var i=this,r=this,a={};t.forEach((function(t){a[t.entrance_id]=t})),h.entranceArray.forEach((function(t){var o=a[t.en_id];if(o){var s=i.getNearPoint(t),h=new wr.Image({image:g,width:1.5*Rr.roadWidth,height:1.5*Rr.roadWidth,x:s.x,y:-s.y,info:o,rotation:i.getImgRotationByDegree(t.degree,2)});i.offsetImg(h,t.degree,2),e&&(h.on("click",(function(t){var i=t.target.attrs.info;e(i)})),h.on("mouseover",(function(t){var e=t.target.attrs,i=e.x,n=e.y;r.drawHoverText(i,n,o.hoverText)})),h.on("mouseout",(function(t){p.remove(),f.remove()}))),n.add(h)}}))},getNearPoint:function(t){var e=t.degree,i=(_.drawOption.drawPhase?5*c/12:c/2)-2*Rr.roadWidth,n=l/2-2*Rr.roadWidth,r=0,a=0;if(e>=0&&e<45)r=i,a=-i*Math.tan(Tr.toRadian(e));else if(e>=45&&e<90){var o=90-e;r=n*Math.tan(Tr.toRadian(o)),a=-n}else if(e>=90&&e<135){var s=e-90;r=-n*Math.tan(Tr.toRadian(s)),a=-n}else if(e>=135&&e<180){var h=180-e;r=-i,a=-i*Math.tan(Tr.toRadian(h))}else if(e>=180&&e<225){var d=e-180;r=-i,a=i*Math.tan(Tr.toRadian(d))}else if(e>=225&&e<270){var u=270-e;r=-n*Math.tan(Tr.toRadian(u)),a=n}else if(e>=270&&e<315){var f=e-270;r=n*Math.tan(Tr.toRadian(f)),a=n}else if(e>=315&&e<=360){var p=360-e;r=i,a=i*Math.tan(Tr.toRadian(p))}return{x:r,y:a}},drawBikeLogo:function(t){var e=this,i=[t.correctPoint.roadPole,t.correctPoint.roadPoleL];i.forEach((function(i,r){var a=i.x,o=i.y,s=new wr.Image({image:v,width:.5*Rr.roadWidth,height:.5*Rr.roadWidth,x:a,y:-o,rotation:e.getImgRotationByDegree(t.degree,2)});e.offsetImg(s,t.degree,2),n.add(s)}))},drawLaneImg:function(t,e){var i=this;this.loadImg(t,(function(r){t.forEach((function(t,a){var o=h.entranceArray[t.en_id-1];if(o){var s=i.getStopLinePointByLaneNum(t,o),c=s.x,l=s.y,d=new wr.Image({image:r[a],width:1*Rr.roadWidth,height:1*Rr.roadWidth,x:c,y:-l,info:t,rotation:i.getImgRotationByDegree(o.degree,t.rotateType)});i.offsetImg(d,o.degree,t.rotateType),e&&d.on("click",(function(t){var i=t.target.attrs.info;e(i)})),n.add(d)}}))}))},loadImg:function(t,e){var i=[];t.forEach((function(t){var e=new window.Promise((function(e,i){var n=new Image;n.onload=function(){e(n)},n.src=t.imgUrl}));i.push(e)})),window.Promise.all(i).then((function(t){e&&e(t)}))["catch"]((function(t){console.log(t)}))},getStopLinePointByLaneNum:function(t,e){var i=e["in"]-t.laneNumber+1;2===t.laneDirection&&(i=e["in"]+t.laneNumber+this.getOutLineOffset(e.road_center_mode));var n=e.point.H0[i],r=n.x,a=n.y,o={x:r+Rr.roadWidth/2,y:a-(t.offetStopLine+.5)*Rr.roadWidth},s=Tr.pointRotateAngel(o,-e.angle);return s},getImgRotationByDegree:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(2===e)return t-90;var i=t;return t>0&&t<=90?i=t-90:t>90&&t<=180?i=t-180:t>180&&t<=270&&(i=t-270),i},offsetImg:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;1===i?e>0&&e<=90?t.offsetX(t.width()/2):e>90&&e<=180?(t.offsetX(t.width()),t.offsetY(t.height()/2)):e>180&&e<=270?(t.offsetX(t.width()/2),t.offsetY(t.height())):t.offsetY(t.height()/2):2===i&&t.offsetX(t.width()/2)},getTextRotationByDegree:function(t){var e=t;return t>90&&t<270&&(e=t+180),e},offsetText:function(t,e){e>90&&e<270?(t.offsetX(t.width()),t.offsetY(t.height()/2)):t.offsetY(t.height()/2)},drawVariableLane:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;t.forEach((function(t,r){var a=h.entranceArray[t.entrance_id-1];if(a){var o=Dr(t.lane_id,t.status,Rr,a,null),s=e.getRotateData(o,a.angle);if(e.drawVariableFlow(s),i){var c=Dr(t.lane_id,"variableClick",Rr,a,null),l=e.getRotateData(c,a.angle);e.drawVariableClickPoint(l[0],t,n)}}}))},drawVariableFlow:function(t){var e=new wr.Shape({stroke:_.drawOption.yellowColor,strokeWidth:2,sceneFunc:function(e,i){e.beginPath(),t.forEach((function(t,i){0===i?e.moveTo(t.x,-t.y):e.lineTo(t.x,-t.y)})),e.closePath(),e.fillStrokeShape(i)}});n.add(e)},drawVariableClickPoint:function(t,e,i){var r=new wr.Circle({x:t.x,y:-t.y,radius:Rr.roadWidth/4,info:e,fill:_.drawOption.yellowColor});n.add(r),i&&r.on("click",(function(t){var e=t.target.attrs.info;i(e)}))},drawCanalization:function(t){var e=t-1,i=h.entranceArray.length,n=h.entranceArray[e],r=h.entranceArray[e>0?e-1:i-1],a=n.point.AR;if(1===n.canalization||2===n.canalization){var o={x:n.point.BRO.x,y:n.point.BRO.y+Rr.manCarInterval+Rr.manRoadLength+Rr.roadWidth},s={x:r.point.BLO.x,y:r.point.BLO.y+Rr.manCarInterval+Rr.manRoadLength+Rr.roadWidth};2===n.canalization&&(a.y=a.y+Rr.roadWidth,s.x=s.x+Rr.roadWidth,s.y=s.y-Rr.roadWidth);var c=Tr.pointRotateAngel(a,-n.angle),l=c.x,d=c.y,u=Tr.pointRotateAngel(o,-n.angle),f=u.x,p=u.y,g=Tr.pointRotateAngel(s,-r.angle),y=g.x,v=g.y,x=[[l,d]],m=Tr.getArcPoint([f,p],[y,v]);x=x.concat(m),x.push([l,d]);var b=[];b.push(x);for(var w=4,_=Math.floor(y-l)/w,S=Math.floor(v-d)/w,P=Math.floor(f-l)/w,A=Math.floor(p-d)/w,C=1;C<=w/2;C++){var R=[[l+C*_,d+C*S],[l+C*P,d+C*A]];b.push(R)}this.drawLine(b)}else if(3===n.canalization||4===n.canalization){var L=[Rr.manCarInterval+Rr.manRoadLength+1.5*Rr.roadWidth,Rr.manCarInterval,-1*Rr.roadWidth,-3*Rr.roadWidth,-3*Rr.roadWidth],k=[0,0,0,0,Rr.walkwayWidth],T=n.point.BR,M=T.x,E=T.y,O=L.map((function(t,e){var i=k[e],r=Tr.pointRotateAngel({x:M-1+i,y:E+t},-n.angle),a=r.x,o=r.y;return[a,o]})),D=r.point.BL,I=D.x,W=D.y;4===n.canalization&&(I+=Rr.roadWidth,L=[Rr.manCarInterval+Rr.manRoadLength+.5*Rr.roadWidth,Rr.manCarInterval,-1*Rr.roadWidth,-1*Rr.roadWidth,-1*Rr.roadWidth],k=[0,0,0,Rr.roadWidth,Rr.roadWidth+Rr.walkwayWidth]);var G=L.map((function(t,e){var i=k[e],n=Tr.pointRotateAngel({x:I+1-i,y:W+t},-r.angle),a=n.x,o=n.y;return[a,o]}));this.getGtdPolygonData(G,O),this.getGtdLineData(G,O)}},getGtdLineData:function(t,e){var i=[],n=[],r=Tr.getArcPoint(e[0],t[0]),a=Tr.getArcPoint(e[2],t[2]);n=n.concat(a);for(var o=r.length-1;o>0;o--)n.push(r[o]);n=n.concat(a),i.push(n);var s=Tr.getArcPoint(e[3],t[3]);i.push(s),this.drawLine(i)},getGtdPolygonData:function(t,e){for(var i=Tr.getArcPoint(e[0],t[0]),n=Tr.getArcPoint(e[2],t[2]),r=Tr.getArcPoint(e[3],t[3]),a=Tr.getArcPoint(e[4],t[4]),o=[],s=i.length-1;s>0;s--)o.push(i[s]);o=o.concat(n),this.drawPolygon(o,{fill:"green"});for(var h=[],c=n.length-1;c>0;c--)h.push(n[c]);h=h.concat(r),this.drawPolygon(h,{fill:"#23324b"});for(var l=[],d=a.length-1;d>0;d--)l.push(a[d]);l=l.concat(r),this.drawPolygon(l,{fill:"#000000"})},drawLine:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=S({stroke:"green",strokeWidth:1},e);t.forEach((function(t){var e=[];t.forEach((function(t){e.push(t[0]),e.push(-t[1])}));var r=new wr.Line(S({points:e},i));n.add(r)}))},drawPolygon:function(t,e){if(t){var i=S({fill:"#fff",strokeWidth:1},e),r=new wr.Shape(S(S({strokeWidth:1},i),{},{sceneFunc:function(e,i){e.beginPath(),t.forEach((function(t,i){0===i?e.moveTo(t[0],-t[1]):e.lineTo(t[0],-t[1])})),e.closePath(),e.fillStrokeShape(i)}}));n.add(r)}},drawHoverText:function(t,e,i){p=new wr.Text({x:t,y:e,text:i,fontSize:12,fontFamily:"Calibri",fill:"#fff"});var r=p.width();f=new wr.Rect({x:t,y:e,width:r+10,height:20,fill:"#3b4859",shadowBlur:10,cornerRadius:10}),t>0?(p.offsetX(r),f.offsetX(r+5)):f.offsetX(5),f.offsetY(4),n.add(f),n.add(p)},drawRoundabout:function(){var t=this,e=Rr.roadWidth,i=Rr.manRoadLength,r=Rr.manCarInterval,a=5*e;h.entranceArray.forEach((function(n){var o=[],s=n.point.H0,h=s[n["in"]],c=h.x,l=h.y;l=l+i+r+4;var d=Math.max((-l-2*e)/3,0);a=Math.min(a,2*d);var u=Tr.pointRotateAngel({x:c-e/2,y:l+d},-n.angle),f=u.x,p=u.y,g=Tr.pointRotateAngel({x:c,y:l},-n.angle),y=g.x,v=g.y,x=Tr.pointRotateAngel({x:c+e/2,y:l+d},-n.angle),m=x.x,b=x.y,w=Tr.getArcPoint([m,b],[f,p]);o.push([y,v]),o=o.concat(w),t.drawPolygon(o,{fill:"#2e8348",opacity:.8})}));var o=new wr.Circle({x:0,y:0,radius:Math.max(a,e),fill:"#2e8348"});n.add(o);var s=new wr.Circle({x:0,y:0,radius:Math.max(a,e)+e,stroke:"#fff",opacity:.5,strokeWidth:1,dash:[6,6]});n.add(s)}},C={drawRealInfo:function(t,e){A.initLayer(),this.setRealBaseInfo(t),this.drawPhases(t,e),this.drawPhaseRemainTime(t.current_phase_remaining_time),2!==h.is_have_son&&this.drawWalkMan(t,e),this.drawInterPhase(t,e),this.drawGreenRedLight(t,e)},setRealBaseInfo:function(t){var e=t.ctrl_way;e},drawPhases:function(t,e){var i=this;a&&a.destroy(),s&&s.destroy(),u=d/6,a=new wr.Stage({container:w.value,width:u,height:Math.max(l,u*t.phase_num)}),s=new wr.Layer({x:0,y:0}),s.width=u,s.height=Math.max(l,u*t.phase_num),a.add(s);var n=new wr.Rect({x:0,y:0,width:u,height:Math.max(l,u*t.phase_num),fill:_.drawOption.phaseBackColor});s.add(n),7!==t.ctrl_way&&(t.phase_movements_info.forEach((function(n,r){if(n){var a=r+1,o=i.getEntrancePhaseList(n,e,"main"),s=i.getEntrancePhaseList(n,e,"fd");i.darwPhaseWithPhaseList(t,o,a,"main"),i.darwPhaseWithPhaseList(t,s,a,"fd")}})),this.slideToCurPhase(t.current_phase_num))},darwPhaseWithPhaseList:function(t,e,i,n){var r=this,a=[];e.forEach((function(t,e){var o=[];2===h.is_have_son&&2!==e||t.forEach((function(t,e){var r=Wr(i,t,u,n);o.push(r)}));var s=r.rotatePoint(i,e,o);a.push(s)})),this.drawPhaseBox(u,i,a,t.current_phase_num)},slideToCurPhase:function(t){w.value.scrollTop=u*(t-1)},drawPhaseBox:function(t,e,i,n){var r=new wr.Rect({x:2,y:(e-1)*t+2,width:t-4,height:t-4,stroke:n===e?"#ff0000":"#446a86",strokeWidth:2});s.add(r);var a=new wr.Text({x:4,y:e*t-18,text:jr.get(e),fontSize:16,fontFamily:"Calibri",fill:_.drawOption.phaseNumColor});s.add(a),i.forEach((function(t){t.forEach((function(t){var e=new wr.Shape({stroke:_.drawOption.greenColor,fill:_.drawOption.greenColor,strokeWidth:1,sceneFunc:function(e,i){e.beginPath(),t.forEach((function(t,i){0===i?e.moveTo(t.x,-t.y):e.lineTo(t.x,-t.y)})),e.closePath(),e.fillStrokeShape(i)}});s.add(e)}))}))},getEntrancePhaseList:function(t,e,i){var n=t.toString(2).split("");n.reverse();var r=this.getPhaseListWithBin(n,e,"phase",i);return r},getPhaseListWithBin:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"inter",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"main",a=[],o={};return e.forEach((function(t){o[t.num_movements]=t})),h.entranceArray.forEach((function(e,s){var h=[];t.forEach((function(t,i){var a=o[i+1],s=!1;if("fd"===r?a&&a.fd_flow&&(s=!0):a&&!a.fd_flow&&(s=!0),a){var c=A.getEnidWithDirection(a.enter_port_direction);c===e.en_id&&a.if_control&&s&&("phase"===n?Number(t)&&h.push(a.movements_type):("run"===n||1!==Number(t)&&0!==Number(t))&&h.push(a.movements_type))}}));var c=i.getPhaseMovementType(h);a.push(c)})),a},getTypePhaseListWithBin:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=[],o={};e.forEach((function(t){o[t.num_movements]=t}));var s="main"!==r;return h.entranceArray.forEach((function(e,r){var h=[];t.forEach((function(t,i){var r=o[i+1];if(r){r.fd_flow=!!r.fd_flow;var a=A.getEnidWithDirection(r.enter_port_direction);a===e.en_id&&r.if_control&&r.fd_flow===s&&Number(t)===n&&h.push(r.movements_type)}}));var c=i.getPhaseMovementType(h);a.push(c)})),a},getPhaseMovementType:function(t){var e=[],i=[1,2,3,4,8,10,11,12,13];return t.forEach((function(t){i.includes(t)?e.push(t):5===t?(e.push(1),e.push(2)):6===t?(e.push(2),e.push(3)):7===t?(e.push(1),e.push(2),e.push(3)):9===t?(e.push(1),e.push(8)):14===t&&(e.push(12),e.push(13))})),Array.from(new Set(e))},rotatePoint:function(t,e,i){var n=h.entranceArray[e],r=[u/2+2,-u*(t-.5)-2],a=[];return Array.isArray(i)?(a=[],i.forEach((function(t,e){Array.isArray(t)?(a[e]=[],t.map((function(t){a[e].push(Tr.pointRotateByPoint(t,-n.angle,r))}))):a.push(Tr.pointRotateByPoint(t,-n.angle,r))}))):a=Tr.pointRotateByPoint(i,-n.angle,r),a},drawInterPhase:function(t,e){var i=this.getPhaseListWithBin(t.movements_state,e,"inter","main"),n=this.getPhaseListWithBin(t.movements_state,e,"inter","fd");this.drawInterPhaseWithPhaseList(t,e,i,"main"),this.drawInterPhaseWithPhaseList(t,e,n,"fd")},drawInterPhaseWithPhaseList:function(t,e,i,n){var r=this;i.forEach((function(i,a){i.forEach((function(i,o){var s=h.entranceArray[a];if(2!==h.is_have_son||3===s.en_id){var c=Gr(i,s,n),l=A.getRotateData(c,s.angle),d=r.getInterPhaseFlowColor(t.movements_state,e,a,i,n);r.drawInterPhaseFlow(l,d)}}))}))},getInterPhaseFlowColor:function(t,e,i,n,r){var a=_.drawOption.yellowColor,o=h.entranceArray[i],s="main"!==r,c=[];e.forEach((function(e){if(e.if_control){var i=A.getEnidWithDirection(e.enter_port_direction);i===o.en_id&&e.fd_flow===s&&3===t[e.num_movements-1]&&c.push(e.movements_type)}}));var l=this.getPhaseMovementType(c);return l.includes(n)&&(a=_.drawOption.greenColor),a},drawInterPhaseFlow:function(t,e){var i=new wr.Shape({stroke:e,fill:e,strokeWidth:1,sceneFunc:function(e,i){e.beginPath(),t.forEach((function(t,i){0===i?e.moveTo(t.x,-t.y):e.lineTo(t.x,-t.y)})),e.closePath(),e.fillStrokeShape(i)}});r.add(i)},drawPhaseRemainTime:function(t){var e=new wr.Text({x:0,y:0,text:t,fontSize:14,fontFamily:"Calibri",fill:"#ffffff",cornerRadius:10});e.offsetX(e.width()/2),e.offsetY(e.height()/2);var i=new wr.Circle({x:0,y:0,radius:2*Rr.roadWidth/3,fill:"#3a3b45"});r.add(i),r.add(e)},drawWalkMan:function(t,e){var i=this,n=this.getPhaseListWithBin(t.movements_state,e,"run","main"),r=C.getTypePhaseListWithBin(t.movements_state,e,0,null),a=C.getTypePhaseListWithBin(t.movements_state,e,1,null),o=C.getTypePhaseListWithBin(t.movements_state,e,2,null),s=C.getTypePhaseListWithBin(t.movements_state,e,3,null);n.forEach((function(t,e){var n=r[e],c=a[e],l=o[e],d=s[e],u=i.getRuncolor("run",n,c,l,d),f=i.getRuncolor("run1",n,c,l,d),p=i.getRuncolor("run2",n,c,l,d),g=h.entranceArray[e],y=i.getEntranceManPoint(g);t.includes(4)?(i.drawFootLight(y[0],"green",g.angle,u),i.drawFootLight(y[3],"green",g.angle,u)):(t.includes(10)||t.includes(11))&&(t.includes(10)&&(i.drawFootLight(y[0],"green",g.angle,f),i.drawFootLight(y[1],"green",g.angle,f)),t.includes(11)&&(i.drawFootLight(y[2],"green",g.angle,p),i.drawFootLight(y[3],"green",g.angle,p)))}))},getEntranceManPoint:function(t){var e=(t.point.H0[0].y-t.point.H0[1].y)/2,i=Rr.manCarInterval+Rr.manRoadLength/2+e,n=Rr.roadWidth/2,r=[],a=A.getOutLineOffset(t.road_center_mode),o=[1,t["in"],t["in"]+1+a,t["in"]+t.out+a];return o.forEach((function(e){r.push([t.point.H0[e].x+n,t.point.H0[e].y+i])})),r},drawFootLight:function(t,e,i,n){var a=Tr.pointRotateAngel({x:t[0],y:t[1]},-i,[0,0]),o=new wr.Circle({x:a.x,y:-a.y,radius:2*Rr.roadWidth/5,fill:"#000"});r.add(o);var s=Br(a,e),h=new wr.Shape({stroke:n,fill:n,strokeWidth:.2,sceneFunc:function(t,e){t.beginPath(),s.forEach((function(e,i){0===i?t.moveTo(e.x,-e.y):t.lineTo(e.x,-e.y)})),t.closePath(),t.fillStrokeShape(e)}});r.add(h)},drawGreenRedLight:function(t,e){this.drawGreenRedLightWithType(t,e,"main"),this.drawGreenRedLightWithType(t,e,"fd")},drawGreenRedLightWithType:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"main",r=this.getPhaseListWithBin(t.movements_state,e,"inter",n),a=this.getTypePhaseListWithBin(t.movements_state,e,0,n),o=this.getTypePhaseListWithBin(t.movements_state,e,1,n),s=this.getTypePhaseListWithBin(t.movements_state,e,2,n),h=this.getTypePhaseListWithBin(t.movements_state,e,3,n);r.forEach((function(t,e){if(t.length||"main"===n){var r=a[e],c=o[e],l=s[e],d=h[e],u=i.getEntranceLightPoint(e,n),f=u.points,p=u.angle,g=i.getxAngle(f,p);i.drawLightHandler(f[1],"back",p,null,g,n);var y=i.getLightcolor("left",r,c,l,d),v=i.getLightcolor("center",r,c,l,d),x=i.getLightcolor("right",r,c,l,d);i.drawLightHandler(f[0],"left",p,y,g),i.drawLightHandler(f[1],"center",p,v),i.drawLightHandler(f[2],"right",p,x,g)}}))},getLightcolor:function(t,e,i,n,r){var a=[{phase:e,color:_.drawOption.greyColor},{phase:i,color:_.drawOption.redColor},{phase:n,color:_.drawOption.yellowColor},{phase:r,color:_.drawOption.greenColor}],o=_.drawOption.greyColor;return"left"===t?a.forEach((function(t){(t.phase.includes(1)||t.phase.includes(5)||t.phase.includes(7)||t.phase.includes(8)||t.phase.includes(9))&&(o=t.color)})):"center"===t?a.forEach((function(t){(t.phase.includes(2)||t.phase.includes(5)||t.phase.includes(6)||t.phase.includes(7))&&(o=t.color)})):"right"===t&&a.forEach((function(t){(t.phase.includes(3)||t.phase.includes(6)||t.phase.includes(7))&&(o=t.color)})),o},getRuncolor:function(t,e,i,n,r){var a=[{phase:r,color:_.drawOption.greenColor},{phase:n,color:_.drawOption.yellowColor},{phase:i,color:_.drawOption.redColor},{phase:e,color:_.drawOption.greyColor}],o=_.drawOption.greenColor;return"run"===t?a.forEach((function(t){t.phase.includes(4)&&(o=t.color)})):"run1"===t?a.forEach((function(t){t.phase.includes(10)&&(o=t.color)})):"run2"===t&&a.forEach((function(t){t.phase.includes(11)&&(o=t.color)})),o},getEntranceLightPoint:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"main",i=h.entranceArray.length,n=[],r=[];if(2===i){var a=h.entranceArray[(t+1)%2],o=this.calculateEntranceLightPoint(a,e);n=o.points,r=o.angle}else if(3===i){var s=h.entranceArray[t],c=(t+4)%3,l=t-1>=0?t-1:2;if((s.degreeLeft+360-s.degree)%360>=180){var d=h.entranceArray[c],u=this.calculateEntranceLightPoint(d,e);n=u.points,r=u.angle}else if((s.degree+360-s.degreeRight)%360>=180){var f=h.entranceArray[l],p=this.calculateEntranceLightPoint(f,e);n=p.points,r=p.angle}else{var g=h.entranceArray[t],y=h.entranceArray[l],v=h.entranceArray[c],x=this.calculateEntranceFaceLightPoint(g,y,v,e);n=x.points,r=x.angle+180}}else if(4===i){var m=h.entranceArray[(t+2)%4],b=this.calculateEntranceLightPoint(m,e);n=b.points,r=b.angle}else{var w=h.entranceArray[t],_=this.calculateCircleLightPoint(w,e);n=_.points,r=_.angle}return{points:n,angle:r}},calculateEntranceLightPoint:function(t,e){var i=Rr.roadWidth/3,n=[],r=[],a=t["in"],o=t.out,s=1,h="fd"===e?Rr.roadWidth:0,c=(t.point.H0[0].y-t.point.H0[1].y)/2,l=(t.point.H0[0].y-t.point.H0[1].y)/Rr.roadWidth,d=[t.point.H0[a].x-Rr.roadWidth*o/2,t.point.H0[a].y-c*o-i-s-h],u=[d[0]-2*i-s,d[1]-l*(2*i+s)],f=[d[0]+2*i+s,d[1]+l*(2*i+s)];return n=[f,d,u],r=t.angle,{points:n,angle:r}},calculateEntranceFaceLightPoint:function(t,e,i,n){var r=Rr.roadWidth/3,a=[],o=[],s=t["in"],h=1,c="fd"===n?Rr.roadWidth:0,l=(t.point.H0[0].y-t.point.H0[1].y)/Rr.roadWidth,d=[t.point.H0[0].x-Rr.roadWidth*s/2,(i.out+e["in"])/2*Rr.roadWidth+2*r+h+c],u=[d[0]-2*r-h,d[1]-l*(2*r+h)],f=[d[0]+2*r+h,d[1]+l*(2*r+h)];return a=[f,d,u],o=t.angle+180,{points:a,angle:o}},calculateCircleLightPoint:function(t,e){var i=Rr.roadWidth/3,n=[],r=[],a=1,o=(t.point.H0[0].y-t.point.H0[1].y)/Rr.roadWidth,s="fd"===e?Rr.roadWidth:0,h=[0-Rr.roadWidth,2.8*Rr.roadWidth-s],c=[h[0]-2*i-a,h[1]-o*(2*i+a)],l=[h[0]+2*i+a,h[1]+o*(2*i+a)];return n=[l,h,c],r=t.angle+180,{points:n,angle:r}},drawLightHandler:function(t,e,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"main",s=Rr.roadWidth/3,h=Tr.pointRotateAngel({x:t[0],y:t[1]},-i,[0,0]);if("back"===e){var c=new wr.Rect({x:h.x,y:-h.y,width:6*s+8,height:2*s+2,fill:"main"===o?"#fff":"#999",rotation:a,cornerRadius:s});c.offsetX(c.width()/2),c.offsetY(c.height()/2),r.add(c)}else{var l=new wr.Circle({x:h.x,y:-h.y,radius:Rr.roadWidth/3,fill:"#000"});if(r.add(l),"center"===e){var d=new wr.Circle({x:h.x,y:-h.y,radius:Rr.roadWidth/3,fill:n});r.add(d)}else{var u=Hr({x:t[0],y:t[1]},e),f=A.getRotateData(u,i),p=new wr.Shape({stroke:n,fill:n,strokeWidth:.2,sceneFunc:function(t,e){t.beginPath(),f.forEach((function(e,i){0===i?t.moveTo(e.x,-e.y):t.lineTo(e.x,-e.y)})),t.closePath(),t.fillStrokeShape(e)}});r.add(p)}}},getxAngle:function(t,e){var i=y(t,2),n=i[0],r=i[1],a=Tr.pointRotateAngel({x:n[0],y:n[1]},-e,[0,0]),o=Tr.pointRotateAngel({x:r[0],y:r[1]},-e,[0,0]),s=Math.atan2(a.y-o.y,o.x-a.x);return s*(180/Math.PI)},getRotateLightData2:function(t,e,i){var n=[];return t.forEach((function(t){var r=Tr.pointRotateByPoint(t,e,[i.x,i.y]);n.push(r)})),n}},R={initImg:function(){g=new Image,g.src=Ur;var t=new Image;t.src=Xr}};return R.initImg(),S(S(S(S(S({},Object(o["toRefs"])(_)),{},{tfInterModel:x,scTfInterBox:m,scTfPhaseBox:w},P),A),C),R)}});i("fa87");qr.render=l;var Vr=qr;Vr.install=function(t){t.component(Vr.name,Vr)};var Qr=Vr,Kr=[Qr],Jr=function(t){Kr.map((function(e){return t.component(e.name,e)}))},Zr={install:Jr};e["default"]=Zr},fb6a:function(t,e,i){"use strict";var n=i("23e7"),r=i("861d"),a=i("e8b5"),o=i("23cb"),s=i("50c4"),h=i("fc6a"),c=i("8418"),l=i("b622"),d=i("1dde"),u=d("slice"),f=l("species"),p=[].slice,g=Math.max;n({target:"Array",proto:!0,forced:!u},{slice:function(t,e){var i,n,l,d=h(this),u=s(d.length),y=o(t,u),v=o(void 0===e?u:e,u);if(a(d)&&(i=d.constructor,"function"!=typeof i||i!==Array&&!a(i.prototype)?r(i)&&(i=i[f],null===i&&(i=void 0)):i=void 0,i===Array||void 0===i))return p.call(d,y,v);for(n=new(void 0===i?Array:i)(g(v-y,0)),l=0;y<v;y++,l++)y in d&&c(n,l,d[y]);return n.length=l,n}})},fc6a:function(t,e,i){var n=i("44ad"),r=i("1d80");t.exports=function(t){return n(r(t))}},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(t,e,i){var n=i("4930");t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},fea9:function(t,e,i){var n=i("da84");t.exports=n.Promise}})}));
//# sourceMappingURL=index.umd.min.js.map